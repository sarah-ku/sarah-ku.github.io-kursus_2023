<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Clustering | Analyse og visualisering af biologiske datasæt - 2023</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Clustering | Analyse og visualisering af biologiske datasæt - 2023" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Clustering | Analyse og visualisering af biologiske datasæt - 2023" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

<meta name="author" content="Sarah Rennie" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualisering-af-trends.html"/>
<link rel="next" href="principal-component-analysis-pca.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering kursus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#vectorer"><i class="fa fa-check"></i><b>1.6.1</b> Vectorer</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#datatyper"><i class="fa fa-check"></i><b>1.6.2</b> datatyper</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#delmængder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmængder af dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ifelse"><i class="fa fa-check"></i><b>1.8</b> If/else</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#loops"><i class="fa fa-check"></i><b>1.9</b> Loops</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.10</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.10.1</b> Simulere data fra den normale fordeling</a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.10.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#tapply"><i class="fa fa-check"></i><b>1.10.3</b> <code>tapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#statistike-tester"><i class="fa fa-check"></i><b>1.11</b> Statistike tester</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="index.html"><a href="index.html#p-værdien"><i class="fa fa-check"></i><b>1.11.1</b> P-værdien</a></li>
<li class="chapter" data-level="1.11.2" data-path="index.html"><a href="index.html#korrelation"><i class="fa fa-check"></i><b>1.11.2</b> Korrelation</a></li>
<li class="chapter" data-level="1.11.3" data-path="index.html"><a href="index.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.11.3</b> Test for uafhængighed (chi-sq test)</a></li>
<li class="chapter" data-level="1.11.4" data-path="index.html"><a href="index.html#sample-t-test"><i class="fa fa-check"></i><b>1.11.4</b> 1 sample t-test</a></li>
<li class="chapter" data-level="1.11.5" data-path="index.html"><a href="index.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.11.5</b> 2-sample t-test</a></li>
<li class="chapter" data-level="1.11.6" data-path="index.html"><a href="index.html#paired-t-test"><i class="fa fa-check"></i><b>1.11.6</b> Paired t-test</a></li>
<li class="chapter" data-level="1.11.7" data-path="index.html"><a href="index.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.11.7</b> ANOVA (variansanalyse)</a></li>
<li class="chapter" data-level="1.11.8" data-path="index.html"><a href="index.html#lineær-regression"><i class="fa fa-check"></i><b>1.11.8</b> Lineær regression</a></li>
<li class="chapter" data-level="1.11.9" data-path="index.html"><a href="index.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.11.9</b> R-squared coefficient of determination</a></li>
<li class="chapter" data-level="1.11.10" data-path="index.html"><a href="index.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.11.10</b> Antagelser - lineær regression</a></li>
<li class="chapter" data-level="1.11.11" data-path="index.html"><a href="index.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.11.11</b> Multiple lineær regression</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#problemstillinger"><i class="fa fa-check"></i><b>1.12</b> Problemstillinger</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="index.html"><a href="index.html#quiz---basics"><i class="fa fa-check"></i><b>1.12.1</b> Quiz - Basics</a></li>
<li class="chapter" data-level="1.12.2" data-path="index.html"><a href="index.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.12.2</b> Grundlæggende R</a></li>
<li class="chapter" data-level="1.12.3" data-path="index.html"><a href="index.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.12.3</b> Kort analyse med reaktionstider</a></li>
<li class="chapter" data-level="1.12.4" data-path="index.html"><a href="index.html#øvelse-med-co2"><i class="fa fa-check"></i><b>1.12.4</b> Øvelse med CO2</a></li>
<li class="chapter" data-level="1.12.5" data-path="index.html"><a href="index.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.12.5</b> Ekstra øvelser med statistik tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.1</b> Hvad er R Markdown?</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Installere R Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.3</b> Videodemonstrationer</a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.4</b> Oprette et nyt dokument i R Markdown</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.4.1</b> YAML</a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.4.2</b> Globale options</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.5</b> Skrive baseret tekst</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.5.1</b> Headers</a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.5.2</b> liste</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.6</b> Knitte kode</a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.7</b> Kode chunks</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.7.1</b> Et godt råd når man arbejder med chunks</a></li>
<li class="chapter" data-level="2.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.7.2</b> Chunk indstillinger</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-inden-for-teksten-i-dokumentet-inline-code"><i class="fa fa-check"></i><b>2.8</b> R beregninger inden for teksten i dokumentet (‘inline code’)</a></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.9</b> Working directory</a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.10</b> Matematik</a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.11</b> Problemstillinger</a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.12</b> Færdig for i dag og næste gang</a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.13</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#inledning-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Inledning og videoer</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-for-dag-1"><i class="fa fa-check"></i><b>3.1.1</b> Læringsmålene for dag 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.2</b> Hvad er <strong>ggplot2</strong>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.3</b> Brugen af materialerne</a></li>
<li class="chapter" data-level="3.1.4" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.4</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2</a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot</a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax</a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?</a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#globale-versus-lokale-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Globale versus lokale æstetik</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel</a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver</a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema</a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)</a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)</a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)</a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)</a></li>
<li class="chapter" data-level="3.8.5" data-path="visual1.html"><a href="visual1.html#line-plot-geom_line"><i class="fa fa-check"></i><b>3.8.5</b> Line plot (<code>geom_line()</code>)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#indledning-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Indledning og videoer</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#læringsmålene"><i class="fa fa-check"></i><b>4.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="4.1.2" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.2</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)</a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).</a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver</a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver</a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-labels-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføjelse af labels direkte på plottet.</a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller</a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføjelse af rektangler i regioner af interesse (<code>annotate</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot</a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning dag 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#hvad-er-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Hvad er Tidyverse?</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-for-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper for ‘tidy data’</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-r-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base-R til tidyverse</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasættet"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasættet</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-rengøring"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: Rengøring</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#sammenligningsoperatorer"><i class="fa fa-check"></i><b>5.7.3</b> Sammenligningsoperatorer</a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2</a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#misc-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Misc funktioner som er nyttige at vide</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull</a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning dag 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#indledning-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Indledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#læringsmålene-1"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="6.1.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code>-funktioner</a></li>
<li class="chapter" data-level="6.2.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#flere-summeringsstatistikker-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summeringsstatistikker på én gang</a></li>
<li class="chapter" data-level="6.2.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#mere-avanceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere avanceret <code>group_by()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt"><i class="fa fa-check"></i><b>6.3.1</b> Tidyr pakke - oversigt</a></li>
<li class="chapter" data-level="6.3.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Wide -&gt; Long med <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#eksempel-titanic-opsummeringsstatistikker"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic opsummeringsstatistikker</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration af <code>pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> Funktionen <code>left_join()</code> fra dplyr-pakken</a></li>
<li class="chapter" data-level="6.5.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#anvend-left_join-for-vores-datasæt."><i class="fa fa-check"></i><b>6.5.2</b> Anvend <code>left_join()</code> for vores datasæt.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="6.7" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#ekstra-links-1"><i class="fa fa-check"></i><b>6.7</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#læringsmål"><i class="fa fa-check"></i><b>7.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="7.1.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#videorressourcer"><i class="fa fa-check"></i><b>7.1.2</b> Videorressourcer</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterative-processer-med-map-funktioner"><i class="fa fa-check"></i><b>7.2</b> Iterative processer med <code>map()</code> funktioner</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner</a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-de-forskellige-map-funktioner"><i class="fa fa-check"></i><b>7.2.2</b> Reference for de forskellige map-funktioner</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner"><i class="fa fa-check"></i><b>7.3</b> Brugerdefinerede funktioner</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-funktioner"><i class="fa fa-check"></i><b>7.3.1</b> Simple funktioner</a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner-med-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Brugerdefinerede funktioner med mapping</a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-datatyper"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre datatyper</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-med-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting med <code>nest()</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvendelse-af-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvendelse af map() med nested data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-funktion-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> funktion for flere inputs</a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformering-af-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformering af numeriske variabler</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html"><i class="fa fa-check"></i><b>8</b> Visualisering af trends</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#indledning-og-læringsmål"><i class="fa fa-check"></i><b>8.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#læringsmål-1"><i class="fa fa-check"></i><b>8.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="8.1.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#introduktion-til-kapitlet"><i class="fa fa-check"></i><b>8.1.2</b> Introduktion til kapitlet</a></li>
<li class="chapter" data-level="8.1.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#videoressourcer"><i class="fa fa-check"></i><b>8.1.3</b> Videoressourcer</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#nest-og-map-eksempel-med-korrelation"><i class="fa fa-check"></i><b>8.2</b> <code>nest()</code> og <code>map()</code>: eksempel med korrelation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#korrelation-over-flere-datasæt-på-en-gang"><i class="fa fa-check"></i><b>8.2.1</b> Korrelation over flere datasæt på en gang</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-regression---visualisering"><i class="fa fa-check"></i><b>8.3</b> Lineær regression - visualisering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineære-trends"><i class="fa fa-check"></i><b>8.3.1</b> Lineære trends</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-lm-trendlinjer"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_smooth()</code>: <code>lm</code> trendlinjer</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-flere-lm-trendlinjer-på-samme-plot"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_smooth()</code>: flere <code>lm</code> trendlinjer på samme plot</a></li>
<li class="chapter" data-level="8.3.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#trendlinjer-med-methodloess"><i class="fa fa-check"></i><b>8.3.4</b> Trendlinjer med <code>method=="loess"</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#plot-linear-regresion-estimates"><i class="fa fa-check"></i><b>8.4</b> Plot linear regresion estimates</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anvendelse-af-lm-over-nestede-datasæt"><i class="fa fa-check"></i><b>8.4.1</b> Anvendelse af <code>lm()</code> over nestede datasæt</a></li>
<li class="chapter" data-level="8.4.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#funktionen-glue-til-at-tilføje-etiketter"><i class="fa fa-check"></i><b>8.4.2</b> Funktionen <code>glue()</code> til at tilføje etiketter</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#multipel-regression-og-model-sammenligning"><i class="fa fa-check"></i><b>8.5</b> Multipel regression og model sammenligning</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anova-til-at-sammenligne-de-forskellige-modeller"><i class="fa fa-check"></i><b>8.5.1</b> <code>anova</code> til at sammenligne de forskellige modeller</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#problemstillinger-7"><i class="fa fa-check"></i><b>8.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="8.7" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#ekstra"><i class="fa fa-check"></i><b>8.7</b> Ekstra</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#indledning-og-læringsmål-1"><i class="fa fa-check"></i><b>9.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="clustering.html"><a href="clustering.html#læringsmål-2"><i class="fa fa-check"></i><b>9.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="9.1.2" data-path="clustering.html"><a href="clustering.html#indledning-til-kapitel"><i class="fa fa-check"></i><b>9.1.2</b> Indledning til kapitel</a></li>
<li class="chapter" data-level="9.1.3" data-path="clustering.html"><a href="clustering.html#video-ressourcer-3"><i class="fa fa-check"></i><b>9.1.3</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#method-1-k-means-clustering"><i class="fa fa-check"></i><b>9.2</b> Method 1: K-means clustering</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="clustering.html"><a href="clustering.html#hvordan-fungerer-kmeans"><i class="fa fa-check"></i><b>9.2.1</b> Hvordan fungerer kmeans?</a></li>
<li class="chapter" data-level="9.2.2" data-path="clustering.html"><a href="clustering.html#withinbetween-sum-of-squares"><i class="fa fa-check"></i><b>9.2.2</b> Within/between sum of squares</a></li>
<li class="chapter" data-level="9.2.3" data-path="clustering.html"><a href="clustering.html#kør-k-means-i-r"><i class="fa fa-check"></i><b>9.2.3</b> Kør k-means i R</a></li>
<li class="chapter" data-level="9.2.4" data-path="clustering.html"><a href="clustering.html#ryd-op-i-k-means-resultaterne-med-pakken-broom"><i class="fa fa-check"></i><b>9.2.4</b> Ryd op i k-means resultaterne med pakken <code>broom</code></a></li>
<li class="chapter" data-level="9.2.5" data-path="clustering.html"><a href="clustering.html#plotcentroids"><i class="fa fa-check"></i><b>9.2.5</b> Plot cluster centroids</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#kmeans-hvor-mange-clusters"><i class="fa fa-check"></i><b>9.3</b> Kmeans: hvor mange clusters?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="clustering.html"><a href="clustering.html#få-broom-output-for-forskellige-antal-clusters"><i class="fa fa-check"></i><b>9.3.1</b> Få Broom output for forskellige antal clusters</a></li>
<li class="chapter" data-level="9.3.2" data-path="clustering.html"><a href="clustering.html#elbow-plot-glance"><i class="fa fa-check"></i><b>9.3.2</b> Elbow plot (glance)</a></li>
<li class="chapter" data-level="9.3.3" data-path="clustering.html"><a href="clustering.html#automatisk-beslutning-med-pakken-nbclust"><i class="fa fa-check"></i><b>9.3.3</b> Automatisk beslutning med pakken <code>NbClust</code></a></li>
<li class="chapter" data-level="9.3.4" data-path="clustering.html"><a href="clustering.html#visualisering-af-de-forskellige-antal-clusters-augment"><i class="fa fa-check"></i><b>9.3.4</b> Visualisering af de forskellige antal clusters (augment)</a></li>
<li class="chapter" data-level="9.3.5" data-path="clustering.html"><a href="clustering.html#nestmap-ramme-fra-sidste-gang"><i class="fa fa-check"></i><b>9.3.5</b> Nest/map-ramme fra sidste gang</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#metode-2-hierarchical-clustering"><i class="fa fa-check"></i><b>9.4</b> Metode 2: Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="clustering.html"><a href="clustering.html#vælge-ønsket-antal-clusters"><i class="fa fa-check"></i><b>9.4.1</b> Vælge ønsket antal clusters</a></li>
<li class="chapter" data-level="9.4.2" data-path="clustering.html"><a href="clustering.html#lav-et-pænt-plot-af-dendrogrammet-med-ggplot2"><i class="fa fa-check"></i><b>9.4.2</b> Lav et pænt plot af dendrogrammet med ggplot2</a></li>
<li class="chapter" data-level="9.4.3" data-path="clustering.html"><a href="clustering.html#ekstra-valgfri-afprøve-andre-metoder-på-hierachical-clustering"><i class="fa fa-check"></i><b>9.4.3</b> Ekstra (valgfri): afprøve andre metoder på hierachical clustering</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#problemstillinger-8"><i class="fa fa-check"></i><b>9.5</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i><b>10</b> Principal component analysis (PCA)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#indledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>10.1</b> Indledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#læringsmålene-2"><i class="fa fa-check"></i><b>10.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="10.1.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#introduktion-til-kapitlet-1"><i class="fa fa-check"></i><b>10.1.2</b> Introduktion til kapitlet</a></li>
<li class="chapter" data-level="10.1.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#videoressourcer-1"><i class="fa fa-check"></i><b>10.1.3</b> Videoressourcer</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#hvad-er-principal-component-analysis-pca"><i class="fa fa-check"></i><b>10.2</b> Hvad er principal component analysis (PCA)?</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#simpelt-eksempel-med-to-dimensioner"><i class="fa fa-check"></i><b>10.2.1</b> Simpelt eksempel med to dimensioner</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#fit-pca-to-data-in-r"><i class="fa fa-check"></i><b>10.3</b> Fit PCA to data in R</a></li>
<li class="chapter" data-level="10.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#integrering-af-pca-resultater-med-broom-pakken"><i class="fa fa-check"></i><b>10.4</b> Integrering af PCA-resultater med broom-pakken</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#rotationsmatrix-for-at-udtrække-bidragene-fra-de-forskellige-variabler"><i class="fa fa-check"></i><b>10.4.1</b> Rotationsmatrix for at udtrække bidragene fra de forskellige variabler</a></li>
<li class="chapter" data-level="10.4.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#pakken-factoextra"><i class="fa fa-check"></i><b>10.4.2</b> Pakken <code>factoextra</code></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#problemstillinger-9"><i class="fa fa-check"></i><b>10.5</b> Problemstillinger</a></li>
<li class="chapter" data-level="10.6" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#ekstra-læsning"><i class="fa fa-check"></i><b>10.6</b> Ekstra læsning</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html"><i class="fa fa-check"></i><b>11</b> Emner fra eksperimental design</a>
<ul>
<li class="chapter" data-level="11.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#inledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>11.1</b> Inledning og læringsmålene</a></li>
<li class="chapter" data-level="11.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#indledning-og-læringsmål-2"><i class="fa fa-check"></i><b>11.2</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#læringsmål-3"><i class="fa fa-check"></i><b>11.2.1</b> Læringsmål</a></li>
<li class="chapter" data-level="11.2.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#indledning-til-kapitlet"><i class="fa fa-check"></i><b>11.2.2</b> Indledning til kapitlet</a></li>
<li class="chapter" data-level="11.2.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#video-ressourcer-4"><i class="fa fa-check"></i><b>11.2.3</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#grundlæggende-principper-i-eksperimentelt-design"><i class="fa fa-check"></i><b>11.3</b> Grundlæggende principper i eksperimentelt design</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#randomisering-og-replikation"><i class="fa fa-check"></i><b>11.3.1</b> Randomisering og replikation</a></li>
<li class="chapter" data-level="11.3.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#eksempel-med-datasættet-toothgrowth"><i class="fa fa-check"></i><b>11.3.2</b> Eksempel med datasættet <code>ToothGrowth</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-simpsons-paradoks"><i class="fa fa-check"></i><b>11.4</b> Case studies: Simpsons paradoks</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#optagelse-på-berkeley"><i class="fa fa-check"></i><b>11.4.1</b> Optagelse på Berkeley</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-anscombes-kvartet"><i class="fa fa-check"></i><b>11.5</b> Case studies: Anscombes kvartet</a></li>
<li class="chapter" data-level="11.6" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#undersøgelse-af-batch-effekter"><i class="fa fa-check"></i><b>11.6</b> Undersøgelse af “batch-effekter”</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#principal-component-analyse"><i class="fa fa-check"></i><b>11.6.1</b> Principal component analyse</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#problemstillinger-10"><i class="fa fa-check"></i><b>11.7</b> Problemstillinger</a></li>
<li class="chapter" data-level="11.8" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#yderligere-læsning"><i class="fa fa-check"></i><b>11.8</b> Yderligere læsning</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html"><i class="fa fa-check"></i><b>12</b> Maskinslæring i tidyverse</a>
<ul>
<li class="chapter" data-level="12.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#indledning-og-læringsmål-3"><i class="fa fa-check"></i><b>12.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#læringsmålene-3"><i class="fa fa-check"></i><b>12.1.1</b> Læringsmålene</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#videomateriale"><i class="fa fa-check"></i><b>12.2</b> Videomateriale</a></li>
<li class="chapter" data-level="12.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#regressionsmodeller"><i class="fa fa-check"></i><b>12.3</b> Regressionsmodeller</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#oprettelse-af-test--og-træningssæt"><i class="fa fa-check"></i><b>12.3.1</b> Oprettelse af test- og træningssæt</a></li>
<li class="chapter" data-level="12.3.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#krydsvalidering-cross-fold-validation"><i class="fa fa-check"></i><b>12.3.2</b> Krydsvalidering (cross-fold validation)</a></li>
<li class="chapter" data-level="12.3.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#opbygning-af-modellen-og-lave-forudsigelser"><i class="fa fa-check"></i><b>12.3.3</b> Opbygning af modellen og lave forudsigelser</a></li>
<li class="chapter" data-level="12.3.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#evaluering-af-resultater-på-valideringssættet"><i class="fa fa-check"></i><b>12.3.4</b> Evaluering af resultater på valideringssættet</a></li>
<li class="chapter" data-level="12.3.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#teste-og-evaluere-final-model"><i class="fa fa-check"></i><b>12.3.5</b> Teste og evaluere “final” model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#classification-models"><i class="fa fa-check"></i><b>12.4</b> Classification models</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#splitte-datasættet-og-lave-cross-validation-dataframe"><i class="fa fa-check"></i><b>12.4.1</b> Splitte datasættet og lave cross-validation dataframe</a></li>
<li class="chapter" data-level="12.4.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#definere-classification-model"><i class="fa fa-check"></i><b>12.4.2</b> Definere classification model</a></li>
<li class="chapter" data-level="12.4.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#anvende-modellen-og-lave-predictions"><i class="fa fa-check"></i><b>12.4.3</b> Anvende modellen og lave predictions</a></li>
<li class="chapter" data-level="12.4.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#beregne-accuracy"><i class="fa fa-check"></i><b>12.4.4</b> Beregne accuracy</a></li>
<li class="chapter" data-level="12.4.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#parameter-tuning"><i class="fa fa-check"></i><b>12.4.5</b> Parameter tuning</a></li>
<li class="chapter" data-level="12.4.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#lave-final-model-med-titanic-datasæt"><i class="fa fa-check"></i><b>12.4.6</b> Lave final model med titanic datasæt</a></li>
<li class="chapter" data-level="12.4.7" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#variable-importance"><i class="fa fa-check"></i><b>12.4.7</b> Variable importance</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#problemstillinger-11"><i class="fa fa-check"></i><b>12.5</b> Problemstillinger</a></li>
<li class="chapter" data-level="12.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#yderligere-kommentarer-og-pakker"><i class="fa fa-check"></i><b>12.6</b> Yderligere kommentarer og pakker</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt - 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Clustering<a href="clustering.html#clustering" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="indledning-og-læringsmål-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Indledning og læringsmål<a href="clustering.html#indledning-og-læringsmål-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="læringsmål-2" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Læringsmål<a href="clustering.html#læringsmål-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Du skal være i stand til at:</p>
<ul>
<li>Beskrive hvad k-means clustering går ud på</li>
<li>Anvende <code>kmeans</code> og præsentere resultatet på en pæn (tidy) måde</li>
<li>Anvende <code>map</code> over forskellige antal clusters og vælge det antal, der passer til dataene</li>
<li>Anvende funktionen <code>hclust</code> for at lave en simpel hierarkisk clustering</li>
</ul>
</div>
<div id="indledning-til-kapitel" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Indledning til kapitel<a href="clustering.html#indledning-til-kapitel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formålet med clustering er at opdele observationerne i et datasæt i forskellige grupper (clusters eller klynger på dansk), således at observationerne i samme cluster ligner hinanden. Dette øger indsigt i datasættet ved f.eks. bedre at forstå strukturen. F.eks. hvor mange forskellige clusters er repræsenteret i mit datasæt? Og hvilke individuelle observationer tilhører hvilken cluster?</p>
<p>I dette kapitel ser vi på, hvordan vi kan implementere både <strong>k-means clustering</strong> og <strong>hierarchical clustering</strong> inden for rammerne af tidyverse.</p>
</div>
<div id="video-ressourcer-3" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Video ressourcer<a href="clustering.html#video-ressourcer-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Video 1: K-means clustering</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/553656150" class="uri">https://player.vimeo.com/video/553656150</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/553656150" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 2: augment, glanced og tidy med K-means. <strong>OBS</strong> der er en lille fejl i koden omkring 6:00 - den anden <code>geom_point</code> skal være <code>geom_point(data = kclust_tidy,aes(x=bill_length,y=bill_depth),shape="x,colour="black")</code> fordi tallerne er allerede basaserede på “scaled” data i <code>kclust_tidy</code> - se sektion <a href="clustering.html#plotcentroids">9.2.5</a> for uddybelse.</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/553656139" class="uri">https://player.vimeo.com/video/553656139</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/553656139" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 3: Hvor mange clusters skal man vælge?</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/553656129" class="uri">https://player.vimeo.com/video/553656129</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/553656129" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 4: Hierarchical clustering</li>
</ul>
<p>(OBS Video 4 mangler: se gerne kursusnotaterne og jeg laver videoen ASAP)</p>
<hr />
</div>
</div>
<div id="method-1-k-means-clustering" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Method 1: K-means clustering<a href="clustering.html#method-1-k-means-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="clustering.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb524-2"><a href="clustering.html#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb524-3"><a href="clustering.html#cb524-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code></pre></div>
<p>I k-means clustering bliver samtlige observationer tilknyttet den nærmeste cluster “centroid” (se “hvordan fungerer kmeans?” nedenunder). I k-means skal man specificere antallet af clusters, som observationerne skal opdeles i, på forhånd. Derfor kræver det en vis undersøgelsesindsats at vælge det bedste antal clusters, der passer til problemstillingen, eller som bedst repræsenterer datasættet.</p>
<p>Lad os tage udgangspunkt i datasættet <code>penguins</code>. Vi begynder med at fjerne observationerne med <code>NA</code> i mindst én variabel ved at bruge funktionen <code>drop_na</code>, og ved at specificere at <code>year</code> skal være en faktor (for at skelne den fra de andre numeriske kolonner):</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="clustering.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins)</span>
<span id="cb525-2"><a href="clustering.html#cb525-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb525-3"><a href="clustering.html#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">as.factor</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb525-4"><a href="clustering.html#cb525-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() </span></code></pre></div>
<p>Vi ved allerede i forvejen, at der er 3 <code>species</code> i disse data, som vi plotter her med forskellige farver.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="clustering.html#cb526-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>bill_length_mm,<span class="at">y=</span>body_mass_g,<span class="at">colour=</span>species)) <span class="sc">+</span> </span>
<span id="cb526-2"><a href="clustering.html#cb526-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb526-3"><a href="clustering.html#cb526-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-530-1.png" width="480" /></p>
<p>Vi vil gerne bruge k-means clustering på de numeriske variabler i datasættet og beregne 3 clusters ud fra disse. Derefter kan det være interessant at sammenligne de clusters, vi får, med de tre arter af pingviner - hvor gode er disse clusters til at skelne mellem de forskellige arter, eller indfanger de en anden struktur i datasættet (for eksempel køn eller den ø, de bor på)?</p>
<div id="hvordan-fungerer-kmeans" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Hvordan fungerer kmeans?<a href="clustering.html#hvordan-fungerer-kmeans" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>K-means er en iterativ proces. Lad os forestille os, at vi gerne vil have tre clusters i vores data. Man starter med tre tilfældige observationer og kalder dem for clusterens middelværdier eller “centroids”. Man tilknytter alle observationer til én af de tre clusters (den nærmeste af de tre centroids), og beregner herefter en ny middelværdi/centroid for hver cluster. Man tilknytter samtlige observationer igen efter den nærmeste af de tre nye cluster centroids, og så gentager man processen flere gange. Efter flere gange konvergerer de tre centroids mod nogle faste værdier, der ikke længere ændrer sig meget, hver gang man gentager processen. Disse tre centroids definerer de tre endelige clusters, og samtlige observationer er tilknyttet én af disse.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-531"></span>
<img src="plots/kmeans.png" alt="source: https://towardsdatascience.com/k-means-a-complete-introduction-1702af9cd8c" width="50%" />
<p class="caption">
Figure 9.1: source: <a href="https://towardsdatascience.com/k-means-a-complete-introduction-1702af9cd8c" class="uri">https://towardsdatascience.com/k-means-a-complete-introduction-1702af9cd8c</a>
</p>
</div>
<p>Jeg beder ikke om detaljerne i metoden, men der er mange videoer på YouTube, der bedre forklarer, hvordan k-means fungerer, for eksempel: <a href="https://www.youtube.com/watch?v=4b5d3muPQmA" class="uri">https://www.youtube.com/watch?v=4b5d3muPQmA</a></p>
<p>Bemærk, at der er noget <strong>tilfældighed</strong> indbygget i algoritmen. Det betyder, at hver gang man anvender k-means, får man et lidt anderledes resultat.</p>
</div>
<div id="withinbetween-sum-of-squares" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Within/between sum of squares<a href="clustering.html#withinbetween-sum-of-squares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Man kan forestille sig, at hvis man laver en god clustering af et datasæt, så ligner observationerne inden for den samme cluster hinanden meget, mens observationerne i forskellige clusters er meget forskellige fra hinanden. Med andre ord, skal afstanden mellem observationerne i samme cluster være så lille som muligt, og afstanden mellem observationerne i forskellige clusters skal være så stor som muligt. For at måle dette kan man beregne følgende:</p>
<ul>
<li><strong>total within sum of squares</strong> - den totale kvadrerede afstand fra observationerne til deres nærmeste centroid.</li>
<li><strong>total between sum of squares</strong> - den totale afstand fra centroids til alle andre centroids. Denne skal være så stor som muligt.</li>
</ul>
</div>
<div id="kør-k-means-i-r" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Kør k-means i R<a href="clustering.html#kør-k-means-i-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>K-means <em>fungerer kun på numeriske data</em>, som vi kan vælge fra datasættet med <code>select()</code> i kombination med hjælpefunktionen <code>where(is.numeric)</code>. Vi bruger også <code>scale()</code>, hvilket betyder, at alle variabler får den samme skala, og det forhindrer, at nogle får mere indflydelse end andre i det endelige resultat.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="clustering.html#cb527-1" aria-hidden="true" tabindex="-1"></a>penguins_scaled <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb527-2"><a href="clustering.html#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb527-3"><a href="clustering.html#cb527-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span></code></pre></div>
<p>Man er også nødt til at specificere på forhånd, hvor mange clusters man ønsker at opdele datasættet i, så lad os sige <code>centers=3</code> inden for funktionen <code>kmeans()</code> her og beregne vores clusters:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="clustering.html#cb528-1" aria-hidden="true" tabindex="-1"></a>kclust <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(penguins_scaled,<span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb528-2"><a href="clustering.html#cb528-2" aria-hidden="true" tabindex="-1"></a>kclust</span></code></pre></div>
<pre><code>## K-means clustering with 3 clusters of sizes 119, 85, 129
## 
## Cluster means:
##   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
## 1      0.6537742    -1.1010497         1.1607163   1.0995561
## 2      0.6710153     0.8040534        -0.2889118  -0.3835267
## 3     -1.0452359     0.4858944        -0.8803701  -0.7616078
## 
## Clustering vector:
##   [1] 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
##  [38] 3 2 3 3 3 3 2 3 3 3 2 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 3 3 3 2 3 2 3 3 3 2
##  [75] 3 2 3 3 3 3 3 3 3 3 3 2 3 3 3 2 3 3 3 2 3 2 3 3 3 3 3 3 3 2 3 2 3 2 3 2 3
## [112] 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 1 1
## [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [260] 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 2 2 2 2 2 2 2 3
## [297] 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2
## 
## Within cluster sum of squares by cluster:
## [1] 139.4684 109.4813 120.7030
##  (between_SS / total_SS =  72.2 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<p>Man får forskellige ting frem, for eksempel:</p>
<ul>
<li><code>Cluster means</code> - det svarer til de centroids markeret med <strong>x</strong> i figuren ovenfor - bemærk, at de er 4-dimensionelle, da vi har brugt 4 variabler til at beregne resultatet.</li>
<li><code>Clustering</code> vector - hvilken cluster hver observation er blevet tilknyttet.</li>
<li><code>Within cluster sum of squares</code> - Jo mindre, jo bedre - hvor meget observationerne inden for samme cluster ligner hinanden (den totale kvadrerede afstand fra observationerne til deres nærmeste centroid).</li>
</ul>
</div>
<div id="ryd-op-i-k-means-resultaterne-med-pakken-broom" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Ryd op i k-means resultaterne med pakken <code>broom</code><a href="clustering.html#ryd-op-i-k-means-resultaterne-med-pakken-broom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fra pakken <code>broom</code> har vi indtil videre mest beskæftiget os med <code>glance()</code>. Med <code>glance()</code> får man én-linje baserede summary statistikker fra én eller flere modeller samlet i én dataramme, for at lette et plot/labels osv. Der er også to andre funktioner vi tager i brug her. Her er en beskrivelse af de tre.</p>
<table>
<colgroup>
<col width="39%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>Broom verb</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>glance()</code></td>
<td>single line summary - lav et elbow plot</td>
</tr>
<tr class="even">
<td><code>augment()</code></td>
<td>Tilføj datasæt til clusters - lav plots farvet efter cluster</td>
</tr>
<tr class="odd">
<td><code>tidy()</code></td>
<td>Multi-line summary - ekstraher centroids</td>
</tr>
</tbody>
</table>
<p>For at lave et plot af clusters kan det især være nyttigt at benytte <code>augment</code>. Her kan man se, at vi har fået en kolonne, der hedder <code>.cluster</code> med i den oprindelige dataramme (jeg flyttede kolonnen til første plads i nedenstående kode, så man kan se den i outputtet af kursusnoterne).</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="clustering.html#cb530-1" aria-hidden="true" tabindex="-1"></a>kc1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(kclust, penguins) <span class="co">#clustering = første plads, data = anden plads</span></span>
<span id="cb530-2"><a href="clustering.html#cb530-2" aria-hidden="true" tabindex="-1"></a>kc1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(.cluster,<span class="fu">all_of</span>(<span class="fu">names</span>(penguins)))</span></code></pre></div>
<pre><code>## # A tibble: 333 × 9
##    .cluster species island    bill_length_mm bill_depth_mm flipper_length_mm
##    &lt;fct&gt;    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;
##  1 3        Adelie  Torgersen           39.1          18.7               181
##  2 3        Adelie  Torgersen           39.5          17.4               186
##  3 3        Adelie  Torgersen           40.3          18                 195
##  4 3        Adelie  Torgersen           36.7          19.3               193
##  5 3        Adelie  Torgersen           39.3          20.6               190
##  6 3        Adelie  Torgersen           38.9          17.8               181
##  7 3        Adelie  Torgersen           39.2          19.6               195
##  8 3        Adelie  Torgersen           41.1          17.6               182
##  9 3        Adelie  Torgersen           38.6          21.2               191
## 10 3        Adelie  Torgersen           34.6          21.1               198
## # ℹ 323 more rows
## # ℹ 3 more variables: body_mass_g &lt;int&gt;, sex &lt;fct&gt;, year &lt;fct&gt;</code></pre>
<p>Nu benytter vi <code>kc1</code> til at lave et plot. Her giver jeg en farve efter <code>.cluster</code> og form efter <code>species</code>, så vi kan sammenligne vores beregnede clusters med de tre forskellige arter. Bemærk her, at jeg kun har to variabler i plottet, men der er faktisk fire variabler, som blev brugt til at lave clusters med funktionen <code>kmeans</code>. En anden måde er at plotte de første to principal components i stedet for to af de fire variabler - det beskæftiger vi os med næste gang.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="clustering.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kc1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">scale</span>(bill_length_mm), </span>
<span id="cb532-2"><a href="clustering.html#cb532-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">scale</span>(bill_depth_mm))) <span class="sc">+</span> </span>
<span id="cb532-3"><a href="clustering.html#cb532-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> .cluster, <span class="at">shape =</span> species)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-535-1.png" width="480" /></p>
<p>Vi kan også f.eks. optælle, hvor mange af de tre arter vi får i hver af vores tre clusters, hvor vi kan se, at <code>Adelie</code> og <code>Chinstrap</code> er blevet mere blandet mellem to af de tre clusters end <code>Gentoo</code>.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="clustering.html#cb533-1" aria-hidden="true" tabindex="-1"></a>kc1 <span class="sc">%&gt;%</span> <span class="fu">count</span>(.cluster, species)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   .cluster species       n
##   &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;
## 1 1        Gentoo      119
## 2 2        Adelie       22
## 3 2        Chinstrap    63
## 4 3        Adelie      124
## 5 3        Chinstrap     5</code></pre>
</div>
<div id="plotcentroids" class="section level3 hasAnchor" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Plot cluster centroids<a href="clustering.html#plotcentroids" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Næste skridt er at se på resultatet af funktionen <code>tidy()</code> fra <code>broom</code>-pakken. Her har vi fået en overskuelig dataramme med middelværdierne (centroids) for de tre clusters over de fire variabler, som blev brugt i beregningerne.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="clustering.html#cb535-1" aria-hidden="true" tabindex="-1"></a>kclust_tidy <span class="ot">&lt;-</span> kclust <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span>
<span id="cb535-2"><a href="clustering.html#cb535-2" aria-hidden="true" tabindex="-1"></a>kclust_tidy</span></code></pre></div>
<pre><code>## # A tibble: 3 × 7
##   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g  size withinss
##            &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;
## 1          0.654        -1.10              1.16        1.10    119     139.
## 2          0.671         0.804            -0.289      -0.384    85     109.
## 3         -1.05          0.486            -0.880      -0.762   129     121.
## # ℹ 1 more variable: cluster &lt;fct&gt;</code></pre>
<p>Herefter benytter jeg <code>kclust_tidy</code> som et ekstra datasæt i ovenstående plot, men indenfor en anden <code>geom_point()</code> for at tilføje en <code>x</code>-form i midten af de tre clusters - se de følgende tre punkter, der forklarer nogle detaljer i koden:</p>
<ul>
<li>Jeg bruger funktionen <code>scale()</code> på <code>bill_length_mm</code> og <code>bill_depth_mm</code>, fordi mine centroids, som også skal med i plottet, blev beregnet på skalerede data.</li>
<li>Jeg behøver ikke at anvende <code>scale()</code> på mine centroids lagret i <code>kclust_tidy</code>, så jeg angiver bare akser-variablerne i <code>aes()</code> uden at anvende <code>scale()</code>.</li>
<li>Jeg har brugt <code>color</code> og <code>shape</code> som lokale aesthetics i den første <code>geom_point()</code> her, da de ikke eksisterer som kolonner i <code>kclust_tidy</code>.</li>
</ul>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="clustering.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kc1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">scale</span>(bill_length_mm), <span class="co"># skal skalere de oprindelige data</span></span>
<span id="cb537-2"><a href="clustering.html#cb537-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">scale</span>(bill_depth_mm))) <span class="sc">+</span> </span>
<span id="cb537-3"><a href="clustering.html#cb537-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> .cluster, <span class="at">shape =</span> species)) <span class="sc">+</span></span>
<span id="cb537-4"><a href="clustering.html#cb537-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> kclust_tidy, </span>
<span id="cb537-5"><a href="clustering.html#cb537-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="co"># behøver ikke at skalere igen</span></span>
<span id="cb537-6"><a href="clustering.html#cb537-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> bill_depth_mm),</span>
<span id="cb537-7"><a href="clustering.html#cb537-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">10</span>, <span class="at">shape =</span> <span class="st">&quot;x&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb537-8"><a href="clustering.html#cb537-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-538-1.png" width="480" /></p>
<p>Vi kan se, at vores clusters ikke præcist fanger de samme tre grupper, som variablen <code>species</code> - der er forskelle. Det kan være, at vi også har fanget nogle oplysninger om fx den ø, pingvinerne bor på, eller deres køn.</p>
</div>
</div>
<div id="kmeans-hvor-mange-clusters" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Kmeans: hvor mange clusters?<a href="clustering.html#kmeans-hvor-mange-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi gættede på 3 clusters i den ovenstående analyse (da vi havde oplysninger om arter i forvejen), men det kunne godt være, at et andet antal clusters passer bedre til datasættet. Vi kan beregne flere clusterings og angive forskellige antal clusters, og dernæst bruge resultaterne fra disse til at træffe en beslutning om, hvor mange clusters vi vil angive i vores endelige clustering.</p>
<p>Det er vigtigt at kunne finde frem til et passende antal clusters:</p>
<ul>
<li>For mange clusters kan resultere i overfitting, hvor vi har for mange til at fortolke eller give mening.</li>
<li>For få kan betyde, at vi overser indsigter i strukturen eller vigtige tendenser i datasættet.</li>
</ul>
<div id="få-broom-output-for-forskellige-antal-clusters" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Få Broom output for forskellige antal clusters<a href="clustering.html#få-broom-output-for-forskellige-antal-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I det følgende laver jeg en brugerdefineret funktion, der laver en clustering på datasættet <code>penguins_scaled</code>, og hvor jeg angiver, at antallet af beregnede clusters skal være <code>.x</code>, der er et heltal (fx 1,3,99 osv.). Bemærk derfor, at selve data er den samme hver gang jeg anvender funktionen - det er bare antallet af clusters jeg beregner, der kan variere.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="clustering.html#cb538-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">kmeans</span>(penguins_scaled,<span class="at">centers =</span> .x)</span></code></pre></div>
<p>Dernæst laver jeg en <code>tibble</code> med variablen <code>k</code>, som indeholder heltal fra 1 op til 9. Når jeg anvender funktionen <code>map</code> på kolonnen <code>k</code> med ovenstående funktion <code>my_func</code>, svarer det til, at jeg anvender <code>kmeans</code> ni gange, med antal clusters fra 1 til 9. Jeg gemmer clustering resultaterne i en kolonne kaldet <code>kclust</code>, og så anvender jeg <code>tidy</code>, <code>glance</code> og <code>augment</code> til at få de forskellige outputter fra mine clusterings.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="clustering.html#cb539-1" aria-hidden="true" tabindex="-1"></a>kclusts <span class="ot">&lt;-</span> </span>
<span id="cb539-2"><a href="clustering.html#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb539-3"><a href="clustering.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">kclust =</span> <span class="fu">map</span>(k, my_func),</span>
<span id="cb539-4"><a href="clustering.html#cb539-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">tidied =</span> <span class="fu">map</span>(kclust, tidy),</span>
<span id="cb539-5"><a href="clustering.html#cb539-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">glanced =</span> <span class="fu">map</span>(kclust, glance),</span>
<span id="cb539-6"><a href="clustering.html#cb539-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">augmented =</span> <span class="fu">map</span>(kclust, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">augment</span>(penguins))</span>
<span id="cb539-7"><a href="clustering.html#cb539-7" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<p>Husk, at for at få frem resultaterne i de forskellige formater fra <code>tidy</code>,<code>glance</code> og <code>augment</code>, er vi nødt til at anvende funktionen <code>unnest()</code> - her gemmer jeg resultaterne i tre nye dataframes, som vi kan referere til efterfølgende:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="clustering.html#cb540-1" aria-hidden="true" tabindex="-1"></a>kclusts_tidy    <span class="ot">&lt;-</span> kclusts <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(tidied)</span>
<span id="cb540-2"><a href="clustering.html#cb540-2" aria-hidden="true" tabindex="-1"></a>kclusts_augment <span class="ot">&lt;-</span> kclusts <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(augmented)</span>
<span id="cb540-3"><a href="clustering.html#cb540-3" aria-hidden="true" tabindex="-1"></a>kclusts_glance <span class="ot">&lt;-</span> kclusts <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(glanced)</span></code></pre></div>
</div>
<div id="elbow-plot-glance" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Elbow plot (glance)<a href="clustering.html#elbow-plot-glance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi bruger <code>tot.withinss</code> fra outputtet fra <code>glance()</code> (dataframen <code>kclusts_glance</code>). Det giver målinger for den totale afstand af observationerne fra deres nærmeste centroid (within sum of squares).</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="clustering.html#cb541-1" aria-hidden="true" tabindex="-1"></a>kclusts_glance</span></code></pre></div>
<pre><code>## # A tibble: 9 × 8
##       k kclust   tidied           totss tot.withinss betweenss  iter augmented
##   &lt;int&gt; &lt;list&gt;   &lt;list&gt;           &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt; &lt;list&gt;   
## 1     1 &lt;kmeans&gt; &lt;tibble [1 × 7]&gt;  1328        1328.  9.09e-13     1 &lt;tibble&gt; 
## 2     2 &lt;kmeans&gt; &lt;tibble [2 × 7]&gt;  1328         551.  7.77e+ 2     1 &lt;tibble&gt; 
## 3     3 &lt;kmeans&gt; &lt;tibble [3 × 7]&gt;  1328         371.  9.57e+ 2     2 &lt;tibble&gt; 
## 4     4 &lt;kmeans&gt; &lt;tibble [4 × 7]&gt;  1328         293.  1.03e+ 3     2 &lt;tibble&gt; 
## 5     5 &lt;kmeans&gt; &lt;tibble [5 × 7]&gt;  1328         276.  1.05e+ 3     3 &lt;tibble&gt; 
## 6     6 &lt;kmeans&gt; &lt;tibble [6 × 7]&gt;  1328         211.  1.12e+ 3     3 &lt;tibble&gt; 
## 7     7 &lt;kmeans&gt; &lt;tibble [7 × 7]&gt;  1328         195.  1.13e+ 3     3 &lt;tibble&gt; 
## 8     8 &lt;kmeans&gt; &lt;tibble [8 × 7]&gt;  1328         174.  1.15e+ 3     4 &lt;tibble&gt; 
## 9     9 &lt;kmeans&gt; &lt;tibble [9 × 7]&gt;  1328         198.  1.13e+ 3     3 &lt;tibble&gt;</code></pre>
<p>Jo flere clusters, jo mindre er statistikken <code>tot.withinss</code> typisk, men vi kan se i det følgende plot, at efter 2 eller 3 clusters, er der ikke meget gevinst ved at bruge flere clusters. Derfor vælger man ofte enten 2 eller 3. Dette plot kaldes ofte for en ‘elbow’ plot - man vælger det antal, der ligger på ‘elbuen’, hvor der ikke er meget gevinst ved at inkludere flere clusters i datasættet (men det er selvfølgelig meget subjektivt, hvilket tal man vælger til sidst).</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="clustering.html#cb543-1" aria-hidden="true" tabindex="-1"></a>kclusts_glance <span class="sc">%&gt;%</span> </span>
<span id="cb543-2"><a href="clustering.html#cb543-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> tot.withinss)) <span class="sc">+</span> </span>
<span id="cb543-3"><a href="clustering.html#cb543-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb543-4"><a href="clustering.html#cb543-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb543-5"><a href="clustering.html#cb543-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-543-1.png" width="480" /></p>
</div>
<div id="automatisk-beslutning-med-pakken-nbclust" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Automatisk beslutning med pakken <code>NbClust</code><a href="clustering.html#automatisk-beslutning-med-pakken-nbclust" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Man kan også overveje at prøve noget mere automatisk. For eksempel, pakken <code>NbClust</code> laver 30 forskellige clustering-algoritmer på datasættet for antal clusters fra 2 op til 9, og for hver af disse tages en beslutning om det bedste antal clusters. Man kan således se, hvilket antal clusters der blev valgt flest gange af de forskellige algoritmer.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="clustering.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb544-2"><a href="clustering.html#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24</span>) <span class="co">#fordi outputtet fra NbClust har indbygget tilfældighed</span></span>
<span id="cb544-3"><a href="clustering.html#cb544-3" aria-hidden="true" tabindex="-1"></a>cluster_30_indexes <span class="ot">&lt;-</span> <span class="fu">NbClust</span>(<span class="at">data =</span> penguins_scaled, </span>
<span id="cb544-4"><a href="clustering.html#cb544-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">distance =</span> <span class="st">&quot;euclidean&quot;</span>, </span>
<span id="cb544-5"><a href="clustering.html#cb544-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">min.nc =</span> <span class="dv">2</span>, </span>
<span id="cb544-6"><a href="clustering.html#cb544-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">max.nc =</span> <span class="dv">9</span>, </span>
<span id="cb544-7"><a href="clustering.html#cb544-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<p>Som det ses nedenfor, er enten 2 eller 3 clusters optimalt, hvilket stemmer overens med ‘elbow’ plot-metoden.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="clustering.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(cluster_30_indexes<span class="sc">$</span>Best.nc[<span class="dv">1</span>,]) <span class="sc">%&gt;%</span></span>
<span id="cb545-2"><a href="clustering.html#cb545-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(value))) <span class="sc">+</span> </span>
<span id="cb545-3"><a href="clustering.html#cb545-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;count&quot;</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb545-4"><a href="clustering.html#cb545-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Antal clusters&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Antal clustering-algoritmer der vælger dette antal&quot;</span>) <span class="sc">+</span></span>
<span id="cb545-5"><a href="clustering.html#cb545-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb545-6"><a href="clustering.html#cb545-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-545-1.png" width="384" /></p>
</div>
<div id="visualisering-af-de-forskellige-antal-clusters-augment" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Visualisering af de forskellige antal clusters (augment)<a href="clustering.html#visualisering-af-de-forskellige-antal-clusters-augment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi kan også visualisere, hvordan de forskellige antal clusters tager sig ud. Her kan vi bruge vores resultater fra <code>augment</code>-funktionen (<code>kclusts_augment</code>), som indeholder tilknytningerne af observationerne til clusters for hver af de ni clusterings. Bemærk, at <code>kclusts_augment</code> har 2997 observationer. Dette svarer til 9 (antal clusterings) x 333 (antal observationer i <code>penguins</code>), fordi vi har brugt <code>unnest</code> til at samle alle resultaterne.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="clustering.html#cb546-1" aria-hidden="true" tabindex="-1"></a>kclusts_augment <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 2,997
## Columns: 13
## $ k                 &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ kclust            &lt;list&gt; [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ tidied            &lt;list&gt; [&lt;tbl_df[1 x 7]&gt;], [&lt;tbl_df[1 x 7]&gt;], [&lt;tbl_df[1 x …
## $ glanced           &lt;list&gt; [&lt;tbl_df[1 x 4]&gt;], [&lt;tbl_df[1 x 4]&gt;], [&lt;tbl_df[1 x …
## $ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
## $ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
## $ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, 36.7, 39.3, 38.9, 39.2, 41.1, 38.6…
## $ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, 19.3, 20.6, 17.8, 19.6, 17.6, 21.2…
## $ flipper_length_mm &lt;int&gt; 181, 186, 195, 193, 190, 181, 195, 182, 191, 198, 18…
## $ body_mass_g       &lt;int&gt; 3750, 3800, 3250, 3450, 3650, 3625, 4675, 3200, 3800…
## $ sex               &lt;fct&gt; male, female, female, female, male, female, male, fe…
## $ year              &lt;fct&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…
## $ .cluster          &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
<p>I den følgende kode laver jeg et plot af <code>flipper_length_mm</code> mod <code>bill_length_mm</code> og anvender <code>facet_wrap</code>, så hver clustering får sit eget plot (så der er 333 observationer pr. plot).</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="clustering.html#cb548-1" aria-hidden="true" tabindex="-1"></a>kclusts_augment <span class="sc">%&gt;%</span> </span>
<span id="cb548-2"><a href="clustering.html#cb548-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> bill_length_mm, <span class="at">colour=</span>.cluster)) <span class="sc">+</span></span>
<span id="cb548-3"><a href="clustering.html#cb548-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(species)), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb548-4"><a href="clustering.html#cb548-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span> k) <span class="sc">+</span> </span>
<span id="cb548-5"><a href="clustering.html#cb548-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-547-1.png" width="480" /></p>
<p>Vi kan nemt inddrage <code>kclusts_tidy()</code> og lave “X”-mærker ved blot at tilføje en ekstra <code>geom_point</code> og specificere <code>kclusts_tidy</code>. Først anvender jeg funktionen <code>rename</code>, så variablen <code>cluster</code> fra <code>kclusts_tidy</code> matcher <code>.cluster</code> fra <code>kclusts_augment</code>.</p>
<!-- Husk også at da `scale()` blev brugt til at lave clustering, skal man plotter `scale(flipper_length_mm)` og `scale(bill_length_mm)` på plottet, men `aes(x=flipper_length_mm,y=bill_length_mm)` lokalt, fordi jeg behøver ikke at anvende `scale()` igen på min centroids. -->
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="clustering.html#cb549-1" aria-hidden="true" tabindex="-1"></a>kclusts_tidy <span class="ot">&lt;-</span> kclusts_tidy <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">.cluster=</span>cluster)</span>
<span id="cb549-2"><a href="clustering.html#cb549-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-3"><a href="clustering.html#cb549-3" aria-hidden="true" tabindex="-1"></a>kclusts_augment <span class="sc">%&gt;%</span> </span>
<span id="cb549-4"><a href="clustering.html#cb549-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">scale</span>(flipper_length_mm), <span class="at">y =</span> <span class="fu">scale</span>(bill_length_mm),<span class="at">colour=</span>.cluster)) <span class="sc">+</span> <span class="co">#scale here</span></span>
<span id="cb549-5"><a href="clustering.html#cb549-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(species)), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb549-6"><a href="clustering.html#cb549-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span> k) <span class="sc">+</span> </span>
<span id="cb549-7"><a href="clustering.html#cb549-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">data =</span> kclusts_tidy,</span>
<span id="cb549-8"><a href="clustering.html#cb549-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x=</span>flipper_length_mm,<span class="at">y=</span>bill_length_mm), <span class="co">#already based on scaled data, so don&#39;t scale</span></span>
<span id="cb549-9"><a href="clustering.html#cb549-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="dv">10</span>, <span class="at">shape =</span> <span class="st">&quot;x&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb549-10"><a href="clustering.html#cb549-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-548-1.png" width="480" /></p>
<p>Vi kan forsøge at kigge endnu dybere ind i resultaterne - her introducerer jeg <code>sex</code> som en ekstra variabel i plottet. Husk, at variablen <code>sex</code> ikke blev brugt i vores k-means clustering, men det kan være, at der er nogle aspekter ved de fire variabler, som kan fortælle os noget om kønnet på pingvinerne. For at spare plads, har jeg kun vist antallet af clusters fra 2 til 5.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="clustering.html#cb550-1" aria-hidden="true" tabindex="-1"></a>kclusts_augment <span class="sc">%&gt;%</span> <span class="fu">filter</span>(k <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb550-2"><a href="clustering.html#cb550-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">scale</span>(flipper_length_mm), <span class="at">y =</span> <span class="fu">scale</span>(bill_length_mm),<span class="at">colour=</span>.cluster)) <span class="sc">+</span></span>
<span id="cb550-3"><a href="clustering.html#cb550-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span><span class="fu">factor</span>(species)), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb550-4"><a href="clustering.html#cb550-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_grid</span>(sex <span class="sc">~</span> k) <span class="sc">+</span> </span>
<span id="cb550-5"><a href="clustering.html#cb550-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">data =</span> kclusts_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(k <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb550-6"><a href="clustering.html#cb550-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm,</span>
<span id="cb550-7"><a href="clustering.html#cb550-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> bill_length_mm), </span>
<span id="cb550-8"><a href="clustering.html#cb550-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="dv">10</span>, <span class="at">shape =</span> <span class="st">&quot;x&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb550-9"><a href="clustering.html#cb550-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-549-1.png" width="960" /></p>
</div>
<div id="nestmap-ramme-fra-sidste-gang" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Nest/map-ramme fra sidste gang<a href="clustering.html#nestmap-ramme-fra-sidste-gang" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Som en sidste bemærkning med k-means, kan man også lave en clustering for hver af de tre arter separat. I det følgende opretter jeg en nested dataframe, som indeholder tre datasæt (<code>penguins</code> opdelt efter variablen <code>species</code>), og jeg anvender den brugerdefinerede funktion <code>scale_me</code> til at udvælge de numeriske variabler og anvende <code>scale()</code> på hvert datasæt.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="clustering.html#cb551-1" aria-hidden="true" tabindex="-1"></a>scale_me <span class="ot">&lt;-</span> <span class="er">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> scale</span>
<span id="cb551-2"><a href="clustering.html#cb551-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-3"><a href="clustering.html#cb551-3" aria-hidden="true" tabindex="-1"></a>penguins_nest <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb551-4"><a href="clustering.html#cb551-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb551-5"><a href="clustering.html#cb551-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb551-6"><a href="clustering.html#cb551-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;data_scaled&quot;</span> <span class="ot">=</span> <span class="fu">map</span>(data, scale_me))</span></code></pre></div>
<p>Dernæst laver jeg en brugerdefineret funktion til at lave en clustering på datasættet <code>.x</code>, og angiver at antallet af clusters skal være 3. Bemærk, at i den ovenstående sektion varierede vi antallet af clusters (indstilling <code>centers</code>), men her fastlægger vi antallet af clusters og varierer i stedet selve datasættet.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="clustering.html#cb552-1" aria-hidden="true" tabindex="-1"></a>cluster_me <span class="ot">&lt;-</span> <span class="er">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">kmeans</span>(<span class="at">centers=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Jeg anvender <code>cluster_me</code> på mine skalerede datasæt, og anvender derefter <code>glance</code>, <code>augment</code> og <code>tidy</code> på clustering-resultaterne ligesom tidligere (bemærk brugen af <code>map</code> til at <code>augment</code> de opdelte datasæt).</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="clustering.html#cb553-1" aria-hidden="true" tabindex="-1"></a>penguins_nest <span class="ot">&lt;-</span> penguins_nest <span class="sc">%&gt;%</span> </span>
<span id="cb553-2"><a href="clustering.html#cb553-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clusters =</span> <span class="fu">map</span>(data_scaled,cluster_me),</span>
<span id="cb553-3"><a href="clustering.html#cb553-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">clusters_glance =</span> <span class="fu">map</span>(clusters,glance),</span>
<span id="cb553-4"><a href="clustering.html#cb553-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">clusters_augment =</span> <span class="fu">map2</span>(clusters,data_scaled,<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">augment</span>(.y)), <span class="co">#I augment the scaled data so the correct scaling (based on individual datasets) appears in the next plot</span></span>
<span id="cb553-5"><a href="clustering.html#cb553-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">clusters_tidy =</span> <span class="fu">map</span>(clusters,tidy))</span>
<span id="cb553-6"><a href="clustering.html#cb553-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-7"><a href="clustering.html#cb553-7" aria-hidden="true" tabindex="-1"></a>nested_clusters_augment <span class="ot">&lt;-</span> penguins_nest <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(clusters_augment)</span>
<span id="cb553-8"><a href="clustering.html#cb553-8" aria-hidden="true" tabindex="-1"></a>nested_clusters_tidy <span class="ot">&lt;-</span> penguins_nest <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(clusters_tidy)</span></code></pre></div>
<p>Til sidste laver jeg en plot af resultaterne:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="clustering.html#cb554-1" aria-hidden="true" tabindex="-1"></a>nested_clusters_augment <span class="sc">%&gt;%</span> </span>
<span id="cb554-2"><a href="clustering.html#cb554-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>bill_length_mm,<span class="at">y=</span>flipper_length_mm,<span class="at">colour=</span>.cluster)) <span class="sc">+</span> <span class="co">#data already scaled</span></span>
<span id="cb554-3"><a href="clustering.html#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb554-4"><a href="clustering.html#cb554-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>species) <span class="sc">+</span> </span>
<span id="cb554-5"><a href="clustering.html#cb554-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nested_clusters_tidy,</span>
<span id="cb554-6"><a href="clustering.html#cb554-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="st">&quot;X&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb554-7"><a href="clustering.html#cb554-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb554-8"><a href="clustering.html#cb554-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-553-1.png" width="480" /></p>
</div>
</div>
<div id="metode-2-hierarchical-clustering" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Metode 2: Hierarchical clustering<a href="clustering.html#metode-2-hierarchical-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>K-means er en meget populær metode til at lave clustering, men der findes mange andre metoder, fx hierarkisk clustering. Vi skifter over til <code>mtcars</code>, og ligesom med <code>kmeans</code> skal vi først anvende <code>scale</code> på de numeriske kolonner i dataene.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="clustering.html#cb555-1" aria-hidden="true" tabindex="-1"></a>mtcars_scaled <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">scale</span>()</span></code></pre></div>
<p>I modsætning til k-means skal man først beregne afstanden mellem alle observationerne i dataene for at lave hierarkisk clustering. Det gør man med funktionen <code>dist()</code> (som bruger den euklidiske afstand som standard):</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="clustering.html#cb556-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(mtcars_scaled)</span></code></pre></div>
<p>For at lave en hierarkisk clustering anvender man funktionen <code>hclust()</code>. Metoden <code>complete</code> er standard, men man kan afprøve andre metoder (der er ikke en fast regel for, hvilken metode man skal bruge).</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="clustering.html#cb557-1" aria-hidden="true" tabindex="-1"></a>mtcars_hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span> )</span>
<span id="cb557-2"><a href="clustering.html#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Metoder: &quot;average&quot;, &quot;single&quot;, &quot;complete&quot;, &quot;ward.D&quot;</span></span></code></pre></div>
<p>I det følgende arbejder vi lidt med <code>mtcars_hc</code> for at få nogle clusters frem, og for at lave et plot.</p>
<div id="vælge-ønsket-antal-clusters" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Vælge ønsket antal clusters<a href="clustering.html#vælge-ønsket-antal-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>cutree</code> anvendes til at få clusters fra resultaterne af funktionen <code>hclust</code>. For eksempel, hvis man gerne vil have 4 clusters, bruger man <code>k = 4</code>. Jeg specificerer <code>order_clusters_as_data = FALSE</code> for at få clusters i den rækkefølge, som passer til det plot (dendrogram) vi laver (bemærk at man skal have pakken <code>dendextend</code> installeret for at få det til at fungere).</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="clustering.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span>
<span id="cb558-2"><a href="clustering.html#cb558-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-3"><a href="clustering.html#cb558-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(mtcars_hc, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">order_clusters_as_data =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Her laver jeg et overblik over, hvor mange observationer fra <code>mtcars</code> der er i hver cluster:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="clustering.html#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">&quot;cluster&quot;</span><span class="ot">=</span>clusters) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">n</span>())</span></code></pre></div>
<pre><code>FALSE # A tibble: 4 × 2
FALSE   cluster `n()`
FALSE     &lt;int&gt; &lt;int&gt;
FALSE 1       1     7
FALSE 2       2     8
FALSE 3       3    12
FALSE 4       4     5</code></pre>
</div>
<div id="lav-et-pænt-plot-af-dendrogrammet-med-ggplot2" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Lav et pænt plot af dendrogrammet med ggplot2<a href="clustering.html#lav-et-pænt-plot-af-dendrogrammet-med-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Først anvender jeg funktionen <code>dendro_data()</code> til at udtrække dendrogrammet fra <code>hclust()</code> resultaterne.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="clustering.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span>
<span id="cb561-2"><a href="clustering.html#cb561-2" aria-hidden="true" tabindex="-1"></a>dend_data <span class="ot">&lt;-</span> <span class="fu">dendro_data</span>(mtcars_hc <span class="sc">%&gt;%</span> as.dendrogram, <span class="at">type =</span> <span class="st">&quot;rectangle&quot;</span>)</span></code></pre></div>
<p>Vi tilføjer vores clusters, som vi beregnede ovenfor (det er derfor, vi sikrede rækkefølgen af clusters):</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="clustering.html#cb562-1" aria-hidden="true" tabindex="-1"></a>dend_data<span class="sc">$</span>labels <span class="ot">&lt;-</span> dend_data<span class="sc">$</span>labels <span class="sc">%&gt;%</span> </span>
<span id="cb562-2"><a href="clustering.html#cb562-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> clusters)</span></code></pre></div>
<p>Vi benytter <code>dend_data$segments</code> og <code>dend_data$labels</code> til at lave et informativt plot af dataene med <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="clustering.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dend_data<span class="sc">$</span>segments) <span class="sc">+</span> </span>
<span id="cb563-2"><a href="clustering.html#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb563-3"><a href="clustering.html#cb563-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb563-4"><a href="clustering.html#cb563-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dend_data<span class="sc">$</span>labels, </span>
<span id="cb563-5"><a href="clustering.html#cb563-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">label =</span> label,<span class="at">col=</span><span class="fu">factor</span>(cluster)),</span>
<span id="cb563-6"><a href="clustering.html#cb563-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb563-7"><a href="clustering.html#cb563-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb563-8"><a href="clustering.html#cb563-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dendro</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-561-1.png" width="480" /></p>
<p>Så kan man se, der er fire clusters i dengrammet, og biler der er tætest på hinanden ligner hinanden mest - fk. Merc 280C og Merc 280 må være meget éns, og er som forventet lige ved siden af hinanden i plottet.</p>
<p>Man kan godt tilpasse ovenstående kode til et andet datasæt - se problemstillinger, men man må også gerne udvide plottet med de forskellige viden vi har om ggplot2.</p>
</div>
<div id="ekstra-valgfri-afprøve-andre-metoder-på-hierachical-clustering" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Ekstra (valgfri): afprøve andre metoder på hierachical clustering<a href="clustering.html#ekstra-valgfri-afprøve-andre-metoder-på-hierachical-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Valfri</strong> ekstra hvis du vil afprøve de fire metoder i <code>hclust</code> - “average”, “single”, “complete” og “ward.D”.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="clustering.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co"># samme ggplot kommando som ovenpå lavet til en funktion </span></span>
<span id="cb564-2"><a href="clustering.html#cb564-2" aria-hidden="true" tabindex="-1"></a>den_plot <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">ggplot</span>(.x<span class="sc">$</span>segments) <span class="sc">+</span> </span>
<span id="cb564-3"><a href="clustering.html#cb564-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb564-4"><a href="clustering.html#cb564-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb564-5"><a href="clustering.html#cb564-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> .x<span class="sc">$</span>labels, </span>
<span id="cb564-6"><a href="clustering.html#cb564-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">label =</span> label),</span>
<span id="cb564-7"><a href="clustering.html#cb564-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb564-8"><a href="clustering.html#cb564-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">theme_dendro</span>()</span></code></pre></div>
<p>Vi iterate over de fire metoder og lave samme process som ovenpå med map. Derefter kan man lave et plot fk. med grid.arrange:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="clustering.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fire metoder:</span></span>
<span id="cb565-2"><a href="clustering.html#cb565-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;average&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;complete&quot;</span>, <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb565-3"><a href="clustering.html#cb565-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-4"><a href="clustering.html#cb565-4" aria-hidden="true" tabindex="-1"></a>hc_results <span class="ot">&lt;-</span> </span>
<span id="cb565-5"><a href="clustering.html#cb565-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">method =</span> m) <span class="sc">%&gt;%</span></span>
<span id="cb565-6"><a href="clustering.html#cb565-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">kclust =</span> <span class="fu">map</span>(method, <span class="sc">~</span><span class="fu">hclust</span>(d, <span class="at">method =</span> .x)), </span>
<span id="cb565-7"><a href="clustering.html#cb565-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="fu">map</span>(kclust,as.dendrogram),</span>
<span id="cb565-8"><a href="clustering.html#cb565-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">den_dat =</span> <span class="fu">map</span>(dendrogram,<span class="sc">~</span><span class="fu">dendro_data</span>(.x,<span class="at">type=</span><span class="st">&quot;rectangle&quot;</span>)),</span>
<span id="cb565-9"><a href="clustering.html#cb565-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot =</span> <span class="fu">map</span>(den_dat,den_plot))</span>
<span id="cb565-10"><a href="clustering.html#cb565-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-11"><a href="clustering.html#cb565-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb565-12"><a href="clustering.html#cb565-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hc_results <span class="sc">%&gt;%</span> <span class="fu">pull</span>(plot),<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-563-1.png" width="480" /></p>
</div>
</div>
<div id="problemstillinger-8" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Problemstillinger<a href="clustering.html#problemstillinger-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1</strong>) Quiz - Clustering</p>
<hr />
<p><strong>Problem 2</strong>) <em>Funktionen kmeans</em>. I ovenstående brugte vi <code>mtcars</code> i hierarchical clustering, men lad os se, hvordan det ser ud med <code>k-means</code>. Du er velkommen til at tilpasse min ovenstående kode, som jeg brugte til <code>penguins</code> datasættet:</p>
<p><strong>a</strong>) Benyt <code>kmeans</code> til at finde 2 clusters i datasættet <code>mtcars</code>:</p>
<ul>
<li>Husk at vælge kun de numeriske kolonner og skalér datasættet på forhånd.</li>
<li>Gem din clustering som <code>my_clusters</code>.</li>
<li>Hvor mange observationer er der i hver af de to clusters?</li>
</ul>
<p><strong>b</strong>) Brug funktionen <code>augment</code> til at forbinde det oprindelige datasæt til dine clusters fra <code>my_clusters</code> (skriv <code>mtcars</code> indenfor funktionen <code>augment</code>).</p>
<p><strong>c</strong>) Brug dit “augmenterede” datasæt til at lave et scatterplot mellem to af de numeriske variabler (du vælger selv hvilke) i datasættet, og farvelæg dem efter dine beregnede klynger. Da du har knyttet det oprindelige datasæt (som ikke var skaleret) i <code>augment()</code>-funktionen, skal du skalere dine variabler i plottet.</p>
<p><strong>d</strong>) Tilføj <code>tidy()</code>-funktionen for at få fat i middelværdierne/centroids for hver af de 2 clusters, og tilpas min kode fra notaterne (sektion 9.2.5) for at tilføje dem til plottet som ‘x’ (husk at din “centers”/centroids er allerede baserede på scaled data så du behøver ikke at anvende scale på deres værdier).</p>
<hr />
<p><strong>Problem 3</strong>) <em>Hierarchical clustering øvelse</em></p>
<p>Vi laver en analyse af det <code>msleep</code> datasæt. Jeg har lavet oprydningen og scaling for dig:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="clustering.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(msleep)</span>
<span id="cb566-2"><a href="clustering.html#cb566-2" aria-hidden="true" tabindex="-1"></a>msleep_clean <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> <span class="fu">select</span>(name,<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb566-3"><a href="clustering.html#cb566-3" aria-hidden="true" tabindex="-1"></a>msleep_scaled <span class="ot">&lt;-</span> msleep_clean <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> scale</span>
<span id="cb566-4"><a href="clustering.html#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(msleep_scaled) <span class="ot">&lt;-</span> msleep_clean<span class="sc">$</span>name</span></code></pre></div>
<p>Tilpas min kode fra kursusnotaterne (sektion 9.4) til at lave følgende:</p>
<p><strong>a</strong>) Benyt funktioner <code>dist()</code> og dernæst <code>hclust()</code> på datasættet <code>msleep_scaled</code>.</p>
<p><strong>b</strong>) Benyt <code>cutree</code> for at finde 5 clusters fra dine <code>hclust</code>-resultater, og kalde det for <code>clusters</code>. Husk at anvende <code>order_clusters_as_data = FALSE</code> så at vi har den korrekt rækkefølge for et plot (<em>OBS man skal installere/indlæse pakken <code>dendextend</code></em>)</p>
<p><strong>c</strong>) Benyt <code>dendro_data</code> til at udtrække de dendrogram fra resultaterne og tilføj <code>clusters</code> til <code>dend_data$labels</code> (kopier kode fra 9.4.2).</p>
<p><strong>d</strong>) Lav et dengrogram plot: igen tilpas koden (9.4.2) for <code>mtcars</code> eksempel for nuværende data</p>
<hr />
<p><strong>Problem 4)</strong></p>
<p>Inlæs data</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="clustering.html#cb567-1" aria-hidden="true" tabindex="-1"></a>wholesale <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.dropbox.com/s/7nb5pkruqt4fqn4/Wholesale%20customers%20data.csv?dl=1&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><strong>a</strong>) Foretag ændringer i datasættet i henhold til følgende instruktioner (og husk at gemme):</p>
<ul>
<li>Channel - anvend <code>recode</code> for at ændre til navne
<ul>
<li>1 = horeca</li>
<li>2 = retail</li>
</ul></li>
<li>Region - anvend <code>recode</code> for at ændre til navne
<ul>
<li>1 = Lisnon</li>
<li>2 = Oporto</li>
<li>3 = Other</li>
</ul></li>
<li>Anvend <code>map_if</code> til at transformere samtlige numeriske variabler med <code>log</code> (sektion 7.5.2)</li>
</ul>
<p><strong>b</strong>) Udvælg de numeriske variabler fra dit datasæt og anvende <code>scale()</code> - kalde dit nye datasæt for <code>wholescale_scale</code></p>
<p><strong>c</strong>) Tilpas min kode fra sektion 9.3.1 til at lave 10 clusterings (k=1:10) på <code>wholesale_scale</code> og gem dem i en dataframe, sammen med din clusterings resultater i “tidy”, “glance” og “augment” form.</p>
<p><strong>d</strong>) Lav et elbow plot fra dit output fra <code>glance</code> (sektion 9.3.2)</p>
<p><strong>e</strong>) Udvælg clusterings hvor k er fra 2 til 7 fra dit output fra <code>augment</code> og lav scatter plots af variabler <code>Frozen</code> VS <code>Fresh</code>, hvor du:</p>
<ul>
<li>Giv farve efter .cluster</li>
<li>Adskil plots efter <code>k</code></li>
<li>Prøv dernæst at adskille dit plots yderligere efter <code>Channel</code>.</li>
</ul>
<!-- __f)__ Tag udgangspunkt i dit output fra `tidy` hvor antal clusters er 4 - lav et barplot for at vise middelværdier/centroids fra din clustering. -->
<!-- ```{r,echo=F,eval=F} -->
<!-- kmeans_tidy %>%  -->
<!--   filter(k==4) %>%  -->
<!--   pivot_longer(cols=colnames(wholesale_scale)) %>% -->
<!--   ggplot(aes(x=cluster,y=value,fill=name)) +  -->
<!--   geom_bar(stat="identity",position="dodge",colour="black")  -->
<!-- ``` -->
<p><strong>f)</strong> Tilpas koden fra 9.3.5 til at lave en analyse for “hoerca” og “retail” (variablen <code>Channel</code>) hver for sig. Angiv 4 clusters i din analyse.</p>
<p><strong>g)</strong> Lav et plot af din clustering (adskilt efter variablen <code>Channel</code>) og få “x” på plotterne til at vise din cluster middelværdier for <code>Frozen</code> og <code>Fresh</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualisering-af-trends.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="principal-component-analysis-pca.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["visualisering_22.pdf", "visualisering_22.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
