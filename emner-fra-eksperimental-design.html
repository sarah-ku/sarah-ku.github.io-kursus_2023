<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Emner fra eksperimental design | Analyse og visualisering af biologiske datasæt - 2023</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Emner fra eksperimental design | Analyse og visualisering af biologiske datasæt - 2023" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Emner fra eksperimental design | Analyse og visualisering af biologiske datasæt - 2023" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

<meta name="author" content="Sarah Rennie" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="principal-component-analysis-pca.html"/>
<link rel="next" href="maskinslæring-i-tidyverse.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering kursus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#vectorer"><i class="fa fa-check"></i><b>1.6.1</b> Vectorer</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#datatyper"><i class="fa fa-check"></i><b>1.6.2</b> datatyper</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#delmængder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmængder af dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ifelse"><i class="fa fa-check"></i><b>1.8</b> If/else</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#loops"><i class="fa fa-check"></i><b>1.9</b> Loops</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.10</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.10.1</b> Simulere data fra den normale fordeling</a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.10.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#tapply"><i class="fa fa-check"></i><b>1.10.3</b> <code>tapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#statistike-tester"><i class="fa fa-check"></i><b>1.11</b> Statistike tester</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="index.html"><a href="index.html#p-værdien"><i class="fa fa-check"></i><b>1.11.1</b> P-værdien</a></li>
<li class="chapter" data-level="1.11.2" data-path="index.html"><a href="index.html#korrelation"><i class="fa fa-check"></i><b>1.11.2</b> Korrelation</a></li>
<li class="chapter" data-level="1.11.3" data-path="index.html"><a href="index.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.11.3</b> Test for uafhængighed (chi-sq test)</a></li>
<li class="chapter" data-level="1.11.4" data-path="index.html"><a href="index.html#sample-t-test"><i class="fa fa-check"></i><b>1.11.4</b> 1 sample t-test</a></li>
<li class="chapter" data-level="1.11.5" data-path="index.html"><a href="index.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.11.5</b> 2-sample t-test</a></li>
<li class="chapter" data-level="1.11.6" data-path="index.html"><a href="index.html#paired-t-test"><i class="fa fa-check"></i><b>1.11.6</b> Paired t-test</a></li>
<li class="chapter" data-level="1.11.7" data-path="index.html"><a href="index.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.11.7</b> ANOVA (variansanalyse)</a></li>
<li class="chapter" data-level="1.11.8" data-path="index.html"><a href="index.html#lineær-regression"><i class="fa fa-check"></i><b>1.11.8</b> Lineær regression</a></li>
<li class="chapter" data-level="1.11.9" data-path="index.html"><a href="index.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.11.9</b> R-squared coefficient of determination</a></li>
<li class="chapter" data-level="1.11.10" data-path="index.html"><a href="index.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.11.10</b> Antagelser - lineær regression</a></li>
<li class="chapter" data-level="1.11.11" data-path="index.html"><a href="index.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.11.11</b> Multiple lineær regression</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#problemstillinger"><i class="fa fa-check"></i><b>1.12</b> Problemstillinger</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="index.html"><a href="index.html#quiz---basics"><i class="fa fa-check"></i><b>1.12.1</b> Quiz - Basics</a></li>
<li class="chapter" data-level="1.12.2" data-path="index.html"><a href="index.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.12.2</b> Grundlæggende R</a></li>
<li class="chapter" data-level="1.12.3" data-path="index.html"><a href="index.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.12.3</b> Kort analyse med reaktionstider</a></li>
<li class="chapter" data-level="1.12.4" data-path="index.html"><a href="index.html#øvelse-med-co2"><i class="fa fa-check"></i><b>1.12.4</b> Øvelse med CO2</a></li>
<li class="chapter" data-level="1.12.5" data-path="index.html"><a href="index.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.12.5</b> Ekstra øvelser med statistik tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.1</b> Hvad er R Markdown?</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Installere R Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.3</b> Videodemonstrationer</a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.4</b> Oprette et nyt dokument i R Markdown</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.4.1</b> YAML</a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.4.2</b> Globale options</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.5</b> Skrive baseret tekst</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.5.1</b> Headers</a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.5.2</b> liste</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.6</b> Knitte kode</a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.7</b> Kode chunks</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.7.1</b> Et godt råd når man arbejder med chunks</a></li>
<li class="chapter" data-level="2.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.7.2</b> Chunk indstillinger</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-inden-for-teksten-i-dokumentet-inline-code"><i class="fa fa-check"></i><b>2.8</b> R beregninger inden for teksten i dokumentet (‘inline code’)</a></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.9</b> Working directory</a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.10</b> Matematik</a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.11</b> Problemstillinger</a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.12</b> Færdig for i dag og næste gang</a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.13</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#inledning-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Inledning og videoer</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-for-dag-1"><i class="fa fa-check"></i><b>3.1.1</b> Læringsmålene for dag 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.2</b> Hvad er <strong>ggplot2</strong>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.3</b> Brugen af materialerne</a></li>
<li class="chapter" data-level="3.1.4" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.4</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2</a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot</a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax</a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?</a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#globale-versus-lokale-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Globale versus lokale æstetik</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel</a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver</a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema</a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)</a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)</a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)</a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)</a></li>
<li class="chapter" data-level="3.8.5" data-path="visual1.html"><a href="visual1.html#line-plot-geom_line"><i class="fa fa-check"></i><b>3.8.5</b> Line plot (<code>geom_line()</code>)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#indledning-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Indledning og videoer</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#læringsmålene"><i class="fa fa-check"></i><b>4.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="4.1.2" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.2</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)</a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).</a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver</a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver</a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-labels-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføjelse af labels direkte på plottet.</a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller</a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføjelse af rektangler i regioner af interesse (<code>annotate</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot</a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning dag 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#hvad-er-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Hvad er Tidyverse?</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-for-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper for ‘tidy data’</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-r-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base-R til tidyverse</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasættet"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasættet</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-rengøring"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: Rengøring</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#sammenligningsoperatorer"><i class="fa fa-check"></i><b>5.7.3</b> Sammenligningsoperatorer</a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2</a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#misc-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Misc funktioner som er nyttige at vide</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull</a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning dag 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#indledning-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Indledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#læringsmålene-1"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="6.1.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code>-funktioner</a></li>
<li class="chapter" data-level="6.2.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#flere-summeringsstatistikker-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summeringsstatistikker på én gang</a></li>
<li class="chapter" data-level="6.2.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#mere-avanceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere avanceret <code>group_by()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt"><i class="fa fa-check"></i><b>6.3.1</b> Tidyr pakke - oversigt</a></li>
<li class="chapter" data-level="6.3.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Wide -&gt; Long med <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#eksempel-titanic-opsummeringsstatistikker"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic opsummeringsstatistikker</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration af <code>pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> Funktionen <code>left_join()</code> fra dplyr-pakken</a></li>
<li class="chapter" data-level="6.5.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#anvend-left_join-for-vores-datasæt."><i class="fa fa-check"></i><b>6.5.2</b> Anvend <code>left_join()</code> for vores datasæt.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="6.7" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#ekstra-links-1"><i class="fa fa-check"></i><b>6.7</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#læringsmål"><i class="fa fa-check"></i><b>7.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="7.1.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#videorressourcer"><i class="fa fa-check"></i><b>7.1.2</b> Videorressourcer</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterative-processer-med-map-funktioner"><i class="fa fa-check"></i><b>7.2</b> Iterative processer med <code>map()</code> funktioner</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner</a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-de-forskellige-map-funktioner"><i class="fa fa-check"></i><b>7.2.2</b> Reference for de forskellige map-funktioner</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner"><i class="fa fa-check"></i><b>7.3</b> Brugerdefinerede funktioner</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-funktioner"><i class="fa fa-check"></i><b>7.3.1</b> Simple funktioner</a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner-med-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Brugerdefinerede funktioner med mapping</a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-datatyper"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre datatyper</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-med-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting med <code>nest()</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvendelse-af-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvendelse af map() med nested data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-funktion-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> funktion for flere inputs</a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformering-af-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformering af numeriske variabler</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html"><i class="fa fa-check"></i><b>8</b> Visualisering af trends</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#indledning-og-læringsmål"><i class="fa fa-check"></i><b>8.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#læringsmål-1"><i class="fa fa-check"></i><b>8.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="8.1.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#introduktion-til-kapitlet"><i class="fa fa-check"></i><b>8.1.2</b> Introduktion til kapitlet</a></li>
<li class="chapter" data-level="8.1.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#videoressourcer"><i class="fa fa-check"></i><b>8.1.3</b> Videoressourcer</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#nest-og-map-eksempel-med-korrelation"><i class="fa fa-check"></i><b>8.2</b> <code>nest()</code> og <code>map()</code>: eksempel med korrelation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#korrelation-over-flere-datasæt-på-en-gang"><i class="fa fa-check"></i><b>8.2.1</b> Korrelation over flere datasæt på en gang</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-regression---visualisering"><i class="fa fa-check"></i><b>8.3</b> Lineær regression - visualisering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineære-trends"><i class="fa fa-check"></i><b>8.3.1</b> Lineære trends</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-lm-trendlinjer"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_smooth()</code>: <code>lm</code> trendlinjer</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-flere-lm-trendlinjer-på-samme-plot"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_smooth()</code>: flere <code>lm</code> trendlinjer på samme plot</a></li>
<li class="chapter" data-level="8.3.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#trendlinjer-med-methodloess"><i class="fa fa-check"></i><b>8.3.4</b> Trendlinjer med <code>method=="loess"</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#plot-linear-regresion-estimates"><i class="fa fa-check"></i><b>8.4</b> Plot linear regresion estimates</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anvendelse-af-lm-over-nestede-datasæt"><i class="fa fa-check"></i><b>8.4.1</b> Anvendelse af <code>lm()</code> over nestede datasæt</a></li>
<li class="chapter" data-level="8.4.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#funktionen-glue-til-at-tilføje-etiketter"><i class="fa fa-check"></i><b>8.4.2</b> Funktionen <code>glue()</code> til at tilføje etiketter</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#multipel-regression-og-model-sammenligning"><i class="fa fa-check"></i><b>8.5</b> Multipel regression og model sammenligning</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anova-til-at-sammenligne-de-forskellige-modeller"><i class="fa fa-check"></i><b>8.5.1</b> <code>anova</code> til at sammenligne de forskellige modeller</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#problemstillinger-7"><i class="fa fa-check"></i><b>8.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="8.7" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#ekstra"><i class="fa fa-check"></i><b>8.7</b> Ekstra</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#indledning-og-læringsmål-1"><i class="fa fa-check"></i><b>9.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="clustering.html"><a href="clustering.html#læringsmål-2"><i class="fa fa-check"></i><b>9.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="9.1.2" data-path="clustering.html"><a href="clustering.html#indledning-til-kapitel"><i class="fa fa-check"></i><b>9.1.2</b> Indledning til kapitel</a></li>
<li class="chapter" data-level="9.1.3" data-path="clustering.html"><a href="clustering.html#video-ressourcer-3"><i class="fa fa-check"></i><b>9.1.3</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#method-1-k-means-clustering"><i class="fa fa-check"></i><b>9.2</b> Method 1: K-means clustering</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="clustering.html"><a href="clustering.html#hvordan-fungerer-kmeans"><i class="fa fa-check"></i><b>9.2.1</b> Hvordan fungerer kmeans?</a></li>
<li class="chapter" data-level="9.2.2" data-path="clustering.html"><a href="clustering.html#withinbetween-sum-of-squares"><i class="fa fa-check"></i><b>9.2.2</b> Within/between sum of squares</a></li>
<li class="chapter" data-level="9.2.3" data-path="clustering.html"><a href="clustering.html#kør-k-means-i-r"><i class="fa fa-check"></i><b>9.2.3</b> Kør k-means i R</a></li>
<li class="chapter" data-level="9.2.4" data-path="clustering.html"><a href="clustering.html#ryd-op-i-k-means-resultaterne-med-pakken-broom"><i class="fa fa-check"></i><b>9.2.4</b> Ryd op i k-means resultaterne med pakken <code>broom</code></a></li>
<li class="chapter" data-level="9.2.5" data-path="clustering.html"><a href="clustering.html#plotcentroids"><i class="fa fa-check"></i><b>9.2.5</b> Plot cluster centroids</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#kmeans-hvor-mange-clusters"><i class="fa fa-check"></i><b>9.3</b> Kmeans: hvor mange clusters?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="clustering.html"><a href="clustering.html#få-broom-output-for-forskellige-antal-clusters"><i class="fa fa-check"></i><b>9.3.1</b> Få Broom output for forskellige antal clusters</a></li>
<li class="chapter" data-level="9.3.2" data-path="clustering.html"><a href="clustering.html#elbow-plot-glance"><i class="fa fa-check"></i><b>9.3.2</b> Elbow plot (glance)</a></li>
<li class="chapter" data-level="9.3.3" data-path="clustering.html"><a href="clustering.html#automatisk-beslutning-med-pakken-nbclust"><i class="fa fa-check"></i><b>9.3.3</b> Automatisk beslutning med pakken <code>NbClust</code></a></li>
<li class="chapter" data-level="9.3.4" data-path="clustering.html"><a href="clustering.html#visualisering-af-de-forskellige-antal-clusters-augment"><i class="fa fa-check"></i><b>9.3.4</b> Visualisering af de forskellige antal clusters (augment)</a></li>
<li class="chapter" data-level="9.3.5" data-path="clustering.html"><a href="clustering.html#nestmap-ramme-fra-sidste-gang"><i class="fa fa-check"></i><b>9.3.5</b> Nest/map-ramme fra sidste gang</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#metode-2-hierarchical-clustering"><i class="fa fa-check"></i><b>9.4</b> Metode 2: Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="clustering.html"><a href="clustering.html#vælge-ønsket-antal-clusters"><i class="fa fa-check"></i><b>9.4.1</b> Vælge ønsket antal clusters</a></li>
<li class="chapter" data-level="9.4.2" data-path="clustering.html"><a href="clustering.html#lav-et-pænt-plot-af-dendrogrammet-med-ggplot2"><i class="fa fa-check"></i><b>9.4.2</b> Lav et pænt plot af dendrogrammet med ggplot2</a></li>
<li class="chapter" data-level="9.4.3" data-path="clustering.html"><a href="clustering.html#ekstra-valgfri-afprøve-andre-metoder-på-hierachical-clustering"><i class="fa fa-check"></i><b>9.4.3</b> Ekstra (valgfri): afprøve andre metoder på hierachical clustering</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#problemstillinger-8"><i class="fa fa-check"></i><b>9.5</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i><b>10</b> Principal component analysis (PCA)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#indledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>10.1</b> Indledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#læringsmålene-2"><i class="fa fa-check"></i><b>10.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="10.1.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#introduktion-til-kapitlet-1"><i class="fa fa-check"></i><b>10.1.2</b> Introduktion til kapitlet</a></li>
<li class="chapter" data-level="10.1.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#videoressourcer-1"><i class="fa fa-check"></i><b>10.1.3</b> Videoressourcer</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#hvad-er-principal-component-analysis-pca"><i class="fa fa-check"></i><b>10.2</b> Hvad er principal component analysis (PCA)?</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#simpelt-eksempel-med-to-dimensioner"><i class="fa fa-check"></i><b>10.2.1</b> Simpelt eksempel med to dimensioner</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#fit-pca-to-data-in-r"><i class="fa fa-check"></i><b>10.3</b> Fit PCA to data in R</a></li>
<li class="chapter" data-level="10.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#integrering-af-pca-resultater-med-broom-pakken"><i class="fa fa-check"></i><b>10.4</b> Integrering af PCA-resultater med broom-pakken</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#rotationsmatrix-for-at-udtrække-bidragene-fra-de-forskellige-variabler"><i class="fa fa-check"></i><b>10.4.1</b> Rotationsmatrix for at udtrække bidragene fra de forskellige variabler</a></li>
<li class="chapter" data-level="10.4.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#pakken-factoextra"><i class="fa fa-check"></i><b>10.4.2</b> Pakken <code>factoextra</code></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#problemstillinger-9"><i class="fa fa-check"></i><b>10.5</b> Problemstillinger</a></li>
<li class="chapter" data-level="10.6" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#ekstra-læsning"><i class="fa fa-check"></i><b>10.6</b> Ekstra læsning</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html"><i class="fa fa-check"></i><b>11</b> Emner fra eksperimental design</a>
<ul>
<li class="chapter" data-level="11.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#inledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>11.1</b> Inledning og læringsmålene</a></li>
<li class="chapter" data-level="11.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#indledning-og-læringsmål-2"><i class="fa fa-check"></i><b>11.2</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#læringsmål-3"><i class="fa fa-check"></i><b>11.2.1</b> Læringsmål</a></li>
<li class="chapter" data-level="11.2.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#indledning-til-kapitlet"><i class="fa fa-check"></i><b>11.2.2</b> Indledning til kapitlet</a></li>
<li class="chapter" data-level="11.2.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#video-ressourcer-4"><i class="fa fa-check"></i><b>11.2.3</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#grundlæggende-principper-i-eksperimentelt-design"><i class="fa fa-check"></i><b>11.3</b> Grundlæggende principper i eksperimentelt design</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#randomisering-og-replikation"><i class="fa fa-check"></i><b>11.3.1</b> Randomisering og replikation</a></li>
<li class="chapter" data-level="11.3.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#eksempel-med-datasættet-toothgrowth"><i class="fa fa-check"></i><b>11.3.2</b> Eksempel med datasættet <code>ToothGrowth</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-simpsons-paradoks"><i class="fa fa-check"></i><b>11.4</b> Case studies: Simpsons paradoks</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#optagelse-på-berkeley"><i class="fa fa-check"></i><b>11.4.1</b> Optagelse på Berkeley</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-anscombes-kvartet"><i class="fa fa-check"></i><b>11.5</b> Case studies: Anscombes kvartet</a></li>
<li class="chapter" data-level="11.6" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#undersøgelse-af-batch-effekter"><i class="fa fa-check"></i><b>11.6</b> Undersøgelse af “batch-effekter”</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#principal-component-analyse"><i class="fa fa-check"></i><b>11.6.1</b> Principal component analyse</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#problemstillinger-10"><i class="fa fa-check"></i><b>11.7</b> Problemstillinger</a></li>
<li class="chapter" data-level="11.8" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#yderligere-læsning"><i class="fa fa-check"></i><b>11.8</b> Yderligere læsning</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html"><i class="fa fa-check"></i><b>12</b> Maskinslæring i tidyverse</a>
<ul>
<li class="chapter" data-level="12.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#indledning-og-læringsmål-3"><i class="fa fa-check"></i><b>12.1</b> Indledning og læringsmål</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#læringsmålene-3"><i class="fa fa-check"></i><b>12.1.1</b> Læringsmålene</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#videomateriale"><i class="fa fa-check"></i><b>12.2</b> Videomateriale</a></li>
<li class="chapter" data-level="12.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#regressionsmodeller"><i class="fa fa-check"></i><b>12.3</b> Regressionsmodeller</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#oprettelse-af-test--og-træningssæt"><i class="fa fa-check"></i><b>12.3.1</b> Oprettelse af test- og træningssæt</a></li>
<li class="chapter" data-level="12.3.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#krydsvalidering-cross-fold-validation"><i class="fa fa-check"></i><b>12.3.2</b> Krydsvalidering (cross-fold validation)</a></li>
<li class="chapter" data-level="12.3.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#opbygning-af-modellen-og-lave-forudsigelser"><i class="fa fa-check"></i><b>12.3.3</b> Opbygning af modellen og lave forudsigelser</a></li>
<li class="chapter" data-level="12.3.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#evaluering-af-resultater-på-valideringssættet"><i class="fa fa-check"></i><b>12.3.4</b> Evaluering af resultater på valideringssættet</a></li>
<li class="chapter" data-level="12.3.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#test-og-evaluering-af-final-model"><i class="fa fa-check"></i><b>12.3.5</b> Test og evaluering af “final” model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#klassifikationsmodeller"><i class="fa fa-check"></i><b>12.4</b> Klassifikationsmodeller</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#splitte-datasættet-og-lave-cross-validation-dataframe"><i class="fa fa-check"></i><b>12.4.1</b> Splitte datasættet og lave cross-validation dataframe</a></li>
<li class="chapter" data-level="12.4.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#definere-klassifikationsmodel"><i class="fa fa-check"></i><b>12.4.2</b> Definere klassifikationsmodel</a></li>
<li class="chapter" data-level="12.4.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#anvende-modellen-og-lave-predictions"><i class="fa fa-check"></i><b>12.4.3</b> Anvende modellen og lave predictions</a></li>
<li class="chapter" data-level="12.4.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#beregne-nøjagtighed"><i class="fa fa-check"></i><b>12.4.4</b> Beregne nøjagtighed</a></li>
<li class="chapter" data-level="12.4.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#parameterjustering"><i class="fa fa-check"></i><b>12.4.5</b> Parameterjustering</a></li>
<li class="chapter" data-level="12.4.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#oprette-endelig-model-med-titanic-datasæt"><i class="fa fa-check"></i><b>12.4.6</b> Oprette endelig model med titanic datasæt</a></li>
<li class="chapter" data-level="12.4.7" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#variable-importance"><i class="fa fa-check"></i><b>12.4.7</b> Variable importance</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#problemstillinger-11"><i class="fa fa-check"></i><b>12.5</b> Problemstillinger</a></li>
<li class="chapter" data-level="12.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#yderligere-kommentarer-og-pakker"><i class="fa fa-check"></i><b>12.6</b> Yderligere kommentarer og pakker</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html"><i class="fa fa-check"></i><b>13</b> Presæntering af datasæt over for andre</a>
<ul>
<li class="chapter" data-level="13.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#introduktion-til-chapter-og-læringsmålene"><i class="fa fa-check"></i><b>13.1</b> Introduktion til chapter og læringsmålene</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#læringsmål-4"><i class="fa fa-check"></i><b>13.1.1</b> Læringsmål</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#video-ressourcer-5"><i class="fa fa-check"></i><b>13.2</b> Video ressourcer</a></li>
<li class="chapter" data-level="13.3" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#interactiv-plots"><i class="fa fa-check"></i><b>13.3</b> Interactiv plots</a></li>
<li class="chapter" data-level="13.4" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#shiny"><i class="fa fa-check"></i><b>13.4</b> Shiny</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#eksempler-der-demonstrerer-shiny"><i class="fa fa-check"></i><b>13.4.1</b> Eksempler der demonstrerer Shiny</a></li>
<li class="chapter" data-level="13.4.2" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#create-new-app"><i class="fa fa-check"></i><b>13.4.2</b> Create new app</a></li>
<li class="chapter" data-level="13.4.3" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#struktur-af-en-shiny-app"><i class="fa fa-check"></i><b>13.4.3</b> Struktur af en Shiny App</a></li>
<li class="chapter" data-level="13.4.4" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#minimal-example-men-ikke-interaktiv"><i class="fa fa-check"></i><b>13.4.4</b> Minimal example (men ikke interaktiv)</a></li>
<li class="chapter" data-level="13.4.5" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#minimalt-eksempel---interaktivt"><i class="fa fa-check"></i><b>13.4.5</b> Minimalt eksempel - interaktivt</a></li>
<li class="chapter" data-level="13.4.6" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#flere-plots-på-samme-shiny-app"><i class="fa fa-check"></i><b>13.4.6</b> Flere plots på samme Shiny app</a></li>
<li class="chapter" data-level="13.4.7" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#inkludering-af-en-tabel"><i class="fa fa-check"></i><b>13.4.7</b> Inkludering af en tabel</a></li>
<li class="chapter" data-level="13.4.8" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#add-a-slider"><i class="fa fa-check"></i><b>13.4.8</b> Add a slider</a></li>
<li class="chapter" data-level="13.4.9" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#ekstras-som-man-kan-tilføje-til-ui"><i class="fa fa-check"></i><b>13.4.9</b> Ekstras som man kan tilføje til <code>ui</code></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#yderligere-generelle-råd"><i class="fa fa-check"></i><b>13.5</b> Yderligere generelle råd</a></li>
<li class="chapter" data-level="13.6" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#andre-mulighederadvanceret-topics"><i class="fa fa-check"></i><b>13.6</b> Andre muligheder/advanceret topics</a></li>
<li class="chapter" data-level="13.7" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#problemstillinger-12"><i class="fa fa-check"></i><b>13.7</b> Problemstillinger</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt - 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="emner-fra-eksperimental-design" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Emner fra eksperimental design<a href="emner-fra-eksperimental-design.html#emner-fra-eksperimental-design" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="emner-fra-eksperimental-design.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb597-2"><a href="emner-fra-eksperimental-design.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code></pre></div>
<p>“Amatører sidder og venter på inspiration, resten af os står bare op og går på arbejde.” - Stephen King</p>
<div id="inledning-og-læringsmålene-1" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Inledning og læringsmålene<a href="emner-fra-eksperimental-design.html#inledning-og-læringsmålene-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="indledning-og-læringsmål-2" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Indledning og læringsmål<a href="emner-fra-eksperimental-design.html#indledning-og-læringsmål-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="læringsmål-3" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Læringsmål<a href="emner-fra-eksperimental-design.html#læringsmål-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I skal være i stand til at</p>
<ul>
<li>Beskrive randomisering, replikation og blokering</li>
<li>Beskrive Simpsons paradoks</li>
<li>Beskrive Anscombes kvartet</li>
<li>Kontrollere for batch-effekter med PCA</li>
</ul>
</div>
<div id="indledning-til-kapitlet" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Indledning til kapitlet<a href="emner-fra-eksperimental-design.html#indledning-til-kapitlet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formålet med dette kapitel er at spørge: Hvordan kan vi anvende de værktøjer, vi har lært i kurset, til at undersøge forskellige emner inden for eksperimentelt design? Dette er ikke en grundig introduktion til eksperimentelt design, men snarere en præsentation af nogle nyttige og interessante emner, der effektivt illustrerer, hvorfor det er vigtigt at lave passende visualiseringer af dine data. Forståelsen af, hvordan batch-effekter påvirker en analyse, er særlig vigtig inden for biologifaget, hvor mange store sekventeringsprojekter involverer data indsamlet eller sekventeret over forskellige batches, sekventeringsmaskiner eller forskellige forberedelsesmetoder.</p>
</div>
<div id="video-ressourcer-4" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Video ressourcer<a href="emner-fra-eksperimental-design.html#video-ressourcer-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Part 1: randomisation, replikation, blocking + confounding
<ul>
<li>Ingen video: læs gerne notaterne nedenfor</li>
</ul></li>
</ul>
<hr />
<ul>
<li>Part 2: Simpson’s paradox</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/556581563" class="uri">https://player.vimeo.com/video/556581563</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/556581563" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Part 3: Anscombe’s quartet</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/556581540" class="uri">https://player.vimeo.com/video/556581540</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/556581540" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Part 4: Batch effects and principal component analysis.</li>
</ul>
<p><em>OBS Man kan selvfølgelige også anvende <code>map_if()</code> til at log-transformere.</em></p>
<!-- Der er også nogle esktra notater om heatmaps (hvis interesseret, frivilligt) -->
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/556581521" class="uri">https://player.vimeo.com/video/556581521</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/556581521" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<div id="grundlæggende-principper-i-eksperimentelt-design" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Grundlæggende principper i eksperimentelt design<a href="emner-fra-eksperimental-design.html#grundlæggende-principper-i-eksperimentelt-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="randomisering-og-replikation" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Randomisering og replikation<a href="emner-fra-eksperimental-design.html#randomisering-og-replikation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Man laver et <strong>eksperiment</strong> for at få svar på et bestemt spørgsmål eller en hypotese. Eksperimentet designes ud fra principper, der gør det muligt at fortolke resultaterne fra analysen af datasættet efterfølgende. For at et eksperiment skal være gyldigt, skal det kunne demonstrere hensigtsmæssig <strong>replikation</strong> og <strong>randomisering</strong>.</p>
<p><strong>Randomisering</strong></p>
<p>Målet er at udelukke, at konklusionerne simpelthen kan skyldes varians som følge af en faktor, der ikke direkte er interessant i eksperimentet. Derfor bruger man randomisering til at fordele disse faktorer over de forskellige behandlingsgrupper. Et eksempel kan være ‘double-blinding’ i kliniske eksperimenter - både lægen og patienten har ikke kendskab til, hvem der hører til de forskellige grupper, således at forskelsbehandling indenfor grupperne, som kan påvirke de endelige resultater, undgås.</p>
<p><strong>Replikation</strong></p>
<p>Dette sker, når man gentager et eksperiment flere gange - for eksempel ved at have flere patienter i hver behandlingsgruppe. Dette tillader os at beregne variabiliteten i data, som er nødvendig for at kunne konkludere om, der er en forskel mellem grupperne. Man kan altså ikke generalisere resultater, som kun er målt på én person.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-616"></span>
<img src="plots/randomisation.png" alt="randomisation og replikation" width="100%" />
<p class="caption">
Figure 11.1: randomisation og replikation
</p>
</div>
<p>I ovenstående figur er der 6 replikationer i hver gruppe, der enten er “behandling” eller “kontrol”. I tilfældet “God randomisering” er objekter, som er taget tilfældigt fra populationen, godt matchet mellem de to grupper. I det andet tilfælde, “Dårlig randomisering”, kan man se, at objekternes farver er godt matchet inden for de samme grupper. Dette gør det derfor umuligt at afgøre, om en eventuel forskel mellem “behandling” og “kontrol” i virkeligheden er resultatet af farven frem for de målinger, man gerne vil sammenligne.</p>
<p><strong>Forvekslingsvariabler</strong></p>
<p>Figuren nedenfor illustrerer alder som en forvekslingsvariabel i et eksperiment, hvor man prøver at forstå sammenhængen mellem aktivitetsniveau og vægtøgning. Det kan se ud som om, at et lavt aktivitetsniveau (afhængig variabel) forklarer vægtøgning (uafhængig variabel), men man er nødt til at tage andre variable i betragtning for at sikre, at sammenhængen ikke skyldes noget andet. For eksempel kunne gruppen med det høje aktivitetsniveau bestå af personer, der er yngre end personerne i gruppen med det lave aktivitetsniveau, og deres alder kan påvirke deres vægtøgning (måske på grund af forskelle i stressniveauer, kost osv.).</p>
<p><img src="plots/confounding_illus.png" width="60%" /></p>
<p><strong>Blokering</strong></p>
<p>Man kan forsøge at kontrollere for ekstra variable, som vi ikke er interesseret i, gennem “blokering”. Blokering udføres ved først at identificere grupper af individer, der ligner hinanden så meget som muligt. Det kan for eksempel være, at tre forskellige forskere har medvirket til at udføre et stort eksperiment med mange patienter og forskellige behandlingsgrupper. Vi er interesseret i, om der er forskelle mellem behandlingsgrupperne, men ikke i, om der er en forskel i forskernes behandling af patienterne. Derfor vil vi gerne ‘blokere’ efter forsker - altså kontrollere for dem som en “batch” effekt. Man kan også blokere efter fx køn, for at sikre at forskellene i behandlingsgrupperne ikke skyldes forskelle mellem mænd og kvinder. Blokering udføres som en del af en lineær model, efter data er indsamlet, men det er nyttigt at tænke over det fra starten.</p>
</div>
<div id="eksempel-med-datasættet-toothgrowth" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Eksempel med datasættet <code>ToothGrowth</code><a href="emner-fra-eksperimental-design.html#eksempel-med-datasættet-toothgrowth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Et godt eksempel på et veludført eksperimentelt design er datasættet <code>ToothGrowth</code>, som er baseret på marsvin - de fik forskellige kosttilskud og doser, og derefter blev længden af deres tænder målt.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="emner-fra-eksperimental-design.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)</span>
<span id="cb598-2"><a href="emner-fra-eksperimental-design.html#cb598-2" aria-hidden="true" tabindex="-1"></a>ToothGrowth <span class="ot">&lt;-</span> ToothGrowth <span class="sc">%&gt;%</span> <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="fu">as.factor</span>(dose))</span>
<span id="cb598-3"><a href="emner-fra-eksperimental-design.html#cb598-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ToothGrowth)</span></code></pre></div>
<pre><code>##       len        supp     dose   
##  Min.   : 4.20   OJ:30   0.5:20  
##  1st Qu.:13.07   VC:30   1  :20  
##  Median :19.25           2  :20  
##  Mean   :18.81                   
##  3rd Qu.:25.27                   
##  Max.   :33.90</code></pre>
<p>Her kan man se, at for hver gruppe (efter <code>supp</code> og <code>dose</code>) er der 10 marsvin - vi har således replikationer over grupperne, og hver <code>supp</code> (supplement) har hver af de tre mulige værdier for “dose”. Hvis vi for eksempel ikke var interesseret i <code>supp</code> men kun i dosis, kunne vi ‘blokere’ efter <code>supp</code> for at afbøde forskelle i effekten af de to supplementer i <code>supp</code>.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="emner-fra-eksperimental-design.html#cb600-1" aria-hidden="true" tabindex="-1"></a>ToothGrowth <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(supp,dose) <span class="sc">%&gt;%</span> </span>
<span id="cb600-2"><a href="emner-fra-eksperimental-design.html#cb600-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(dose),<span class="at">y=</span>n,<span class="at">fill=</span><span class="fu">factor</span>(dose))) <span class="sc">+</span> </span>
<span id="cb600-3"><a href="emner-fra-eksperimental-design.html#cb600-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb600-4"><a href="emner-fra-eksperimental-design.html#cb600-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Antal marsvin&quot;</span>) <span class="sc">+</span> </span>
<span id="cb600-5"><a href="emner-fra-eksperimental-design.html#cb600-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Dosering&quot;</span>) <span class="sc">+</span></span>
<span id="cb600-6"><a href="emner-fra-eksperimental-design.html#cb600-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>supp) <span class="sc">+</span></span>
<span id="cb600-7"><a href="emner-fra-eksperimental-design.html#cb600-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-619-1.png" width="432" /></p>
<p>Man skal dog være opmærksom, fordi vi ved ikke, hvordan marsvinene blev tildelt til de forskellige grupper. For eksempel, hvis hanner og hunner ikke er tildelt tilfældigt, kan det forekomme, at supp “OJ” og dosis “0.5” kun har hanmarsvin, og supp “OJ” med dosis “1.0” kun har hunmarsvin. I sådanne tilfælde kunne vi ikke afgøre, om forskellen i dosis “0.5” versus “1.0” er resultatet af dosis eller køn.</p>
</div>
</div>
<div id="case-studies-simpsons-paradoks" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Case studies: Simpsons paradoks<a href="emner-fra-eksperimental-design.html#case-studies-simpsons-paradoks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(Se også videoressourcer Del 2).</p>
<p>Simpsons paradoks er et fascinerende statistisk fænomen, der er en vigtig påmindelse om, at korrelation ikke nødvendigvis indebærer kausalitet, og at det er afgørende at forstå de underliggende data og ikke kun de aggregerede statistikker. Simpsons paradoks opstår, når man drager to modsatte konklusioner fra det samme datasæt - på den ene side, når man kigger på dataene samlet, og på den anden side, når man tager visse grupper i betragtning. Vi kan visualisere Simpsons paradoks gennem eksemplet nedenfor - her har vi to variable <code>x</code> og <code>y</code>, som vi kan bruge til at lave et scatterplot, samt nogle forskellige grupper inden for variablen <code>group</code>.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="emner-fra-eksperimental-design.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(datasauRus)</span></span>
<span id="cb601-2"><a href="emner-fra-eksperimental-design.html#cb601-2" aria-hidden="true" tabindex="-1"></a>simpsons_paradox <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/ysh3qpc7qv0ceut/simpsons_paradox_groups.txt?dl=1&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb601-3"><a href="emner-fra-eksperimental-design.html#cb601-3" aria-hidden="true" tabindex="-1"></a>simpsons_paradox <span class="ot">&lt;-</span> simpsons_paradox <span class="sc">%&gt;%</span> <span class="fu">tibble</span>()</span>
<span id="cb601-4"><a href="emner-fra-eksperimental-design.html#cb601-4" aria-hidden="true" tabindex="-1"></a>simpsons_paradox</span></code></pre></div>
<pre><code>FALSE # A tibble: 222 × 3
FALSE        x     y group
FALSE    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
FALSE  1  62.2 70.6  D    
FALSE  2  52.3 14.7  B    
FALSE  3  56.4 46.4  C    
FALSE  4  66.8 66.2  D    
FALSE  5  66.5 89.2  E    
FALSE  6  62.4 91.5  E    
FALSE  7  38.9  6.76 A    
FALSE  8  39.4 63.1  C    
FALSE  9  60.9 92.6  E    
FALSE 10  56.6 45.8  C    
FALSE # ℹ 212 more rows</code></pre>
<p>Hvis vi ignorerer <code>group</code> og kigger på dataene samlet, kan vi se, at der er en stærk positiv sammenhæng mellem x og y. Men når vi opdeler efter de forskellige grupper ved at skrive <code>colour = group</code>, opnår vi faktisk en negativ sammenhæng indenfor hver af grupperne.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="emner-fra-eksperimental-design.html#cb603-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> simpsons_paradox <span class="sc">%&gt;%</span> </span>
<span id="cb603-2"><a href="emner-fra-eksperimental-design.html#cb603-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb603-3"><a href="emner-fra-eksperimental-design.html#cb603-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb603-4"><a href="emner-fra-eksperimental-design.html#cb603-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb603-5"><a href="emner-fra-eksperimental-design.html#cb603-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb603-6"><a href="emner-fra-eksperimental-design.html#cb603-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-7"><a href="emner-fra-eksperimental-design.html#cb603-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> simpsons_paradox <span class="sc">%&gt;%</span> </span>
<span id="cb603-8"><a href="emner-fra-eksperimental-design.html#cb603-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y,<span class="at">colour=</span>group)) <span class="sc">+</span> </span>
<span id="cb603-9"><a href="emner-fra-eksperimental-design.html#cb603-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb603-10"><a href="emner-fra-eksperimental-design.html#cb603-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="fu">aes</span>(<span class="at">group=</span>group),<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb603-11"><a href="emner-fra-eksperimental-design.html#cb603-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb603-12"><a href="emner-fra-eksperimental-design.html#cb603-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-13"><a href="emner-fra-eksperimental-design.html#cb603-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb603-14"><a href="emner-fra-eksperimental-design.html#cb603-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-621-1.png" width="864" /></p>
<p>Simpsons paradoks forekommer oftere end man skulle tro, og derfor er det vigtigt at overveje, hvilke andre variable man også er nødt til at tage i betragtning.</p>
<div id="optagelse-på-berkeley" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Optagelse på Berkeley<a href="emner-fra-eksperimental-design.html#optagelse-på-berkeley" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Det mest berømte eksempel på Simpsons paradoks drejer sig om optagelsen på Berkeley Universitetet i 1973. Følgende tabel fra Wikipedia (<a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox" class="uri">https://en.wikipedia.org/wiki/Simpson%27s_paradox</a>) viser statistikker over antallet af ansøgere samt procentdelen, der blev optaget på universitetet generelt, opdelt efter køn.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-622"></span>
<img src="plots/admissions.png" alt="source: wikipedia" width="85%" />
<p class="caption">
Figure 11.2: source: wikipedia
</p>
</div>
<p>Hvis vi laver et søjlediagram af tallene, kan man se, at der er en højere procentdel af mænd end kvinder, som blev optaget på universitetet (sagen medførte en retssag mod universitetet).</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="emner-fra-eksperimental-design.html#cb604-1" aria-hidden="true" tabindex="-1"></a>admissions_all <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;sex&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;men&quot;</span>,<span class="st">&quot;women&quot;</span>),<span class="at">admitted=</span><span class="fu">c</span>(<span class="st">&quot;41&quot;</span>,<span class="st">&quot;44&quot;</span>,<span class="st">&quot;35&quot;</span>))</span>
<span id="cb604-2"><a href="emner-fra-eksperimental-design.html#cb604-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-3"><a href="emner-fra-eksperimental-design.html#cb604-3" aria-hidden="true" tabindex="-1"></a>admissions_all <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sex,<span class="at">y=</span>admitted,<span class="at">fill=</span>sex)) <span class="sc">+</span> </span>
<span id="cb604-4"><a href="emner-fra-eksperimental-design.html#cb604-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb604-5"><a href="emner-fra-eksperimental-design.html#cb604-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb604-6"><a href="emner-fra-eksperimental-design.html#cb604-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Procent optaget&quot;</span>) <span class="sc">+</span></span>
<span id="cb604-7"><a href="emner-fra-eksperimental-design.html#cb604-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;women&quot;</span>,<span class="st">&quot;men&quot;</span>,<span class="st">&quot;all&quot;</span>)) <span class="sc">+</span></span>
<span id="cb604-8"><a href="emner-fra-eksperimental-design.html#cb604-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-623-1.png" width="480" /></p>
<p>Da man dog kiggede lidt nærmere på de samme tal, men opdelte efter de forskellige fakulteter på universitetet, fik man et anderledes billede af situationen. I følgende tabel har vi optagelsestallene for mænd og kvinder på hver af de forskellige fakulteter (A til F).</p>
<!-- optagelses statistik efter afdeling -->
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="emner-fra-eksperimental-design.html#cb605-1" aria-hidden="true" tabindex="-1"></a>admissions_separate <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb605-2"><a href="emner-fra-eksperimental-design.html#cb605-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>department,   <span class="sc">~</span>all,   <span class="sc">~</span>men,  <span class="sc">~</span>women,</span>
<span id="cb605-3"><a href="emner-fra-eksperimental-design.html#cb605-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#------------|-------|-------|--------#</span></span>
<span id="cb605-4"><a href="emner-fra-eksperimental-design.html#cb605-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span>,            <span class="dv">64</span>,     <span class="dv">62</span>,      <span class="dv">82</span>,</span>
<span id="cb605-5"><a href="emner-fra-eksperimental-design.html#cb605-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;B&quot;</span>,            <span class="dv">63</span>,     <span class="dv">63</span>,      <span class="dv">68</span>,</span>
<span id="cb605-6"><a href="emner-fra-eksperimental-design.html#cb605-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span>,            <span class="dv">35</span>,     <span class="dv">37</span>,      <span class="dv">34</span>,</span>
<span id="cb605-7"><a href="emner-fra-eksperimental-design.html#cb605-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;D&quot;</span>,            <span class="dv">34</span>,     <span class="dv">33</span>,      <span class="dv">35</span>,</span>
<span id="cb605-8"><a href="emner-fra-eksperimental-design.html#cb605-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;E&quot;</span>,            <span class="dv">25</span>,     <span class="dv">28</span>,      <span class="dv">24</span>,</span>
<span id="cb605-9"><a href="emner-fra-eksperimental-design.html#cb605-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;F&quot;</span>,             <span class="dv">6</span>,      <span class="dv">6</span>,       <span class="dv">7</span></span>
<span id="cb605-10"><a href="emner-fra-eksperimental-design.html#cb605-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Man kan se, at for de fleste af fakulteterne er der ikke en markant forskel mellem mænd og kvinder, og i nogle tilfælde havde kvinder faktisk en større sandsynlighed for at blive optaget.</p>
<!-- lave et plot af de data opdelte efter afdeling -->
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="emner-fra-eksperimental-design.html#cb606-1" aria-hidden="true" tabindex="-1"></a>admissions_separate <span class="sc">%&gt;%</span> </span>
<span id="cb606-2"><a href="emner-fra-eksperimental-design.html#cb606-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>department,<span class="at">names_to=</span><span class="st">&quot;sex&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;admitted&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb606-3"><a href="emner-fra-eksperimental-design.html#cb606-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>department,<span class="at">y=</span>admitted,<span class="at">fill=</span>sex)) <span class="sc">+</span> </span>
<span id="cb606-4"><a href="emner-fra-eksperimental-design.html#cb606-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Procent optaget&quot;</span>) <span class="sc">+</span></span>
<span id="cb606-5"><a href="emner-fra-eksperimental-design.html#cb606-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb606-6"><a href="emner-fra-eksperimental-design.html#cb606-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-625-1.png" width="384" /></p>
<p>Hvad skyldes denne sammenhæng? Det viste sig, at kvinder havde en tendens til at ansøge indenfor de fakulteter, som var sværest at komme ind på. For eksempel kan man se her, at fakultet E har en relativt lav optagelsesprocent. Det samme fakultet var dog et af dem, hvor betydeligt flere kvinder ansøgte end mænd.</p>
<!-- lave et plot af ansøgelse statistik for afdeling E -->
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="emner-fra-eksperimental-design.html#cb607-1" aria-hidden="true" tabindex="-1"></a>applications_E <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;sex&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;men&quot;</span>,<span class="st">&quot;woman&quot;</span>),<span class="at">applications=</span><span class="fu">c</span>(<span class="st">&quot;584&quot;</span>,<span class="st">&quot;191&quot;</span>,<span class="st">&quot;393&quot;</span>))</span>
<span id="cb607-2"><a href="emner-fra-eksperimental-design.html#cb607-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-3"><a href="emner-fra-eksperimental-design.html#cb607-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-4"><a href="emner-fra-eksperimental-design.html#cb607-4" aria-hidden="true" tabindex="-1"></a>applications_E <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sex,<span class="at">y=</span>applications,<span class="at">fill=</span>sex)) <span class="sc">+</span> </span>
<span id="cb607-5"><a href="emner-fra-eksperimental-design.html#cb607-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb607-6"><a href="emner-fra-eksperimental-design.html#cb607-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb607-7"><a href="emner-fra-eksperimental-design.html#cb607-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of applications to dep. E&quot;</span>) <span class="sc">+</span></span>
<span id="cb607-8"><a href="emner-fra-eksperimental-design.html#cb607-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;woman&quot;</span>,<span class="st">&quot;men&quot;</span>,<span class="st">&quot;all&quot;</span>)) <span class="sc">+</span></span>
<span id="cb607-9"><a href="emner-fra-eksperimental-design.html#cb607-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-626-1.png" width="480" /></p>
<p>Derfor, selvom kvinder ikke havde en lavere sandsynlighed for at blive optaget end mænd i deres fortrukne fag, var antallet af kvinder, der blev optaget i det hele taget på tværs af alle afdelinger, faktisk lavere end antallet af mænd.</p>
</div>
</div>
<div id="case-studies-anscombes-kvartet" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Case studies: Anscombes kvartet<a href="emner-fra-eksperimental-design.html#case-studies-anscombes-kvartet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(Se også videoressourcer Del 3).</p>
<p>Anscombes kvartet (se også <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" class="uri">https://en.wikipedia.org/wiki/Anscombe%27s_quartet</a>) er et meget nyttigt og berømt eksempel fra 1973, der fremhæver vigtigheden af at visualisere datasættet. Vi kan hente dataene fra linket nedenfor - der er x-værdier og y-værdier, som kan anvendes til at lave et scatterplot, og der er også <code>set</code>, der refererer til fire forskellige datasæt (derfor ‘kvartet’).</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="emner-fra-eksperimental-design.html#cb608-1" aria-hidden="true" tabindex="-1"></a>anscombe <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/mlt7crdik3eih9a/anscombe_long_format.txt?dl=1&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb608-2"><a href="emner-fra-eksperimental-design.html#cb608-2" aria-hidden="true" tabindex="-1"></a>anscombe <span class="ot">&lt;-</span> anscombe <span class="sc">%&gt;%</span> <span class="fu">tibble</span>()</span>
<span id="cb608-3"><a href="emner-fra-eksperimental-design.html#cb608-3" aria-hidden="true" tabindex="-1"></a>anscombe</span></code></pre></div>
<pre><code>## # A tibble: 44 × 3
##      set     x     y
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1     1    10  8.04
##  2     1     8  6.95
##  3     1    13  7.58
##  4     1     9  8.81
##  5     1    11  8.33
##  6     1    14  9.96
##  7     1     6  7.24
##  8     1     4  4.26
##  9     1    12 10.8 
## 10     1     7  4.82
## # ℹ 34 more rows</code></pre>
<p>Formålet med datasættet er, at vi gerne vil fitte en lineær regressionsmodel for at finde den forventede y-værdi afhængig af x (husk <code>lm(y ~ x)</code>). Da vi har fire datasæt, kan vi opdele datasættet efter <code>set</code> og anvende funktionerne <code>nest</code> og <code>map</code> (se Kapitel 7) til at fitte de fire lineære regressionsmodeller. Vi anvender også <code>tidy</code> og <code>glance</code> for at få resuméstatistikker fra de fire modeller:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="emner-fra-eksperimental-design.html#cb610-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> .x)</span>
<span id="cb610-2"><a href="emner-fra-eksperimental-design.html#cb610-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-3"><a href="emner-fra-eksperimental-design.html#cb610-3" aria-hidden="true" tabindex="-1"></a>tidy_anscombe_models <span class="ot">&lt;-</span> anscombe <span class="sc">%&gt;%</span> </span>
<span id="cb610-4"><a href="emner-fra-eksperimental-design.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_nest</span>(set) <span class="sc">%&gt;%</span> </span>
<span id="cb610-5"><a href="emner-fra-eksperimental-design.html#cb610-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, my_func),</span>
<span id="cb610-6"><a href="emner-fra-eksperimental-design.html#cb610-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidy =</span> <span class="fu">map</span>(fit, tidy),</span>
<span id="cb610-7"><a href="emner-fra-eksperimental-design.html#cb610-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">glance =</span> <span class="fu">map</span>(fit, glance))</span></code></pre></div>
<p>Vi kan anvende <code>unnest</code> på outputtet fra <code>tidy</code> og se på skæringspunktet og hældningen af de fire modeller. Man kan se, at de to parametre er næsten identiske for de fire modeller:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="emner-fra-eksperimental-design.html#cb611-1" aria-hidden="true" tabindex="-1"></a>tidy_anscombe_models <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(<span class="st">&quot;tidy&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb611-2"><a href="emner-fra-eksperimental-design.html#cb611-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;set&quot;</span>,<span class="at">names_from =</span> <span class="st">&quot;term&quot;</span>,<span class="at">values_from=</span><span class="st">&quot;estimate&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##     set `(Intercept)`     x
##   &lt;int&gt;         &lt;dbl&gt; &lt;dbl&gt;
## 1     1          3.00 0.500
## 2     2          3.00 0.5  
## 3     3          3.00 0.500
## 4     4          3.00 0.500</code></pre>
<p>Hvad med de andre parametre fra modellen - lad os eksempelvis kigge på <code>r.squared</code> og <code>p.value</code> fra modellerne, som kan findes i outputtet fra <code>glance</code>. Her kan vi igen se, at de er næsten identiske.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="emner-fra-eksperimental-design.html#cb613-1" aria-hidden="true" tabindex="-1"></a>tidy_anscombe_models <span class="sc">%&gt;%</span> </span>
<span id="cb613-2"><a href="emner-fra-eksperimental-design.html#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb613-3"><a href="emner-fra-eksperimental-design.html#cb613-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(set, r.squared,p.value)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##     set r.squared p.value
##   &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1     1     0.667 0.00217
## 2     2     0.666 0.00218
## 3     3     0.666 0.00218
## 4     4     0.667 0.00216</code></pre>
<p>Hvad med korrelation? Den er også næsten den samme:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="emner-fra-eksperimental-design.html#cb615-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">cor</span>(.x<span class="sc">$</span>x,.x<span class="sc">$</span>y)</span>
<span id="cb615-2"><a href="emner-fra-eksperimental-design.html#cb615-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-3"><a href="emner-fra-eksperimental-design.html#cb615-3" aria-hidden="true" tabindex="-1"></a>anscombe <span class="sc">%&gt;%</span> </span>
<span id="cb615-4"><a href="emner-fra-eksperimental-design.html#cb615-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_nest</span>(set) <span class="sc">%&gt;%</span> </span>
<span id="cb615-5"><a href="emner-fra-eksperimental-design.html#cb615-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cor =</span> <span class="fu">map</span>(data, my_func)) <span class="sc">%&gt;%</span> </span>
<span id="cb615-6"><a href="emner-fra-eksperimental-design.html#cb615-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(cor) <span class="sc">%&gt;%</span> </span>
<span id="cb615-7"><a href="emner-fra-eksperimental-design.html#cb615-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##     set   cor
##   &lt;int&gt; &lt;dbl&gt;
## 1     1 0.816
## 2     2 0.816
## 3     3 0.816
## 4     4 0.817</code></pre>
<p>Kan vi så konkludere, at de fire datasæt, som underbygger de forskellige modeller, er identiske? Lad os lave et scatter plot af de fire datasæt (som vi faktisk burde have gjort i starten af vores analyse).</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="emner-fra-eksperimental-design.html#cb617-1" aria-hidden="true" tabindex="-1"></a>anscombe <span class="sc">%&gt;%</span> </span>
<span id="cb617-2"><a href="emner-fra-eksperimental-design.html#cb617-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,<span class="at">colour=</span><span class="fu">factor</span>(set))) <span class="sc">+</span></span>
<span id="cb617-3"><a href="emner-fra-eksperimental-design.html#cb617-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb617-4"><a href="emner-fra-eksperimental-design.html#cb617-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>set) <span class="sc">+</span></span>
<span id="cb617-5"><a href="emner-fra-eksperimental-design.html#cb617-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb617-6"><a href="emner-fra-eksperimental-design.html#cb617-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-632-1.png" width="768" /></p>
<p>De fire datasæt er meget forskellige. Vi ved, at de alle har samme bedste tilpasning med rette linjer, men de underliggende data er slet ikke de samme. Det første datasæt ser egnet ud til en lineær regressionsanalyse, men vi kan se i datasæt nummer to, at der ikke engang er en lineær sammenhæng. Og de andre to har outlier værdier, hvilket gør, at den bedst tilpassede rette linje ikke passer særlig godt til punkterne.</p>
</div>
<div id="undersøgelse-af-batch-effekter" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Undersøgelse af “batch-effekter”<a href="emner-fra-eksperimental-design.html#undersøgelse-af-batch-effekter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(Se også videoressourcer Part 4).</p>
<p>En “batch-effekt” er en systematisk teknisk bias, der opstår, når målinger (f.eks. genekspression) udføres i flere omgange eller “batches”. Dette kan potentielt føre til betydelige forvrængninger og fejlagtige konklusioner i dataanalyse, hvis det ikke tages højde for.</p>
<p>Forestil dig, at du udfører et eksperiment, hvor du sammenligner genekspressionen i sundt væv med kræftvæv. Du udfører dine eksperimenter over flere dage, og det viser sig, at alle dine sunde prøver blev behandlet på mandag, og alle dine kræftprøver blev behandlet på tirsdag. Hvis der er en systematisk forskel i, hvordan dine eksperimenter blev udført på de to dage (måske et reagens var lidt anderledes, eller instrumentet blev brugt på en anden måde), vil du se en stor forskel i genekspression mellem dine sunde og kræftprøver. Men denne forskel skyldes faktisk batch-effekten, ikke forskellen mellem sundt og kræftvæv.</p>
<p>Man kan også anvende visualiseringer til at undersøge eventuelle batch-effekter eller forvirrende variabler i datasættet. Dette er især vigtigt i store eksperimenter, hvor forskellige prøver eller dele af datasættet bliver indsamlet på forskellige tidspunkter, steder, eller af forskellige personer. Det er ofte tilfældet i sekvenseringsbaserede datasæt, at man ser batch-effekter, og det kan skyldes mange ting, bl.a.:</p>
<ul>
<li>Sekvenseringsdybde</li>
<li>Grupper af prøver lavet på forskellige tidspunkter af forskellige individer</li>
<li>Sekvenseringsmaskiner - prøver sekvenseret på forskellige maskiner eller ‘lanes’.</li>
</ul>
<p>Lad os tage udgangspunkt i nogle genekspressionssekvenseringsdata fra mus (vi så også dette datasæt, da vi lærte om <code>pivot_longer</code> kombineret med <code>left_join</code>).</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="emner-fra-eksperimental-design.html#cb618-1" aria-hidden="true" tabindex="-1"></a>norm.cts <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/3vhwnsnhzsy35nd/bottomly_count_table_normalised.txt?dl=1&quot;</span>)</span>
<span id="cb618-2"><a href="emner-fra-eksperimental-design.html#cb618-2" aria-hidden="true" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/el3sm9ncvzbq6xf/bottomly_phenodata.txt?dl=1&quot;</span>)</span>
<span id="cb618-3"><a href="emner-fra-eksperimental-design.html#cb618-3" aria-hidden="true" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> coldata <span class="sc">%&gt;%</span> <span class="fu">tibble</span>()</span>
<span id="cb618-4"><a href="emner-fra-eksperimental-design.html#cb618-4" aria-hidden="true" tabindex="-1"></a>norm.cts <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm.cts,<span class="at">rownames=</span><span class="st">&quot;gene&quot;</span>)</span></code></pre></div>
<p>Jeg begynder med at vælge kun de rækker, der har mindst 50 counts, for at undgå gener med lave ekspressionsniveauer. Det næste jeg gør er at transformere dataene til logaritmisk form (funktion <code>map_if()</code>) for at opnå en bedre fordeling i datasættet.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="emner-fra-eksperimental-design.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co">#normalisere og filtrere dataene</span></span>
<span id="cb619-2"><a href="emner-fra-eksperimental-design.html#cb619-2" aria-hidden="true" tabindex="-1"></a>norm.cts <span class="ot">&lt;-</span> norm.cts <span class="sc">%&gt;%</span> </span>
<span id="cb619-3"><a href="emner-fra-eksperimental-design.html#cb619-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rowSums</span>(norm.cts <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>gene))<span class="sc">&gt;</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb619-4"><a href="emner-fra-eksperimental-design.html#cb619-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_if</span>(is.numeric,<span class="sc">~</span><span class="fu">log</span>(.x<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb619-5"><a href="emner-fra-eksperimental-design.html#cb619-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-6"><a href="emner-fra-eksperimental-design.html#cb619-6" aria-hidden="true" tabindex="-1"></a>norm.cts</span></code></pre></div>
<pre><code>## # A tibble: 10,193 × 22
##    gene    SRX033480 SRX033488 SRX033481 SRX033489 SRX033482 SRX033490 SRX033483
##    &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 ENSMUS…      6.35      6.32      6.21      6.29      6.31      6.27      6.30
##  2 ENSMUS…      3.51      3.56      3.57      3.27      2.99      3.61      3.56
##  3 ENSMUS…      3.19      3.50      3.08      3.21      3.14      3.09      3.22
##  4 ENSMUS…      6.69      6.48      6.38      6.35      6.39      6.34      6.50
##  5 ENSMUS…      6.05      6.37      6.17      6.26      6.16      6.06      6.13
##  6 ENSMUS…      2.89      2.94      3.16      3.21      3.77      3.30      3.11
##  7 ENSMUS…      3.42      3.12      3.86      4.36      3.77      3.99      4.24
##  8 ENSMUS…      3.42      2.94      3.52      3.41      3.57      3.60      2.99
##  9 ENSMUS…      5.02      4.98      4.49      4.27      4.67      4.35      4.81
## 10 ENSMUS…      5.13      4.88      4.97      4.76      4.82      4.79      4.96
## # ℹ 10,183 more rows
## # ℹ 14 more variables: SRX033476 &lt;dbl&gt;, SRX033478 &lt;dbl&gt;, SRX033479 &lt;dbl&gt;,
## #   SRX033472 &lt;dbl&gt;, SRX033473 &lt;dbl&gt;, SRX033474 &lt;dbl&gt;, SRX033475 &lt;dbl&gt;,
## #   SRX033491 &lt;dbl&gt;, SRX033484 &lt;dbl&gt;, SRX033492 &lt;dbl&gt;, SRX033485 &lt;dbl&gt;,
## #   SRX033493 &lt;dbl&gt;, SRX033486 &lt;dbl&gt;, SRX033494 &lt;dbl&gt;</code></pre>
<p>Så der er omkring 10.000 gener i rækkerne, og der er 21 forskellige prøver, der spreder sig over kolonnerne. Vi har også nogle prøveoplysninger - der er to forskellige stammer af mus og også forskellige batches, som vi gerne vil undersøge nærmere.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="emner-fra-eksperimental-design.html#cb621-1" aria-hidden="true" tabindex="-1"></a>coldata</span></code></pre></div>
<pre><code>## # A tibble: 21 × 5
##    column    num.tech.reps strain   batch lane.number
##    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;    &lt;int&gt;       &lt;int&gt;
##  1 SRX033480             1 C57BL.6J     6           1
##  2 SRX033488             1 C57BL.6J     7           1
##  3 SRX033481             1 C57BL.6J     6           2
##  4 SRX033489             1 C57BL.6J     7           2
##  5 SRX033482             1 C57BL.6J     6           3
##  6 SRX033490             1 C57BL.6J     7           3
##  7 SRX033483             1 C57BL.6J     6           5
##  8 SRX033476             1 C57BL.6J     4           6
##  9 SRX033478             1 C57BL.6J     4           7
## 10 SRX033479             1 C57BL.6J     4           8
## # ℹ 11 more rows</code></pre>
<p>Vi kan se på, hvor mange prøver vi har for hver kombination af stamme og batch i datasættet:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="emner-fra-eksperimental-design.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(coldata<span class="sc">$</span>strain, coldata<span class="sc">$</span>batch)</span></code></pre></div>
<pre><code>##           
##            4 6 7
##   C57BL.6J 3 4 3
##   DBA.2J   4 3 4</code></pre>
<p>Så man kan se, at både stammen er repræsenteret med tre eller fire prøver i hver af de tre batches. Der er derfor <em>replikation</em>, og da vi har fået repræsenteret hver kombination af stamme og batch, kan vi eventuelt <strong>blokere</strong> efter batch for at fjerne dens effekt. Her har vi ikke tid til at se på metoder til at fjerne batch-effekter, men det er vigtigt, at vi er i stand til at opdage dem.</p>
<div id="principal-component-analyse" class="section level3 hasAnchor" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Principal component analyse<a href="emner-fra-eksperimental-design.html#principal-component-analyse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Man kan undersøge mulige batch-effekter via principal component analyse.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="emner-fra-eksperimental-design.html#cb625-1" aria-hidden="true" tabindex="-1"></a>pca_fit <span class="ot">&lt;-</span> norm.cts <span class="sc">%&gt;%</span></span>
<span id="cb625-2"><a href="emner-fra-eksperimental-design.html#cb625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="co"># behold kun numeriske kolonner</span></span>
<span id="cb625-3"><a href="emner-fra-eksperimental-design.html#cb625-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prcomp</span>(<span class="at">scale =</span> <span class="cn">TRUE</span>) <span class="co"># udfør PCA på skalerede data</span></span></code></pre></div>
<p>Husk, at når man udfører en principal component analyse, får man rotationsmatricen, der anvendes til at se, hvor de forskellige prøver ligger i forhold til hinanden over de forskellige principal komponenter - dvs. at prøver, der ligner hinanden, vises på samme sted på plottet. Rotationsmatricen udtrækkes med funktionen <code>tidy()</code>:</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="emner-fra-eksperimental-design.html#cb626-1" aria-hidden="true" tabindex="-1"></a>rot_matrix <span class="ot">&lt;-</span> pca_fit <span class="sc">%&gt;%</span></span>
<span id="cb626-2"><a href="emner-fra-eksperimental-design.html#cb626-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">&quot;rotation&quot;</span>) </span></code></pre></div>
<p>Vi vil gerne lave et plot af rotationsmatricen, men først vil vi gerne tilføje prøveoplysningerne med <code>left_join</code>, så vi kan se de forskellige batches eller stammer. Begge dataframes har en kolonne, der hedder <code>column</code>, som refererer til prøvenavne, så jeg forbinder efter <code>column</code> her.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="emner-fra-eksperimental-design.html#cb627-1" aria-hidden="true" tabindex="-1"></a>rot_matrix <span class="ot">&lt;-</span> rot_matrix  <span class="sc">%&gt;%</span> </span>
<span id="cb627-2"><a href="emner-fra-eksperimental-design.html#cb627-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coldata,<span class="at">by=</span><span class="st">&quot;column&quot;</span>)</span></code></pre></div>
<p>Brug <code>pivot_wider()</code> til at få det i bred format, så vi kan plotte “PC1” og “PC2” i et scatter plot:</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="emner-fra-eksperimental-design.html#cb628-1" aria-hidden="true" tabindex="-1"></a>rot_matrix_wide <span class="ot">&lt;-</span> rot_matrix <span class="sc">%&gt;%</span> </span>
<span id="cb628-2"><a href="emner-fra-eksperimental-design.html#cb628-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;PC&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;PC&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb628-3"><a href="emner-fra-eksperimental-design.html#cb628-3" aria-hidden="true" tabindex="-1"></a>rot_matrix_wide</span></code></pre></div>
<pre><code>## # A tibble: 21 × 26
##    column num.tech.reps strain batch lane.number    PC1      PC2     PC3     PC4
##    &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;  &lt;int&gt;       &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 SRX03…             1 C57BL…     6           1 -0.217  0.262   0.0200  -0.508 
##  2 SRX03…             1 C57BL…     7           1 -0.219  0.243   0.00586  0.166 
##  3 SRX03…             1 C57BL…     6           2 -0.217  0.303   0.0153  -0.237 
##  4 SRX03…             1 C57BL…     7           2 -0.219  0.246   0.00799  0.178 
##  5 SRX03…             1 C57BL…     6           3 -0.217  0.259   0.0974  -0.113 
##  6 SRX03…             1 C57BL…     7           3 -0.219  0.234   0.00385  0.209 
##  7 SRX03…             1 C57BL…     6           5 -0.218  0.237   0.0303  -0.179 
##  8 SRX03…             1 C57BL…     4           6 -0.217  0.00524 0.463    0.376 
##  9 SRX03…             1 C57BL…     4           7 -0.218  0.0901  0.305    0.0651
## 10 SRX03…             1 C57BL…     4           8 -0.218 -0.110   0.434   -0.161 
## # ℹ 11 more rows
## # ℹ 17 more variables: PC5 &lt;dbl&gt;, PC6 &lt;dbl&gt;, PC7 &lt;dbl&gt;, PC8 &lt;dbl&gt;, PC9 &lt;dbl&gt;,
## #   PC10 &lt;dbl&gt;, PC11 &lt;dbl&gt;, PC12 &lt;dbl&gt;, PC13 &lt;dbl&gt;, PC14 &lt;dbl&gt;, PC15 &lt;dbl&gt;,
## #   PC16 &lt;dbl&gt;, PC17 &lt;dbl&gt;, PC18 &lt;dbl&gt;, PC19 &lt;dbl&gt;, PC20 &lt;dbl&gt;, PC21 &lt;dbl&gt;</code></pre>
<p>Jeg tildeler farver og former efter de tre batches. Man kan se, at jeg har fået alle prøver fra batch nummer 2 på samme sted i plottet.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="emner-fra-eksperimental-design.html#cb630-1" aria-hidden="true" tabindex="-1"></a>rot_matrix_wide <span class="sc">%&gt;%</span></span>
<span id="cb630-2"><a href="emner-fra-eksperimental-design.html#cb630-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1,PC2,<span class="at">shape=</span><span class="fu">factor</span>(batch),<span class="at">colour=</span><span class="fu">factor</span>(batch))) <span class="sc">+</span> </span>
<span id="cb630-3"><a href="emner-fra-eksperimental-design.html#cb630-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb630-4"><a href="emner-fra-eksperimental-design.html#cb630-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-641-1.png" width="576" /></p>
<p>Jeg kan også tildele farver efter stamme, hvor man kan se, at der sandsynligvis er en forskel mellem de to stammer her.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="emner-fra-eksperimental-design.html#cb631-1" aria-hidden="true" tabindex="-1"></a>rot_matrix_wide <span class="sc">%&gt;%</span></span>
<span id="cb631-2"><a href="emner-fra-eksperimental-design.html#cb631-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1,PC2,<span class="at">shape=</span><span class="fu">factor</span>(strain),<span class="at">colour=</span><span class="fu">factor</span>(strain))) <span class="sc">+</span> </span>
<span id="cb631-3"><a href="emner-fra-eksperimental-design.html#cb631-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb631-4"><a href="emner-fra-eksperimental-design.html#cb631-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-642-1.png" width="576" /></p>
<p>Man kan også se på dataene på en anden måde ved at lave boksdiagrammer for de to første principale komponenter, opdelt efter batch. Vi får bekræftet vores observation om, at der er en markant forskel mellem batch 7 og de andre to batches langs den første principale komponent, og det er et problem, som muligvis skal korrigeres, før man foretager yderligere analyser af dataene.</p>
<!-- lave boxplot af PC1 og PC2 opdelt efter batch-->
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="emner-fra-eksperimental-design.html#cb632-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> rot_matrix_wide <span class="sc">%&gt;%</span> </span>
<span id="cb632-2"><a href="emner-fra-eksperimental-design.html#cb632-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(batch),<span class="at">y=</span>PC1,<span class="at">fill=</span><span class="fu">factor</span>(batch))) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb632-3"><a href="emner-fra-eksperimental-design.html#cb632-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-4"><a href="emner-fra-eksperimental-design.html#cb632-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> rot_matrix_wide <span class="sc">%&gt;%</span> </span>
<span id="cb632-5"><a href="emner-fra-eksperimental-design.html#cb632-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(batch),<span class="at">y=</span>PC2,<span class="at">fill=</span><span class="fu">factor</span>(batch))) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb632-6"><a href="emner-fra-eksperimental-design.html#cb632-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-7"><a href="emner-fra-eksperimental-design.html#cb632-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb632-8"><a href="emner-fra-eksperimental-design.html#cb632-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-643-1.png" width="480" /></p>
<!-- ### Ekstra: Pheatmap tilgang! -->
<!-- Det er også meget almindeligt at se "heatmaps" indenfor biologi fag. I en heatmap kan man visualisere korrelationerne i ekspressionen mellem de forskellige samples. Samples som har tætteste sammenhænge fremstå ved siden af hinanden på heatmappen ( ligesom i en dendrogram i hierarchical clustering, men med korrelation i stedet for afstand). -->
<!-- I følgende beregner jeg korrelationkoffeficient mellem de forskellige variabler: -->
<!-- ```{r} -->
<!-- norm.cts.cor <- norm.cts %>% select(-gene) %>% cor() -->
<!-- ``` -->
<!-- I følgende laver jeg en heatmap med funktionen `pheatmap` som findes i pakken `pheatmap`.  -->
<!-- ```{r,fig.width=6,fig.height=5} -->
<!-- library(pheatmap) #installer pakken hvis nødvendigt -->
<!-- pheatmap(norm.cts.cor) -->
<!-- ``` -->
<!-- Samme samples stå på både rækkerne og kolonnerne, og farverne representere hvor stærk korrelationen er mellem hver par samples. Hver sample har en korrelationskoefficient af 1 med sig selv, så man får en rød farve langt diagonelen, som betyder perfekt korrelation. Men det er svært at se, om der er en effekt pga. de forskellige batches. Hvordan kan vi gøre heatmappen mere informativ? -->
<!-- I følgende anvender jeg unite til at lave mere informativ navne i variablen "info_name": -->
<!-- ```{r} -->
<!-- info_new_names <- coldata %>%  -->
<!--   unite(strain,batch,lane.number,col = "info_name",remove = F) -->
<!-- info_new_names -->
<!-- ``` -->
<!-- Jeg ændrer navnerne på kolonnerne og rækkerne i min korrelation matrix og laver en ny heatmap: -->
<!-- ```{r,fig.width=6,fig.height=5} -->
<!-- colnames(norm.cts.cor) <- info_new_names %>% pull(info_name) -->
<!-- row.names(norm.cts.cor) <-  info_new_names %>% pull(info_name) -->
<!-- pheatmap(norm.cts.cor) -->
<!-- ``` -->
<!-- Det er bedre - jeg tilføjer også nogle flere annotations til at gøre det mere informativ: -->
<!-- ```{r,fig.width=6.75,fig.height=5} -->
<!-- annotations <- info_new_names %>%  -->
<!--   select(batch,lane.number,strain) %>%  -->
<!--   mutate(batch = as.factor(batch),lane.number=as.factor(lane.number)) %>% as.data.frame() -->
<!-- row.names(annotations) <- info_new_names$info_name -->
<!-- pheatmap(norm.cts.cor,annotation_col = annotations) -->
<!-- ``` -->
</div>
</div>
<div id="problemstillinger-10" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Problemstillinger<a href="emner-fra-eksperimental-design.html#problemstillinger-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1</strong>) Quiz på Absalon - experimental</p>
<hr />
<p>Problem 2) Eksperimentelt design</p>
<p>Jeg udfører et eksperiment, hvor patienter modtager et af tre forskellige kosttilskud (Gruppe 1, 2 og 3). Der er 5 patienter i hver gruppe, og jeg ønsker at undersøge, om patienternes energiniveau i gennemsnit varierer mellem de tre grupper. Alderen på patienterne i hver af de tre grupper er:</p>
<p>Gruppe 1: 18, 23, 31, 25, 19</p>
<p>Gruppe 2: 24, 29, 35, 21, 30</p>
<p>Gruppe 3: 43, 52, 33, 39, 40</p>
<ol style="list-style-type: lower-alpha">
<li><p>Hvad er problemet med det eksperimentelle design her? Lav boxplots for at illustrere fordelingen af alderne for hver af de tre grupper (du skal starte med at lave en <strong>tibble</strong>, der indeholder dataene).</p></li>
<li><p>Hvis man finder en signifikant forskel mellem de tre kosttilskud, kan man så stole på resultaterne?</p></li>
<li><p>Hvilke andre variabler end alder kunne være årsag til en eventuel forskel mellem de tre kosttilskud, og som muligvis skulle tages i betragtning?</p></li>
<li><p>Hvad kan man gøre for at løse problemet med det ovenstående eksperimentelle design?</p></li>
</ol>
<hr />
<p><strong>Problem 3</strong>) <em>Simpsons paradoks</em> <strong>Genbesøg af Lung Cap-data</strong></p>
<p>Indlæs <code>LungCapData</code> og tilføj den kategoriske variabel <code>Age.Group</code>:</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="emner-fra-eksperimental-design.html#cb633-1" aria-hidden="true" tabindex="-1"></a>LungCapData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.dropbox.com/s/ke27fs5d37ks1hm/LungCapData.csv?dl=1&quot;</span>)</span>
<span id="cb633-2"><a href="emner-fra-eksperimental-design.html#cb633-2" aria-hidden="true" tabindex="-1"></a>LungCapData<span class="sc">$</span>Age.Group <span class="ot">&lt;-</span> <span class="fu">cut</span>(LungCapData<span class="sc">$</span>Age,<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),<span class="at">right=</span><span class="cn">FALSE</span>,<span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb633-3"><a href="emner-fra-eksperimental-design.html#cb633-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(LungCapData<span class="sc">$</span>Age.Group) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;13&quot;</span>,<span class="st">&quot;13-14&quot;</span>,<span class="st">&quot;15-16&quot;</span>,<span class="st">&quot;17+&quot;</span>)</span></code></pre></div>
<p><strong>a</strong>) Lav boxplots med <code>smoke</code> på x-aksen og <code>LungCap</code> på y-aksen.
+ Bemærk hvilken gruppe der har den højeste lungekapacitet.</p>
<p><strong>b</strong>) Lav samme plot, men adskilt efter <code>Age.Group</code>, og beskriv, hvordan det er et eksempel på Simpsons paradoks.</p>
<p><strong>c)</strong> Lav et boxplot med <code>Age</code> på y-aksen og <code>Smoke</code> på x-aksen for at understøtte forklaringen på, hvorfor man ser Simpsons paradoks i dette datasæt.</p>
<hr />
<p><strong>Problem 4</strong>) <em>Anscombes analyse</em> Gentag Anscombes analyse med dinosaurdatasættet:</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="emner-fra-eksperimental-design.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus) <span class="co">#installer denne pakke</span></span>
<span id="cb634-2"><a href="emner-fra-eksperimental-design.html#cb634-2" aria-hidden="true" tabindex="-1"></a>data_dozen <span class="ot">&lt;-</span> datasauRus<span class="sc">::</span>datasaurus_dozen</span>
<span id="cb634-3"><a href="emner-fra-eksperimental-design.html#cb634-3" aria-hidden="true" tabindex="-1"></a>data_dozen</span></code></pre></div>
<pre><code>FALSE # A tibble: 1,846 × 3
FALSE    dataset     x     y
FALSE    &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
FALSE  1 dino     55.4  97.2
FALSE  2 dino     51.5  96.0
FALSE  3 dino     46.2  94.5
FALSE  4 dino     42.8  91.4
FALSE  5 dino     40.8  88.3
FALSE  6 dino     38.7  84.9
FALSE  7 dino     35.6  79.9
FALSE  8 dino     33.1  77.6
FALSE  9 dino     29.0  74.5
FALSE 10 dino     26.2  71.4
FALSE # ℹ 1,836 more rows</code></pre>
<p><strong>a</strong>) Fit en lineær regressionsmodel for hvert af datasættene (brug <code>group_by</code>, <code>nest</code> og <code>map</code> i kombination med en custom funktion), hvor <code>y</code> er den afhængige variabel og <code>x</code> er den uafhængige variabel. Anvend også <code>tidy</code> og <code>glance</code> på alle modellerne.</p>
<p><strong>b</strong>) Brug resultaterne fra <code>tidy</code> til at undersøge hældning og skæring med y-aksen for de forskellige modeller - ligner de hinanden?</p>
<p><strong>c</strong>) Brug også resultaterne fra <code>glance</code> til at undersøge <code>r.squared</code> og <code>p.value</code>.</p>
<p><strong>d</strong>) Er de alle det samme datasæt? Lav et scatter plot opdelt efter de forskellige datasæt. Hvordan ser de bedste rette linjer ud på plottene?</p>
<hr />
<p><strong>Problem 5</strong>) Vi vil gerne undersøge eventuelle batcheffekter i det følgende datasæt. Det er simulerede “single cell”-sekvenserings count data (dataframen <code>cse50</code>) samt dataframen <code>batches</code>, som angiver hvilken batch hver af de 500 celler tilhører.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="emner-fra-eksperimental-design.html#cb636-1" aria-hidden="true" tabindex="-1"></a>cse50 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/o0wzojpcsekeg6z/cell_mix_50_counts.txt?dl=1&quot;</span>)</span>
<span id="cb636-2"><a href="emner-fra-eksperimental-design.html#cb636-2" aria-hidden="true" tabindex="-1"></a>batches <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/4t382bfgro46ka5/cell_mix_50_batches.txt?dl=1&quot;</span>)</span>
<span id="cb636-3"><a href="emner-fra-eksperimental-design.html#cb636-3" aria-hidden="true" tabindex="-1"></a>batches <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;batch&quot;</span><span class="ot">=</span>batches <span class="sc">%&gt;%</span> <span class="fu">pull</span>(batch))</span>
<span id="cb636-4"><a href="emner-fra-eksperimental-design.html#cb636-4" aria-hidden="true" tabindex="-1"></a>cse50 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(cse50)</span></code></pre></div>
<p><strong>a</strong>) Anvend <code>map_df</code> til at transformere disse data til log-skala (tilføj 1 først og tag logaritmen bagefter).</p>
<p><strong>b</strong>) Udfør PCA på det transformeret datasæt.</p>
<p><strong>c</strong>) Brug dine PCA-resultater til at få den rotation matrix</p>
<p><strong>d</strong>) Tilføj oplysningerne fra dataframen <code>batches</code> til din rotation matrix (tilføj først en ny kolonne “column” til <code>batches</code>, der er lig med <code>names(cse50)</code>).</p>
<p><strong>e</strong>) Brug <code>pivot_wider</code> og lav et plot af de første to principal komponenter, hvor du angiver farve efter <code>batch</code>.</p>
<p><strong>f</strong>) Lav også boxplots for de første to prinpical components fordelt efter <code>batch</code> og kommenter kort på eventuelle batch effekts i datasættet.</p>
<hr />
<p><strong>Problem 6</strong> <em>Yderligere Simpson’s paradoks</em></p>
<p>Kør følgende kode for at indlæse og bearbejde det følgende datasæt <code>airlines</code>.</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="emner-fra-eksperimental-design.html#cb637-1" aria-hidden="true" tabindex="-1"></a>airlines <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/d29/airlines.txt&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb637-2"><a href="emner-fra-eksperimental-design.html#cb637-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-3"><a href="emner-fra-eksperimental-design.html#cb637-3" aria-hidden="true" tabindex="-1"></a>airlines <span class="ot">&lt;-</span> airlines <span class="sc">%&gt;%</span> </span>
<span id="cb637-4"><a href="emner-fra-eksperimental-design.html#cb637-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>airport) <span class="sc">%&gt;%</span> </span>
<span id="cb637-5"><a href="emner-fra-eksperimental-design.html#cb637-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(name,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>,<span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;airline&quot;</span>,<span class="st">&quot;status&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb637-6"><a href="emner-fra-eksperimental-design.html#cb637-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">airline =</span> <span class="fu">recode</span>(airline, <span class="at">aa =</span> <span class="st">&quot;Alaska&quot;</span>, <span class="at">aw =</span> <span class="st">&quot;American&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb637-7"><a href="emner-fra-eksperimental-design.html#cb637-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>status,<span class="at">values_from=</span>value) <span class="sc">%&gt;%</span> </span>
<span id="cb637-8"><a href="emner-fra-eksperimental-design.html#cb637-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;ontime&quot;</span> <span class="ot">=</span> ontime <span class="sc">+</span> delayed) <span class="sc">%&gt;%</span> </span>
<span id="cb637-9"><a href="emner-fra-eksperimental-design.html#cb637-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">flights =</span> ontime)</span></code></pre></div>
<p><strong>a</strong>) Opsummer antallet af <code>flights</code> og antallet af <code>delayed</code> over de forskellige lufthavne for at få et samlet tal for hver flyselskab.</p>
<p><strong>b</strong>) Beregn også andelen af flyvninger, der er forsinkede, i hvert flyselskab (igen samlet over alle lufthavne). Lav et søjlediagram for at vise proportionerne.</p>
<p><strong>c</strong>) Denne gang, opsummer over de to flyselskaber for at få et samlet tal for hver lufthavn. Beregn også andelen af flyvninger, der er forsinkede, og lav et plot.</p>
<p><strong>d</strong>) Denne gang, beregn andelen af flyvninger, der er forsinkede, for hver kombination af både lufthavn og flyselskab. Omsæt igen dette til et plot.</p>
<p><strong>e</strong>) Kan du forklare dette? Hint: kig eksempelvis på rådataene og især lufthavnen “Phoenix”.</p>
</div>
<div id="yderligere-læsning" class="section level2 hasAnchor" number="11.8">
<h2><span class="header-section-number">11.8</span> Yderligere læsning<a href="emner-fra-eksperimental-design.html#yderligere-læsning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simpson’s paradox og airlines: <a href="http://ritsokiguess.site/docs/2018/04/07/simpson-s-paradox-log-linear-modelling-and-the-tidyverse/" class="uri">http://ritsokiguess.site/docs/2018/04/07/simpson-s-paradox-log-linear-modelling-and-the-tidyverse/</a></p>
<p>Batch effekt correction: <a href="https://en.wikipedia.org/wiki/Batch_effect#Correction" class="uri">https://en.wikipedia.org/wiki/Batch_effect#Correction</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="principal-component-analysis-pca.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="maskinslæring-i-tidyverse.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["visualisering_22.pdf", "visualisering_22.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
