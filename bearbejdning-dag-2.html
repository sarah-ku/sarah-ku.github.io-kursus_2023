<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Bearbejdning dag 2 | Analyse og visualisering af biologiske datasæt - 2023</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Bearbejdning dag 2 | Analyse og visualisering af biologiske datasæt - 2023" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Bearbejdning dag 2 | Analyse og visualisering af biologiske datasæt - 2023" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

<meta name="author" content="Sarah Rennie" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="functional-programming-med-purrr-pakken.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering kursus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#vectorer"><i class="fa fa-check"></i><b>1.6.1</b> Vectorer</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#datatyper"><i class="fa fa-check"></i><b>1.6.2</b> datatyper</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#delmængder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmængder af dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ifelse"><i class="fa fa-check"></i><b>1.8</b> If/else</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#loops"><i class="fa fa-check"></i><b>1.9</b> Loops</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.10</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.10.1</b> Simulere data fra den normale fordeling</a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.10.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#tapply"><i class="fa fa-check"></i><b>1.10.3</b> <code>tapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#statistike-tester"><i class="fa fa-check"></i><b>1.11</b> Statistike tester</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="index.html"><a href="index.html#p-værdien"><i class="fa fa-check"></i><b>1.11.1</b> P-værdien</a></li>
<li class="chapter" data-level="1.11.2" data-path="index.html"><a href="index.html#korrelation"><i class="fa fa-check"></i><b>1.11.2</b> Korrelation</a></li>
<li class="chapter" data-level="1.11.3" data-path="index.html"><a href="index.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.11.3</b> Test for uafhængighed (chi-sq test)</a></li>
<li class="chapter" data-level="1.11.4" data-path="index.html"><a href="index.html#sample-t-test"><i class="fa fa-check"></i><b>1.11.4</b> 1 sample t-test</a></li>
<li class="chapter" data-level="1.11.5" data-path="index.html"><a href="index.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.11.5</b> 2-sample t-test</a></li>
<li class="chapter" data-level="1.11.6" data-path="index.html"><a href="index.html#paired-t-test"><i class="fa fa-check"></i><b>1.11.6</b> Paired t-test</a></li>
<li class="chapter" data-level="1.11.7" data-path="index.html"><a href="index.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.11.7</b> ANOVA (variansanalyse)</a></li>
<li class="chapter" data-level="1.11.8" data-path="index.html"><a href="index.html#lineær-regression"><i class="fa fa-check"></i><b>1.11.8</b> Lineær regression</a></li>
<li class="chapter" data-level="1.11.9" data-path="index.html"><a href="index.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.11.9</b> R-squared coefficient of determination</a></li>
<li class="chapter" data-level="1.11.10" data-path="index.html"><a href="index.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.11.10</b> Antagelser - lineær regression</a></li>
<li class="chapter" data-level="1.11.11" data-path="index.html"><a href="index.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.11.11</b> Multiple lineær regression</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#problemstillinger"><i class="fa fa-check"></i><b>1.12</b> Problemstillinger</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="index.html"><a href="index.html#quiz---basics"><i class="fa fa-check"></i><b>1.12.1</b> Quiz - Basics</a></li>
<li class="chapter" data-level="1.12.2" data-path="index.html"><a href="index.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.12.2</b> Grundlæggende R</a></li>
<li class="chapter" data-level="1.12.3" data-path="index.html"><a href="index.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.12.3</b> Kort analyse med reaktionstider</a></li>
<li class="chapter" data-level="1.12.4" data-path="index.html"><a href="index.html#øvelse-med-co2"><i class="fa fa-check"></i><b>1.12.4</b> Øvelse med CO2</a></li>
<li class="chapter" data-level="1.12.5" data-path="index.html"><a href="index.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.12.5</b> Ekstra øvelser med statistik tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.1</b> Hvad er R Markdown?</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Installere R Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.3</b> Videodemonstrationer</a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.4</b> Oprette et nyt dokument i R Markdown</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.4.1</b> YAML</a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.4.2</b> Globale options</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.5</b> Skrive baseret tekst</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.5.1</b> Headers</a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.5.2</b> liste</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.6</b> Knitte kode</a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.7</b> Kode chunks</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.7.1</b> Et godt råd når man arbejder med chunks</a></li>
<li class="chapter" data-level="2.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.7.2</b> Chunk indstillinger</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-inden-for-teksten-i-dokumentet-inline-code"><i class="fa fa-check"></i><b>2.8</b> R beregninger inden for teksten i dokumentet (‘inline code’)</a></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.9</b> Working directory</a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.10</b> Matematik</a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.11</b> Problemstillinger</a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.12</b> Færdig for i dag og næste gang</a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.13</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#inledning-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Inledning og videoer</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-for-dag-1"><i class="fa fa-check"></i><b>3.1.1</b> Læringsmålene for dag 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.2</b> Hvad er <strong>ggplot2</strong>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.3</b> Brugen af materialerne</a></li>
<li class="chapter" data-level="3.1.4" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.4</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2</a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot</a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax</a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?</a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#globale-versus-lokale-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Globale versus lokale æstetik</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel</a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver</a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema</a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)</a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)</a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)</a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)</a></li>
<li class="chapter" data-level="3.8.5" data-path="visual1.html"><a href="visual1.html#line-plot-geom_line"><i class="fa fa-check"></i><b>3.8.5</b> Line plot (<code>geom_line()</code>)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#indledning-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Indledning og videoer</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#læringsmålene"><i class="fa fa-check"></i><b>4.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="4.1.2" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.2</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)</a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).</a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver</a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver</a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-labels-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføjelse af labels direkte på plottet.</a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller</a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføjelse af rektangler i regioner af interesse (<code>annotate</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot</a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning dag 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#hvad-er-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Hvad er Tidyverse?</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-for-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper for ‘tidy data’</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-r-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base-R til tidyverse</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasættet"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasættet</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-rengøring"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: Rengøring</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#sammenligningsoperatorer"><i class="fa fa-check"></i><b>5.7.3</b> Sammenligningsoperatorer</a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2</a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#misc-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Misc funktioner som er nyttige at vide</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull</a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning dag 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#indledning-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Indledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#læringsmålene-1"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="6.1.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code>-funktioner</a></li>
<li class="chapter" data-level="6.2.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#flere-summeringsstatistikker-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summeringsstatistikker på én gang</a></li>
<li class="chapter" data-level="6.2.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#mere-avanceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere avanceret <code>group_by()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt"><i class="fa fa-check"></i><b>6.3.1</b> Tidyr pakke - oversigt</a></li>
<li class="chapter" data-level="6.3.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Wide -&gt; Long med <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#eksempel-titanic-opsummeringsstatistikker"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic opsummeringsstatistikker</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration af <code>pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> Funktionen <code>left_join()</code> fra dplyr-pakken</a></li>
<li class="chapter" data-level="6.5.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#anvend-left_join-for-vores-datasæt."><i class="fa fa-check"></i><b>6.5.2</b> Anvend <code>left_join()</code> for vores datasæt.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="6.7" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#ekstra-links-1"><i class="fa fa-check"></i><b>6.7</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#læringsmål"><i class="fa fa-check"></i><b>7.1.1</b> Læringsmål</a></li>
<li class="chapter" data-level="7.1.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#videorressourcer"><i class="fa fa-check"></i><b>7.1.2</b> Videorressourcer</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterative-processer-med-map-funktioner"><i class="fa fa-check"></i><b>7.2</b> Iterative processer med <code>map()</code> funktioner</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner</a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-de-forskellige-map-funktioner"><i class="fa fa-check"></i><b>7.2.2</b> Reference for de forskellige map-funktioner</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner"><i class="fa fa-check"></i><b>7.3</b> Brugerdefinerede funktioner</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-funktioner"><i class="fa fa-check"></i><b>7.3.1</b> Simple funktioner</a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner-med-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Brugerdefinerede funktioner med mapping</a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-datatyper"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre datatyper</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-med-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting med <code>nest()</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvendelse-af-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvendelse af map() med nested data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-funktion-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> funktion for flere inputs</a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformering-af-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformering af numeriske variabler</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt - 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bearbejdning-dag-2" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Bearbejdning dag 2<a href="bearbejdning-dag-2.html#bearbejdning-dag-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="plots/hex-tidyverse.png" width="15%" /></p>
<div id="indledning-og-læringsmålene" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Indledning og læringsmålene<a href="bearbejdning-dag-2.html#indledning-og-læringsmålene" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I dag fortsætter vi arbejdet med <code>tidyverse</code>, især fokusere vi på pakkerne <code>dplyr</code> og <code>tidyr</code>, som kan bruges til at ændre strukturen af et datasæt, så det passer til den krævede struktur for at kunne lave plots med <code>ggplot2</code>.</p>
<p>I biologi er det ofte tilfældet, at dataene er i en dataframe, mens yderligere oplysninger om prøverne er i en anden dataframe. Derfor vil vi gerne lære, hvordan man forbinder disse to dataframes i R, så vi kan bruge de ekstra oplysninger, når vi laver plots af dataene.</p>
<div id="læringsmålene-1" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Læringsmålene<a href="bearbejdning-dag-2.html#læringsmålene-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Du skal kunne:</p>
<ul>
<li>Bruge kombinationen af <code>group_by()</code> og <code>summarise()</code>.</li>
<li>Forstå forskellen mellem <code>wide</code> og <code>long</code> data og bruge <code>pivot_longer()</code> til at lette plotting.</li>
<li>Bruge <code>left_join()</code> eller andre join-funktioner til at tilføje prøveinformation til datasættet.</li>
</ul>
</div>
<div id="videoer" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Videoer<a href="bearbejdning-dag-2.html#videoer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Video 1 - vi skal kigge lidt nærmere på <code>group_by()</code> + <code>summarise()</code> og forbinde <code>tidyverse</code> kode og <code>ggplot2</code> kode sammen med %&gt;%/+.</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/546910681" class="uri">https://player.vimeo.com/video/546910681</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/546910681" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 2 - wide/long data forms og <code>pivot_longer()</code> og bruge den i ggplot2</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/707081191" class="uri">https://player.vimeo.com/video/707081191</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707081191" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 3 - eksempel med titanic summary statistics</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/707223997" class="uri">https://player.vimeo.com/video/707223997</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707223997" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 4: <code>left_join()</code> for at forbine tables med ekstra oplysning</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/707082269" class="uri">https://player.vimeo.com/video/707082269</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707082269" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<div id="group_by-med-summarise-i-dplyr-pakken" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken<a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ved at kombinere <code>group_by()</code> og <code>summarise()</code> kan man finde numeriske svar på spørgsmålet: Havde mænd eller kvinder en højere sandsynlighed for at overleve tragedien?</p>
<p>Lad os starte med at se på en løsning med <code>tapply</code>, hvor vi udregner proportionen af mænd og kvinder, der overlevede. Følgende kode opdeler variablen <code>Survived</code> efter den kategoriske variabel <code>Sex</code> og tager middelværdien. Derved får vi proportionen af overlevende efter køn (da <code>Survived</code> er kodet sådan, at 1 betyder, at man overlevede, og <code>0</code> betyder, at man ikke overlevede).</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="bearbejdning-dag-2.html#cb293-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb293-2"><a href="bearbejdning-dag-2.html#cb293-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Cabin) <span class="sc">%&gt;%</span></span>
<span id="cb293-3"><a href="bearbejdning-dag-2.html#cb293-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span>
<span id="cb293-4"><a href="bearbejdning-dag-2.html#cb293-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-5"><a href="bearbejdning-dag-2.html#cb293-5" aria-hidden="true" tabindex="-1"></a><span class="co">#tapply løsning </span></span>
<span id="cb293-6"><a href="bearbejdning-dag-2.html#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(titanic_clean<span class="sc">$</span>Survived,titanic_clean<span class="sc">$</span>Sex,mean)</span></code></pre></div>
<pre><code>##    female      male 
## 0.7547893 0.2052980</code></pre>
<p>Nu skifter vi over til en <code>tidyverse</code>-løsning. Lad os tage udgangspunkt i <code>summarise()</code>-funktionen. Som et eksempel på, hvordan man bruger funktionen, vil vi beregne en variabel, som hedder “medianFare”, og som er lig med <code>median(Fare)</code>.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="bearbejdning-dag-2.html#cb295-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb295-2"><a href="bearbejdning-dag-2.html#cb295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;medianFare&quot;</span><span class="ot">=</span><span class="fu">median</span>(Fare))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   medianFare
##        &lt;dbl&gt;
## 1       15.7</code></pre>
<p>Vi får faktisk en ny dataramme her, med kun den variabel, som vi lige har specificeret. Vi er dog interesseret i proportionen af overlevende, så vi tager middelværdien af variablen <code>Survived</code>. Lad os gøre det med <code>summarise()</code>:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="bearbejdning-dag-2.html#cb297-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb297-2"><a href="bearbejdning-dag-2.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   meanSurvived
##          &lt;dbl&gt;
## 1        0.406</code></pre>
<p>For at besvare spørgsmålet er vi også nødt til at opdele efter kolonnen <code>Sex</code>. Vi kan bruge kombinationen af <code>group_by()</code> og <code>summarise()</code>. Vi opdeler efter <code>Sex</code> ved at anvende funktionen <code>group_by()</code> og derefter bruger vi <code>summarise()</code> til at oprette en kolonne, der hedder <code>meanSurvived</code>, som viser proportionen af overlevende for både kvinder og mænd.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="bearbejdning-dag-2.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tidyverse løsning</span></span>
<span id="cb299-2"><a href="bearbejdning-dag-2.html#cb299-2" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb299-3"><a href="bearbejdning-dag-2.html#cb299-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb299-4"><a href="bearbejdning-dag-2.html#cb299-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   Sex    meanSurvived
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 female        0.755
## 2 male          0.205</code></pre>
<p>Lad os tage resultatet fra ovenstående og visualisere det i et barplot, som vist nedenfor:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="bearbejdning-dag-2.html#cb301-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb301-2"><a href="bearbejdning-dag-2.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb301-3"><a href="bearbejdning-dag-2.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived)) <span class="sc">%&gt;%</span></span>
<span id="cb301-4"><a href="bearbejdning-dag-2.html#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>meanSurvived,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb301-5"><a href="bearbejdning-dag-2.html#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-313-1.png" width="288" /></p>
<div id="reference-af-summarise-funktioner" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Reference af <code>summarise()</code>-funktioner<a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Her er nogle funktioner, som man ofte bruger med <code>summarise()</code> (der er mange andre muligheder).</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Funktion</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mean()</code></td>
<td>giver os middelværdien af en variabel.</td>
</tr>
<tr class="even">
<td><code>sd()</code></td>
<td>giver os standardafvigelsen af en variabel.</td>
</tr>
<tr class="odd">
<td><code>min()</code></td>
<td>giver os den laveste værdi af en variabel.</td>
</tr>
<tr class="even">
<td><code>max()</code></td>
<td>giver os den højeste værdi af en variabel.</td>
</tr>
<tr class="odd">
<td><code>n()</code></td>
<td>giver os antallet af observationer i en variabel og mange flere.</td>
</tr>
<tr class="even">
<td><code>first()</code></td>
<td>giver os de første værdier.</td>
</tr>
</tbody>
</table>
</div>
<div id="flere-summeringsstatistikker-på-én-gang" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Flere summeringsstatistikker på én gang<a href="bearbejdning-dag-2.html#flere-summeringsstatistikker-på-én-gang" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi kan også lave flere summeringsstatistikker på én gang. For eksempel kan vi anvende funktionen <code>group_by</code> med Sex igen, men beregne flere forskellige summeringsstatistikker:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="bearbejdning-dag-2.html#cb302-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb302-2"><a href="bearbejdning-dag-2.html#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb302-3"><a href="bearbejdning-dag-2.html#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),                    <span class="co">#count</span></span>
<span id="cb302-4"><a href="bearbejdning-dag-2.html#cb302-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived),  <span class="co">#middelværdi survived</span></span>
<span id="cb302-5"><a href="bearbejdning-dag-2.html#cb302-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanAge =</span> <span class="fu">mean</span>(Age),            <span class="co">#middelværdi age</span></span>
<span id="cb302-6"><a href="bearbejdning-dag-2.html#cb302-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">propFirst =</span> <span class="fu">sum</span>(Pclass<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">n</span>()) <span class="co">#proportionen i første klass</span></span>
<span id="cb302-7"><a href="bearbejdning-dag-2.html#cb302-7" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   Sex    count meanSurvived meanAge propFirst
##   &lt;chr&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 female   261        0.755    27.9     0.326
## 2 male     453        0.205    30.7     0.223</code></pre>
<p>Denne summeringstabel kan igen bruges som et datasæt til at lave et plot med <code>ggplot2</code>. Bemærk, at her bruger vi <code>stat="identity"</code>, fordi vi ikke skal tælle observationerne op, men blot plotte præcis de tal, der er i datarammen, på y-aksen. I nedenstående eksempel laver vi barplots for <code>meanAge</code> og <code>propFirst</code>. De er plottet ved hjælp af to forskellige <code>ggplot</code>-kommandoer, og bemærk, at de er plottet ved siden af hinanden ved hjælp af en funktion kaldet <code>grid.arrange()</code> fra R-pakken <code>gridExtra</code>.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="bearbejdning-dag-2.html#cb304-1" aria-hidden="true" tabindex="-1"></a>plotA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>titanic_clean_summary_by_sex,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>meanAge,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb304-2"><a href="bearbejdning-dag-2.html#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb304-3"><a href="bearbejdning-dag-2.html#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb304-4"><a href="bearbejdning-dag-2.html#cb304-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-5"><a href="bearbejdning-dag-2.html#cb304-5" aria-hidden="true" tabindex="-1"></a>plotB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>titanic_clean_summary_by_sex,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>propFirst,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb304-6"><a href="bearbejdning-dag-2.html#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb304-7"><a href="bearbejdning-dag-2.html#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb304-8"><a href="bearbejdning-dag-2.html#cb304-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-9"><a href="bearbejdning-dag-2.html#cb304-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb304-10"><a href="bearbejdning-dag-2.html#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plotA,plotB,<span class="at">ncol=</span><span class="dv">2</span>) <span class="co">#plot both together</span></span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-315-1.png" width="480" /></p>
<p>Vi kan se, at kvinder i gennemsnit var lidt yngre end mænd og havde en højere sandsynlighed for at være i første klasse. Et interessant spørgsmål er, hvordan man kan lave de ovenstående plots uden at bruge to forskellige <code>ggplot</code>-kommandoer. Med andre ord, hvordan man kan lave en automatisk løsning, hvor vi kan plotte flere summeringsstatistikker med kun én <code>ggplot</code>-kommando. Vi vil se, hvordan det kan gøres ved først at konvertere datasættet til long-form.</p>
</div>
<div id="mere-avanceret-group_by" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Mere avanceret <code>group_by()</code><a href="bearbejdning-dag-2.html#mere-avanceret-group_by" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lad os også beregne, hvor mange passagerer der var, efter både deres klasse og hvor de gik om bord på skibet:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="bearbejdning-dag-2.html#cb305-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb305-2"><a href="bearbejdning-dag-2.html#cb305-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(Embarked, Pclass) <span class="sc">%&gt;%</span> <span class="co"># Grupper efter flere variable... </span></span>
<span id="cb305-3"><a href="bearbejdning-dag-2.html#cb305-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Embarked&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## # A tibble: 10 × 3
## # Groups:   Embarked [4]
##    Embarked Pclass count
##    &lt;chr&gt;     &lt;int&gt; &lt;int&gt;
##  1 &quot;&quot;            1     2
##  2 &quot;C&quot;           1    74
##  3 &quot;C&quot;           2    15
##  4 &quot;C&quot;           3    41
##  5 &quot;Q&quot;           1     2
##  6 &quot;Q&quot;           2     2
##  7 &quot;Q&quot;           3    24
##  8 &quot;S&quot;           1   108
##  9 &quot;S&quot;           2   156
## 10 &quot;S&quot;           3   290</code></pre>
<p>Man kan se, at størstedelen gik ombord i Southampton (S), men der var også forholdsvis mange førsteklasses-passagerer, der gik ombord i Cherbourg (C). Lad os fortsætte med vores <code>Survived</code>-eksempel og beregne proportionen af overlevende efter de tre variable <code>Adult</code>, <code>Sex</code> og <code>Pclass</code>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="bearbejdning-dag-2.html#cb308-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_survived <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb308-2"><a href="bearbejdning-dag-2.html#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Adult =</span> <span class="fu">ifelse</span>(Age<span class="sc">&gt;=</span><span class="dv">18</span>,<span class="st">&quot;Adult&quot;</span>,<span class="st">&quot;Child&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb308-3"><a href="bearbejdning-dag-2.html#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Adult,Sex,Pclass) <span class="sc">%&gt;%</span> </span>
<span id="cb308-4"><a href="bearbejdning-dag-2.html#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Adult&#39;, &#39;Sex&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="bearbejdning-dag-2.html#cb310-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_survived</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
## # Groups:   Adult, Sex [4]
##    Adult Sex    Pclass meanSurvived
##    &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;        &lt;dbl&gt;
##  1 Adult female      1       0.974 
##  2 Adult female      2       0.903 
##  3 Adult female      3       0.418 
##  4 Adult male        1       0.371 
##  5 Adult male        2       0.0682
##  6 Adult male        3       0.133 
##  7 Child female      1       0.875 
##  8 Child female      2       1     
##  9 Child female      3       0.543 
## 10 Child male        1       1     
## 11 Child male        2       0.818 
## 12 Child male        3       0.233</code></pre>
<p>Og så kan vi også bruge resultatet i en <code>ggplot</code>, hvor vi kombinerer de tre variable og opdeler det i tre plots efter <code>Pclass</code>:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="bearbejdning-dag-2.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(titanic_clean_summary_survived,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>meanSurvived,<span class="at">fill=</span>Adult)) <span class="sc">+</span></span>
<span id="cb312-2"><a href="bearbejdning-dag-2.html#cb312-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb312-3"><a href="bearbejdning-dag-2.html#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Pclass) <span class="sc">+</span> </span>
<span id="cb312-4"><a href="bearbejdning-dag-2.html#cb312-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion survived&quot;</span>) <span class="sc">+</span></span>
<span id="cb312-5"><a href="bearbejdning-dag-2.html#cb312-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-318-1.png" width="480" /></p>
</div>
<div id="funktionen-ungroup" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Funktionen <code>ungroup()</code><a href="bearbejdning-dag-2.html#funktionen-ungroup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nogle gange, når man er færdig med en proces, men gerne vil arbejde videre med et datasæt, er det nyttigt at anvende <code>ungroup()</code> på datasættet igen. Det er mest relevant i længere projekter. Som et eksempel kan vi se på følgende kode, hvor der står “Groups: Adult [2]” øverst i den nye dataramme med summeringsstatistikker:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="bearbejdning-dag-2.html#cb313-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb313-2"><a href="bearbejdning-dag-2.html#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Adult =</span> <span class="fu">ifelse</span>(Age<span class="sc">&gt;=</span><span class="dv">18</span>,<span class="st">&quot;Adult&quot;</span>,<span class="st">&quot;Child&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb313-3"><a href="bearbejdning-dag-2.html#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Adult,Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb313-4"><a href="bearbejdning-dag-2.html#cb313-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Adult&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bearbejdning-dag-2.html#cb315-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   Adult [2]
##   Adult Sex    meanSurvived
##   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
## 1 Adult female        0.772
## 2 Adult male          0.177
## 3 Child female        0.691
## 4 Child male          0.397</code></pre>
<p>Bemærk, at vi først brugte <code>group_by()</code> på både <code>Adult</code> og <code>Sex</code>. Men hver gang man laver en beregning, fjernes én opdeling - i dette tilfælde opdeles der ikke længere efter <code>Sex</code>, men der opdeles stadig efter <code>Adult</code>. Det er ikke et problem, hvis vi ikke vil arbejde videre med datarammen. Men forestil dig, at vi gerne vil vide, hvad den maksimale chance for overlevelse er, ud fra de fire beregnede tal. Hvis vi ikke vil opdele efter en kategorisk variabel, dropper vi <code>group_by()</code>:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="bearbejdning-dag-2.html#cb317-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary <span class="sc">%&gt;%</span> </span>
<span id="cb317-2"><a href="bearbejdning-dag-2.html#cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;maxChance&quot;</span> <span class="ot">=</span> <span class="fu">max</span>(meanSurvived))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   Adult maxChance
##   &lt;chr&gt;     &lt;dbl&gt;
## 1 Adult     0.772
## 2 Child     0.691</code></pre>
<p>Man kan dog se, at outputtet er blevet opdelt efter variablen <code>Adult</code>. For at undgå dette skal man først anvende <code>ungroup()</code>, så effekten af <code>group_by()</code> fjernes.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="bearbejdning-dag-2.html#cb319-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary <span class="sc">%&gt;%</span> </span>
<span id="cb319-2"><a href="bearbejdning-dag-2.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb319-3"><a href="bearbejdning-dag-2.html#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;maxChance&quot;</span> <span class="ot">=</span> <span class="fu">max</span>(meanSurvived))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   maxChance
##       &lt;dbl&gt;
## 1     0.772</code></pre>
</div>
</div>
<div id="pivot_longerpivot_wider-med-tidyr-pakken" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken<a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Tidy data</strong> findes i to former: wide data og long data. Det kan være nyttigt at transformere datarammen fra den ene form til den anden, f.eks. for at lave et bestemt plot med <code>ggplot2</code>-pakken. Inden for pakken <code>tidyr</code> er der funktioner, der kan bruges til at lave disse transformationer.</p>
<p>Før vi begynder at se lidt nærmere på <code>tidyr</code>, skal vi beskrive, hvad long data og wide data betyder.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-322"></span>
<img src="plots/original-dfs-tidy.png" alt="source: https://www.garrickadenbuie.com/project/tidyexplain/" width="75%" />
<p class="caption">
Figure 6.1: source: <a href="https://www.garrickadenbuie.com/project/tidyexplain/" class="uri">https://www.garrickadenbuie.com/project/tidyexplain/</a>
</p>
</div>
<p><strong>Wide data</strong>: Her har man én kolonne for hver variabel og én række for hver observation. Dette gør dataene lette at forstå, og denne datatype findes ofte indenfor biologi - for eksempel, hvis man har forskellige prøver (behandlinger, kontroller, betingelser osv.) som variabler.</p>
<p><strong>Long data</strong>: Med long data har man værdier samlet i en enkelt kolonne og en kolonne som en slags nøgle, der også angiver, hvilken variabel hver værdi hørte til i det wide format. Datasættet betragtes stadig som <strong>tidy</strong>, men informationen opbevares på en anden måde. Det er lidt sværere at læse, men nemmere at arbejde med, når man analyserer dataene.</p>
<p>Når man transformerer data fra wide til long eller omvendt, kaldes det for <strong>reshaping</strong>.</p>
<div id="tidyr-pakke---oversigt" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Tidyr pakke - oversigt<a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Her er en oversigt over de fire vigtigste funktioner fra R-pakken <code>tidyr</code>. Vi fokuserer mest på <code>pivot</code>-funktionerne, men det kan være nyttigt at bruge <code>separate</code> og <code>unite</code> en gang imellem.</p>
<table>
<thead>
<tr class="header">
<th><code>tidyr</code> funktion</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pivot_longer()</code></td>
<td>wide til long</td>
</tr>
<tr class="even">
<td><code>pivot_wider()</code></td>
<td>long til wide</td>
</tr>
<tr class="odd">
<td><code>separate()</code></td>
<td>opdele strenge fra én kolonne til to</td>
</tr>
<tr class="even">
<td><code>unite()</code></td>
<td>føje strenge sammen fra to til én kolonne</td>
</tr>
</tbody>
</table>
</div>
<div id="wide---long-med-pivot_longer" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Wide -&gt; Long med <code>pivot_longer()</code><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lad os arbejde med datasættet <code>Iris</code>. Man får Iris i long format med følgende kommando. Her vil man gerne tage alle numeriske kolonner og placere deres værdier i en enkelt kolonne <code>value</code> (med en nøglekolonne <code>name</code> til at skelne imellem de forskellige variabler).</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="bearbejdning-dag-2.html#cb321-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code>## # A tibble: 600 × 3
##    Species name         value
##    &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
##  1 setosa  Sepal.Length   5.1
##  2 setosa  Sepal.Width    3.5
##  3 setosa  Petal.Length   1.4
##  4 setosa  Petal.Width    0.2
##  5 setosa  Sepal.Length   4.9
##  6 setosa  Sepal.Width    3  
##  7 setosa  Petal.Length   1.4
##  8 setosa  Petal.Width    0.2
##  9 setosa  Sepal.Length   4.7
## 10 setosa  Sepal.Width    3.2
## # … with 590 more rows</code></pre>
<p>At beholde numeriske kolonner svarer i dette tilfælde til, at man ikke vil have variablen <code>Species</code> med i den enkelte kolonne:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="bearbejdning-dag-2.html#cb323-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb323-2"><a href="bearbejdning-dag-2.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species)</span></code></pre></div>
<pre><code>## # A tibble: 600 × 3
##    Species name         value
##    &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
##  1 setosa  Sepal.Length   5.1
##  2 setosa  Sepal.Width    3.5
##  3 setosa  Petal.Length   1.4
##  4 setosa  Petal.Width    0.2
##  5 setosa  Sepal.Length   4.9
##  6 setosa  Sepal.Width    3  
##  7 setosa  Petal.Length   1.4
##  8 setosa  Petal.Width    0.2
##  9 setosa  Sepal.Length   4.7
## 10 setosa  Sepal.Width    3.2
## # … with 590 more rows</code></pre>
<p>Her er et billed, der illustrerer wide- og long-form med datasættet <code>iris</code>:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-325"></span>
<img src="plots/wide_to_long.png" alt="wide til long med Iris" width="100%" />
<p class="caption">
Figure 6.2: wide til long med Iris
</p>
</div>
<p>Til venstre har vi målingerne i datasættet fordelt over fire forskellige kolonner kaldet <code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code> og <code>Petal.Width</code>, samt en ekstra kolonne, der skelner mellem de tre <code>Species</code>. Til højre har vi samlet alle målingerne i en enkelt kolonne kaldet <code>values</code>, og så bruger vi en anden ‘nøgle’ kolonne kaldet <code>name</code> til at fortælle os, om det er en måling for <code>Sepal.Length</code> eller <code>Sepal.Width</code> osv.</p>
<p>Jeg kan ændre kolonnenavne for målingerne og nøglen til nogle andre end standardnavnene. For eksempel, i nedenstående eksempel skal målingerne hedde <code>measurements</code> og nøglen hedde <code>trait</code>.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="bearbejdning-dag-2.html#cb325-1" aria-hidden="true" tabindex="-1"></a>iris.long <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species,</span>
<span id="cb325-2"><a href="bearbejdning-dag-2.html#cb325-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>,</span>
<span id="cb325-3"><a href="bearbejdning-dag-2.html#cb325-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>)</span></code></pre></div>
<p><img src="plots/wide_to_long_names.png" width="100%" /></p>
<p>Man kan for eksempel bruge den long form til at visualisere samtlige mulige boxplots opdelt efter <code>Species</code> og <code>trait</code> på samme plot:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="bearbejdning-dag-2.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris.long,<span class="fu">aes</span>(<span class="at">y=</span>measurement,<span class="at">x=</span>Species,<span class="at">fill=</span>Species)) <span class="sc">+</span> </span>
<span id="cb326-2"><a href="bearbejdning-dag-2.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb326-3"><a href="bearbejdning-dag-2.html#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>trait) <span class="sc">+</span></span>
<span id="cb326-4"><a href="bearbejdning-dag-2.html#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-328-1.png" width="576" /></p>
</div>
<div id="separate" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> <code>separate()</code><a href="bearbejdning-dag-2.html#separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>separate()</code> fra pakken <code>tidyr</code> kan bruges til at opdele to forskellige dele, som eksisterer i samme kolonne. For eksempel, i <code>iris</code> har vi variabler med navne <code>Sepal.Width</code>, <code>Sepal.Length</code> osv. - man kan forestille sig at opdele disse navne over to kolonner i stedet for én - fx “Sepal” og “Width” i tilfældet af <code>Sepal.Width</code>. I nedenstående kan man se, hvordan man anvender <code>separate()</code>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="bearbejdning-dag-2.html#cb327-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb327-2"><a href="bearbejdning-dag-2.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb327-3"><a href="bearbejdning-dag-2.html#cb327-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb327-4"><a href="bearbejdning-dag-2.html#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Species part  measure measurement
##   &lt;fct&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
## 1 setosa  Sepal Length          5.1
## 2 setosa  Sepal Width           3.5
## 3 setosa  Petal Length          1.4
## 4 setosa  Petal Width           0.2
## 5 setosa  Sepal Length          4.9
## 6 setosa  Sepal Width           3</code></pre>
<p>Man specificerer variablen <code>trait</code> og angiver, at den skal opdeles til to variabler <code>part</code> og <code>measure</code>. Vi angiver <code>sep = "\\."</code>, hvilket betyder, at vi gerne vil have <code>part</code> som delen af <code>trait</code> foran ‘.’ og <code>measure</code> som delen af <code>trait</code> efter <code>.</code>. Vi bruger “\.” for at fortælle, at vi er interesseret i punktummet og ikke en “anonym karakter”, som punktum normalt betyder i “streng”-sprog. Man behøver faktisk ikke at specificere <code>sep = "\\."</code> i dette tilfælde - som standard kigger funktionen efter ‘non-character’ tegn og bruger dem til at lave opdelingen.</p>
<p>Samme resultat:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="bearbejdning-dag-2.html#cb329-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb329-2"><a href="bearbejdning-dag-2.html#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb329-3"><a href="bearbejdning-dag-2.html#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb329-4"><a href="bearbejdning-dag-2.html#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Species part  measure measurement
##   &lt;fct&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
## 1 setosa  Sepal Length          5.1
## 2 setosa  Sepal Width           3.5
## 3 setosa  Petal Length          1.4
## 4 setosa  Petal Width           0.2
## 5 setosa  Sepal Length          4.9
## 6 setosa  Sepal Width           3</code></pre>
<p>Bruger resultatet i et plot:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="bearbejdning-dag-2.html#cb331-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb331-2"><a href="bearbejdning-dag-2.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb331-3"><a href="bearbejdning-dag-2.html#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb331-4"><a href="bearbejdning-dag-2.html#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>measurement,<span class="at">x=</span>part,<span class="at">fill=</span>part)) <span class="sc">+</span> </span>
<span id="cb331-5"><a href="bearbejdning-dag-2.html#cb331-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb331-6"><a href="bearbejdning-dag-2.html#cb331-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>measure) <span class="sc">+</span></span>
<span id="cb331-7"><a href="bearbejdning-dag-2.html#cb331-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-331-1.png" width="480" /></p>
<p>Se også <code>unite()</code> som gøre det modsatte til <code>separate()</code>.</p>
</div>
</div>
<div id="eksempel-titanic-opsummeringsstatistikker" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Eksempel: Titanic opsummeringsstatistikker<a href="bearbejdning-dag-2.html#eksempel-titanic-opsummeringsstatistikker" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Her er et eksempel med datasættet <code>titanic</code>, der inddrager mange af de tidyverse-koncepter, vi har lært indtil videre.</p>
<ul>
<li><code>group_by()</code> og <code>summarise()</code></li>
</ul>
<p>Vi laver vores opsummeringsstatistikker som i ovenstående.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="bearbejdning-dag-2.html#cb332-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb332-2"><a href="bearbejdning-dag-2.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb332-3"><a href="bearbejdning-dag-2.html#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb332-4"><a href="bearbejdning-dag-2.html#cb332-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived),</span>
<span id="cb332-5"><a href="bearbejdning-dag-2.html#cb332-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanAge =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb332-6"><a href="bearbejdning-dag-2.html#cb332-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">propFirst =</span> <span class="fu">sum</span>(Pclass <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb332-7"><a href="bearbejdning-dag-2.html#cb332-7" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   Sex    count meanSurvived meanAge propFirst
##   &lt;chr&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 female   261        0.755    27.9     0.326
## 2 male     453        0.205    30.7     0.223</code></pre>
<ul>
<li><code>pivot_longer()</code></li>
</ul>
<p>Vi transformerer eller <strong>reshaper</strong> datarammen fra wide data til long data. Vi vil samle kun de numeriske opsummeringsstatistikker i en enkelt kolonne, så variablen <code>Sex</code> skal ikke indgå i den enkelte kolonne.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="bearbejdning-dag-2.html#cb334-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   Sex    name           value
##   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
## 1 female count        261    
## 2 female meanSurvived   0.755
## 3 female meanAge       27.9  
## 4 female propFirst      0.326
## 5 male   count        453    
## 6 male   meanSurvived   0.205
## 7 male   meanAge       30.7  
## 8 male   propFirst      0.223</code></pre>
<ul>
<li><code>ggplot()</code> med <code>facet_grid()</code></li>
</ul>
<p>Vi kombinerer <code>pivot_longer()</code> med et plot af vores opsummeringsstatistikker og benytter <code>facet_grid()</code> til at adskille de forskellige statistikker.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="bearbejdning-dag-2.html#cb336-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb336-2"><a href="bearbejdning-dag-2.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Sex) <span class="sc">%&gt;%</span></span>
<span id="cb336-3"><a href="bearbejdning-dag-2.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> value, <span class="at">fill =</span> Sex)) <span class="sc">+</span> </span>
<span id="cb336-4"><a href="bearbejdning-dag-2.html#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb336-5"><a href="bearbejdning-dag-2.html#cb336-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>name) <span class="sc">+</span></span>
<span id="cb336-6"><a href="bearbejdning-dag-2.html#cb336-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-334-1.png" width="480" /></p>
<ul>
<li><code>facet_wrap()</code></li>
</ul>
<p>Vi laver det samme som ovenstående, men specificerer <code>facet_wrap()</code> i stedet for <code>facet_grid()</code>. Indenfor <code>facet_wrap()</code> kan man bruge indstillingen <code>scales="free"</code>, som gør, at de fire plots får hver deres egne aksegrænser.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="bearbejdning-dag-2.html#cb337-1" aria-hidden="true" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb337-2"><a href="bearbejdning-dag-2.html#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex) <span class="sc">%&gt;%</span></span>
<span id="cb337-3"><a href="bearbejdning-dag-2.html#cb337-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>value,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb337-4"><a href="bearbejdning-dag-2.html#cb337-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb337-5"><a href="bearbejdning-dag-2.html#cb337-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>,<span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span>  </span>
<span id="cb337-6"><a href="bearbejdning-dag-2.html#cb337-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-335-1.png" width="480" /></p>
<div id="demonstration-af-pivot_wider" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Demonstration af <code>pivot_wider()</code><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Det er også brugbart at kende måden at man skifter fra long form til wide form.</p>
<ul>
<li>Wide -&gt; Long</li>
</ul>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="bearbejdning-dag-2.html#cb338-1" aria-hidden="true" tabindex="-1"></a>titanic_summary_long <span class="ot">&lt;-</span> titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb338-2"><a href="bearbejdning-dag-2.html#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex)</span></code></pre></div>
<ul>
<li>Long -&gt; Wide</li>
</ul>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="bearbejdning-dag-2.html#cb339-1" aria-hidden="true" tabindex="-1"></a>titanic_summary_long <span class="sc">%&gt;%</span></span>
<span id="cb339-2"><a href="bearbejdning-dag-2.html#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>,<span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   Sex    count meanSurvived meanAge propFirst
##   &lt;chr&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 female   261        0.755    27.9     0.326
## 2 male     453        0.205    30.7     0.223</code></pre>
<p>Parametre er:</p>
<ul>
<li><code>names_from</code> - nøglekolonne, som skal udgøre flere kolonner i den nye dataframe</li>
<li><code>values_from</code> - selve værdier, som skal være i de nye kolonner i den wide form</li>
</ul>
</div>
</div>
<div id="left_join-forbinde-dataframes" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> <code>left_join()</code>: forbinde dataframes<a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi tager udgangspunkt i følgende to dataframes:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="bearbejdning-dag-2.html#cb341-1" aria-hidden="true" tabindex="-1"></a>gene_table <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/6ll8ezrskly8joi/mouse_2gene_expr.txt?dl=1&quot;</span>,<span class="at">header=</span>T))</span>
<span id="cb341-2"><a href="bearbejdning-dag-2.html#cb341-2" aria-hidden="true" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/jlrszakmqlnmu2m/bottomly_phenodata.txt?dl=1&quot;</span>))</span></code></pre></div>
<p>Lad os først kigge på datasættet <code>gene_table</code>, som viser genekspressionsmålinger over forskellige prøver fra mus.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="bearbejdning-dag-2.html#cb342-1" aria-hidden="true" tabindex="-1"></a>gene_table</span></code></pre></div>
<pre><code>## # A tibble: 3 × 22
##   gene   SRX03…¹ SRX03…² SRX03…³ SRX03…⁴ SRX03…⁵ SRX03…⁶ SRX03…⁷ SRX03…⁸ SRX03…⁹
##   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 ENSMU…    158.    182.   119.     155.   167.    164.     180.   263.     276.
## 2 ENSMU…    143.    118.    91.6    106.   157.     95.1    131.    77.2    126.
## 3 ENSMU…    132.    117.   100.     116.    88.1   125.     124.    87.8    107.
## # … with 12 more variables: SRX033479 &lt;dbl&gt;, SRX033472 &lt;dbl&gt;, SRX033473 &lt;dbl&gt;,
## #   SRX033474 &lt;dbl&gt;, SRX033475 &lt;dbl&gt;, SRX033491 &lt;dbl&gt;, SRX033484 &lt;dbl&gt;,
## #   SRX033492 &lt;dbl&gt;, SRX033485 &lt;dbl&gt;, SRX033493 &lt;dbl&gt;, SRX033486 &lt;dbl&gt;,
## #   SRX033494 &lt;dbl&gt;, and abbreviated variable names ¹​SRX033480, ²​SRX033488,
## #   ³​SRX033481, ⁴​SRX033489, ⁵​SRX033482, ⁶​SRX033490, ⁷​SRX033483, ⁸​SRX033476,
## #   ⁹​SRX033478</code></pre>
<p>Man kan se, at der er 22 kolonner i datasættet - én der refererer til et gen-navn og 21, der er forskellige prøver fra eksperimentet. Men det er ikke klart, hvad den enkelte prøve egentlig er. Lad os derfor kigge på de prøveoplysninger, som kan være nyttige at inddrage i vores analyse/plots for at undersøge eventuelle batcheffekter osv.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="bearbejdning-dag-2.html#cb344-1" aria-hidden="true" tabindex="-1"></a>coldata</span></code></pre></div>
<pre><code>## # A tibble: 21 × 5
##    sample    num.tech.reps strain   batch lane.number
##    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;    &lt;int&gt;       &lt;int&gt;
##  1 SRX033480             1 C57BL.6J     6           1
##  2 SRX033488             1 C57BL.6J     7           1
##  3 SRX033481             1 C57BL.6J     6           2
##  4 SRX033489             1 C57BL.6J     7           2
##  5 SRX033482             1 C57BL.6J     6           3
##  6 SRX033490             1 C57BL.6J     7           3
##  7 SRX033483             1 C57BL.6J     6           5
##  8 SRX033476             1 C57BL.6J     4           6
##  9 SRX033478             1 C57BL.6J     4           7
## 10 SRX033479             1 C57BL.6J     4           8
## # … with 11 more rows</code></pre>
<p>Man kan se forskellige oplysninger om de 21 prøver, blandt andet den stamme af mus, hver prøve stammer fra, og den batch. Her refererer <code>batch</code> til de forskellige omstændigheder eller tidspunkter, hvor prøverne blev samlet. Hvis man er interesseret i, om der er en forskel i ekspressionsniveau mellem de to stammer (strains), kan det være nødvendigt at kontrollere efter batch for at sikre, at forskellen skyldes <code>strain</code> og ikke tekniske effekter på grund af <code>batch</code>.</p>
<div id="funktionen-left_join-fra-dplyr-pakken" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Funktionen <code>left_join()</code> fra dplyr-pakken<a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>left_join()</code> er en del af pakken <code>dplyr</code>, som vi har arbejdet meget med indtil videre i kurset.</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>funktion</th>
<th>Beskrivelse (kopieret)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left_join()</code></td>
<td>Tilføj matchende rækker fra den anden tabel til den første</td>
</tr>
<tr class="even">
<td><code>right_join()</code></td>
<td>Tilføj matchende rækker fra den første tabel til den anden</td>
</tr>
<tr class="odd">
<td><code>inner_join()</code></td>
<td>Sammenføj to tabeller og returner alle rækker, der er til stede i begge</td>
</tr>
<tr class="even">
<td><code>full_join()</code></td>
<td>Sammenføj data med alle mulige rækker til stede</td>
</tr>
</tbody>
</table>
<p>Vi fokuserer her på funktionen <code>left_join()</code> fordi den er mest brugbar i biologiske dataanalyser, men vi kigger også på de øvrige funktioner gennem problemstillingerne nedenfor. Her er en grafisk demonstration af <code>left_join()</code> (kilde: <a href="https://mgimond.github.io/ES218/Week03c.html" class="uri">https://mgimond.github.io/ES218/Week03c.html</a>):</p>
<p><img src="plots/left_join.png" width="60%" /></p>
<p>Det særlige ved <code>left_join</code> i forhold til de andre funktioner er, at <code>left_join</code> bevarer samtlige data i dataframen, man tager udgangspunkt i - det vil sige <code>df</code> i ovenstående billede, selvom <code>d</code> ikke matcher med en frugt i <code>dj</code>. I ovenstående genekspressionseksempel betyder det, at man bevarer alle målinger i <code>gene_table</code>, uanset om der er oplysninger om deres pågældende prøver.</p>
</div>
<div id="anvend-left_join-for-vores-datasæt." class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Anvend <code>left_join()</code> for vores datasæt.<a href="bearbejdning-dag-2.html#anvend-left_join-for-vores-datasæt." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ligesom man matcher kolonnen <code>y</code> i <code>df</code> og <code>dj</code> i ovenstående eksempel, skal vi også have en kolonne, vi kan matche. Vi vil gerne bruge kolonnen <code>sample</code> fra <code>sample_info</code> til at sammenligne med de forskellige prøvenavne i <code>gene_table</code>, men først er vi nødt til at lave <code>gene_table</code> om til long-form, således at prøvenavne fremgår i en enkelt kolonne, <code>sample</code> (der kan bruges i <code>left_join</code>).</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="bearbejdning-dag-2.html#cb346-1" aria-hidden="true" tabindex="-1"></a>gene_table_long <span class="ot">&lt;-</span> gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb346-2"><a href="bearbejdning-dag-2.html#cb346-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>gene,</span>
<span id="cb346-3"><a href="bearbejdning-dag-2.html#cb346-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>,</span>
<span id="cb346-4"><a href="bearbejdning-dag-2.html#cb346-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;expression&quot;</span>) </span>
<span id="cb346-5"><a href="bearbejdning-dag-2.html#cb346-5" aria-hidden="true" tabindex="-1"></a>gene_table_long</span></code></pre></div>
<pre><code>## # A tibble: 63 × 3
##    gene               sample    expression
##    &lt;chr&gt;              &lt;chr&gt;          &lt;dbl&gt;
##  1 ENSMUSG00000006517 SRX033480       158.
##  2 ENSMUSG00000006517 SRX033488       182.
##  3 ENSMUSG00000006517 SRX033481       119.
##  4 ENSMUSG00000006517 SRX033489       155.
##  5 ENSMUSG00000006517 SRX033482       167.
##  6 ENSMUSG00000006517 SRX033490       164.
##  7 ENSMUSG00000006517 SRX033483       180.
##  8 ENSMUSG00000006517 SRX033476       263.
##  9 ENSMUSG00000006517 SRX033478       276.
## 10 ENSMUSG00000006517 SRX033479       328.
## # … with 53 more rows</code></pre>
<p>Dernæst kan vi tilføje oplysningsdata fra <code>sample_info</code>. Her angiver vi <code>by = "sample"</code> fordi det er navnet på kolonnen, som vi gerne vil bruge til at forbinde de to datarammer - altså, det er med i begge datarammer, så <code>left_join()</code> kan bruge det som en slags nøgle til at vide, hvor alle de forskellige oplysninger skal tilføjes.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="bearbejdning-dag-2.html#cb348-1" aria-hidden="true" tabindex="-1"></a>data_join <span class="ot">&lt;-</span> gene_table_long  <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(coldata, <span class="at">by=</span><span class="st">&quot;sample&quot;</span>)</span></code></pre></div>
<p>Nu, hvor vi har fået forbundet de to datarammer, kan man inddrage de ekstra oplysninger vi har fået i et plot. Her laver vi et plot med en farve til hver stamme og et plot med en farve til hver batch.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="bearbejdning-dag-2.html#cb349-1" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> data_join <span class="sc">%&gt;%</span> </span>
<span id="cb349-2"><a href="bearbejdning-dag-2.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>expression,<span class="at">x=</span><span class="fu">as.factor</span>(strain),<span class="at">fill=</span>gene)) <span class="sc">+</span> </span>
<span id="cb349-3"><a href="bearbejdning-dag-2.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb349-4"><a href="bearbejdning-dag-2.html#cb349-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gene,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-5"><a href="bearbejdning-dag-2.html#cb349-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb349-6"><a href="bearbejdning-dag-2.html#cb349-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb349-7"><a href="bearbejdning-dag-2.html#cb349-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Expression split according to strain&quot;</span>)</span>
<span id="cb349-8"><a href="bearbejdning-dag-2.html#cb349-8" aria-hidden="true" tabindex="-1"></a>gg2</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-344-1.png" width="576" /></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="bearbejdning-dag-2.html#cb350-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> data_join <span class="sc">%&gt;%</span> </span>
<span id="cb350-2"><a href="bearbejdning-dag-2.html#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>expression,<span class="at">x=</span><span class="fu">as.factor</span>(batch),<span class="at">fill=</span>gene)) <span class="sc">+</span> </span>
<span id="cb350-3"><a href="bearbejdning-dag-2.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb350-4"><a href="bearbejdning-dag-2.html#cb350-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gene,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb350-5"><a href="bearbejdning-dag-2.html#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb350-6"><a href="bearbejdning-dag-2.html#cb350-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb350-7"><a href="bearbejdning-dag-2.html#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Expression split according to batch&quot;</span>)</span>
<span id="cb350-8"><a href="bearbejdning-dag-2.html#cb350-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-9"><a href="bearbejdning-dag-2.html#cb350-9" aria-hidden="true" tabindex="-1"></a>gg1</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-345-1.png" width="576" /></p>
</div>
</div>
<div id="problemstillinger-5" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Problemstillinger<a href="bearbejdning-dag-2.html#problemstillinger-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1</strong>) Lav quizzen - “Quiz - tidyverse - part 2”.</p>
<hr />
<p><em>Vi øver os videre med datasættet Titanic. Indlæs datasættet og udfør oprydning med følgende kode:</em></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="bearbejdning-dag-2.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb351-2"><a href="bearbejdning-dag-2.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(titanic)</span>
<span id="cb351-3"><a href="bearbejdning-dag-2.html#cb351-3" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(titanic_train)</span>
<span id="cb351-4"><a href="bearbejdning-dag-2.html#cb351-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-5"><a href="bearbejdning-dag-2.html#cb351-5" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb351-6"><a href="bearbejdning-dag-2.html#cb351-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Cabin) <span class="sc">%&gt;%</span> </span>
<span id="cb351-7"><a href="bearbejdning-dag-2.html#cb351-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span></code></pre></div>
<hr />
<p><strong>Problem 2)</strong> Fra <code>titanic_clean</code> datasættet, beregn den gennemsnitlige alder af alle passagerer ombord på skibet.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="bearbejdning-dag-2.html#cb352-1" aria-hidden="true" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb352-2"><a href="bearbejdning-dag-2.html#cb352-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(....) <span class="co">#rediger her</span></span></code></pre></div>
<ul>
<li>I samme kommando, beregn også den maksimale alder og den minimale alder, samt proportionen af passagerer, der er under 18 (for den sidste, se mit eksempel med <code>Pclass</code> tidligere i sektion <strong>6.2.2</strong>). Dataframen skal se sådan ud:</li>
</ul>
<pre><code>## # A tibble: 1 × 4
##   mean_alder max_alder min_alder under_18p
##        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1       29.7        80      0.42     0.158</code></pre>
<hr />
<p><strong>Problem 3)</strong></p>
<p><strong>a)</strong> Beregn samme opsummeringsstatistikker som i sidste problem, men brug <code>group_by()</code> til først at opdele efter variablen <code>Pclass</code>.</p>
<p><strong>b)</strong> Brug din nye dataframe med dine opsummeringsstatistikker til at lave et søjlediagram med <code>stat="identity"</code> (i stedet for <code>stat="count"</code> som er standarden), der viser den gennemsnitlige alder på y-aksen og er opdelt efter <code>Pclass</code> på x-aksen (vær opmærksom på datatypen for <code>Pclass</code> med hensyn til farverne/x-aksen).</p>
<p><strong>c)</strong> Anvend <code>pivot_longer()</code> på din dataframe med dine opsummeringsstatistikker (brug indstillingen <code>cols = -Pclass</code> i funktionen).</p>
<p><strong>d)</strong> Brug din long-form dataframe af dine opsummeringsstatistikker til at lave plots af alle opsummeringsstatistikker med én <code>ggplot</code> kommando (adskil dem ved at benytte <code>facet_wrap</code> og opdele efter <code>Pclass</code> indenfor hvert plot, ligesom i følgende).</p>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-351-1.png" width="480" /></p>
<hr />
<p><strong>Problem 4)</strong></p>
<p><strong>a)</strong> Beregn de samme opsummeringsstatistikker som i <strong>2</strong>), men anvend <code>group_by()</code> for først at opdele efter <strong>både</strong> variablerne <code>Pclass</code> og <code>Sex</code>.</p>
<ul>
<li>OBS: Du får en advarsel “<code>summarise()</code> has grouped output by ‘Pclass’ …”, fordi din dataframe stadig betragtes som opdelt efter <code>Pclass</code>. Dette skal tages i betragtning, hvis du foretager yderligere beregninger på den.</li>
<li>Brug til sidst <code>ungroup()</code> på din nye dataframe for at sikre, at den ikke længere er opdelt efter nogen variabel.</li>
</ul>
<p><strong>b)</strong> Brug <code>pivot_longer()</code>-funktionen til at omdanne datasættet til long-form med dine opsummeringsstatistikker i en enkelt kolonne. Nøglekolonnen skal hedde <code>stat</code>, og kolonnen med værdierne skal hedde <code>values</code>.</p>
<pre><code>## `summarise()` has grouped output by &#39;Pclass&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><strong>c)</strong> Lav et plot af alle opsummeringsstatistikker, som er i long-format og ligner følgende plot.</p>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-354-1.png" width="480" /></p>
<hr />
<p><strong>Problem 5)</strong> <em><code>group_by()</code> med tre variabler og <code>summarise()</code></em>. Prøv en kombination med tre forskellige variabler (vælg selv) indenfor <code>group_by()</code> og brug <code>summarise()</code> til at beregne middelværdien for variablen <code>Fare</code>.</p>
<ul>
<li>Anvend <code>ungroup()</code> når du er færdig med at opsummere</li>
<li>Lav et plot for at visualisere <code>meanFare</code>. Idé: som en mulighed, kan man tilføje variabler til <code>facet_grid()</code> - for eksempel <code>facet_grid(~Var1 + Var2)</code>.</li>
</ul>
<hr />
<p><strong>Problem 6)</strong> <em><code>pivot_longer()</code></em> Først skal du lave to nye variabler ud fra <code>SibSp</code> og <code>Parch</code>, hvor der står “yes”, hvis værdien er større end 0. Anvend derefter <code>select()</code> på <code>Fare</code>, <code>Age</code> og dine to nye variabler. Lav derefter følgende plot:</p>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-356-1.png" width="480" /></p>
<hr />
<p><strong>Problem 7)</strong> <em><code>Pivot_wider()</code></em> Vi har en <code>tribble</code>, som jeg har kopieret fra <a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a>.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="bearbejdning-dag-2.html#cb355-1" aria-hidden="true" tabindex="-1"></a>people <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb355-2"><a href="bearbejdning-dag-2.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name,             <span class="sc">~</span>names,  <span class="sc">~</span>values,</span>
<span id="cb355-3"><a href="bearbejdning-dag-2.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-----------------|--------|------</span></span>
<span id="cb355-4"><a href="bearbejdning-dag-2.html#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;age&quot;</span>,       <span class="dv">45</span>,</span>
<span id="cb355-5"><a href="bearbejdning-dag-2.html#cb355-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;height&quot;</span>,   <span class="dv">186</span>,</span>
<span id="cb355-6"><a href="bearbejdning-dag-2.html#cb355-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;age&quot;</span>,       <span class="dv">37</span>,</span>
<span id="cb355-7"><a href="bearbejdning-dag-2.html#cb355-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;height&quot;</span>,   <span class="dv">156</span>,</span>
<span id="cb355-8"><a href="bearbejdning-dag-2.html#cb355-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Brady Smith&quot;</span>,     <span class="st">&quot;age&quot;</span>,       <span class="dv">23</span>,</span>
<span id="cb355-9"><a href="bearbejdning-dag-2.html#cb355-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Brady Smith&quot;</span>,     <span class="st">&quot;height&quot;</span>,   <span class="dv">177</span></span>
<span id="cb355-10"><a href="bearbejdning-dag-2.html#cb355-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Brug <code>pivot_wider()</code> på <code>people</code> for at får datasættet i wide-form således at <code>age</code> og <code>height</code> hver har deres egne kolonner.</p>
<hr />
<p><strong>Problem 8)</strong> <em><code>left_join()</code> øvelse</em>. Kør følgende kode med to tribbles:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="bearbejdning-dag-2.html#cb356-1" aria-hidden="true" tabindex="-1"></a>superheroes <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb356-2"><a href="bearbejdning-dag-2.html#cb356-2" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span>name, <span class="sc">~</span>alignment,  <span class="sc">~</span>gender,          <span class="sc">~</span>publisher,</span>
<span id="cb356-3"><a href="bearbejdning-dag-2.html#cb356-3" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Magneto&quot;</span>,      <span class="st">&quot;bad&quot;</span>,   <span class="st">&quot;male&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb356-4"><a href="bearbejdning-dag-2.html#cb356-4" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Storm&quot;</span>,     <span class="st">&quot;good&quot;</span>, <span class="st">&quot;female&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb356-5"><a href="bearbejdning-dag-2.html#cb356-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Mystique&quot;</span>,      <span class="st">&quot;bad&quot;</span>, <span class="st">&quot;female&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb356-6"><a href="bearbejdning-dag-2.html#cb356-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Batman&quot;</span>,     <span class="st">&quot;good&quot;</span>,   <span class="st">&quot;male&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb356-7"><a href="bearbejdning-dag-2.html#cb356-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Joker&quot;</span>,      <span class="st">&quot;bad&quot;</span>,   <span class="st">&quot;male&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb356-8"><a href="bearbejdning-dag-2.html#cb356-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Catwoman&quot;</span>,      <span class="st">&quot;bad&quot;</span>, <span class="st">&quot;female&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb356-9"><a href="bearbejdning-dag-2.html#cb356-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Hellboy&quot;</span>,     <span class="st">&quot;good&quot;</span>,   <span class="st">&quot;male&quot;</span>, <span class="st">&quot;Dark Horse Comics&quot;</span></span>
<span id="cb356-10"><a href="bearbejdning-dag-2.html#cb356-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb356-11"><a href="bearbejdning-dag-2.html#cb356-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-12"><a href="bearbejdning-dag-2.html#cb356-12" aria-hidden="true" tabindex="-1"></a>publishers <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb356-13"><a href="bearbejdning-dag-2.html#cb356-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>publisher, <span class="sc">~</span>yr_founded,</span>
<span id="cb356-14"><a href="bearbejdning-dag-2.html#cb356-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;DC&quot;</span>,       1934L,</span>
<span id="cb356-15"><a href="bearbejdning-dag-2.html#cb356-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Marvel&quot;</span>,       1939L,</span>
<span id="cb356-16"><a href="bearbejdning-dag-2.html#cb356-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Image&quot;</span>,       1992L</span>
<span id="cb356-17"><a href="bearbejdning-dag-2.html#cb356-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Vi har to dataframes - <code>superheroes</code> og <code>publishers</code>. Hvilken kolon kan man bruge til at forbinde de to dataframes? Brug <code>left_join()</code> til at tilføje oplysninger <strong>fra</strong> <code>publishers</code> <strong>til</strong> datarammen <code>superheroes</code>.</p>
<ul>
<li>Får man alle observationerne fra dataframen <code>superheroes</code> med i din nye dataframe?</li>
<li>Benyt <code>inner_join()</code> til at forbinde <code>publishers</code> til <code>superheroes</code> - få man så nu alle observationer med denne gang?</li>
<li>Benyt <code>full_join()</code> til at forbinde <code>publishers</code> til <code>superheroes</code> - hvor mange observationer få man med nu? Hvorfor?</li>
</ul>
<hr />
<p><strong>Problem 9)</strong> <em><code>left_join()</code> øvelse</em>. Kør nedenstående kode, hvor der er to dataframes - <code>iris2</code> og <code>sample_table</code>. Dataframen <code>iris2</code> er ikke særlig informativ med hensyn til, hvad de forskellige prøver egentlig er, men oplysningerne om dem findes i <code>sample_table</code>. Brug <code>left_join()</code> til at tilføje <code>sample_table</code> til <code>iris2</code> for at få en dataramme, som indeholder både data og oplysninger om prøverne.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="bearbejdning-dag-2.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb357-2"><a href="bearbejdning-dag-2.html#cb357-2" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb357-3"><a href="bearbejdning-dag-2.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sample1&quot;</span>,<span class="st">&quot;sample2&quot;</span>,<span class="st">&quot;sample3&quot;</span>,<span class="st">&quot;sample4&quot;</span>,<span class="st">&quot;Species&quot;</span>)</span>
<span id="cb357-4"><a href="bearbejdning-dag-2.html#cb357-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-5"><a href="bearbejdning-dag-2.html#cb357-5" aria-hidden="true" tabindex="-1"></a>samp_table <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb357-6"><a href="bearbejdning-dag-2.html#cb357-6" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">~</span>sample, <span class="sc">~</span>part, <span class="sc">~</span>measure,</span>
<span id="cb357-7"><a href="bearbejdning-dag-2.html#cb357-7" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#------|-------|--------#</span></span>
<span id="cb357-8"><a href="bearbejdning-dag-2.html#cb357-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;sample1&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb357-9"><a href="bearbejdning-dag-2.html#cb357-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;sample2&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Width&quot;</span>,</span>
<span id="cb357-10"><a href="bearbejdning-dag-2.html#cb357-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;sample3&quot;</span>, <span class="st">&quot;Petal&quot;</span>, <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb357-11"><a href="bearbejdning-dag-2.html#cb357-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;sample4&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Width&quot;</span></span>
<span id="cb357-12"><a href="bearbejdning-dag-2.html#cb357-12" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb357-13"><a href="bearbejdning-dag-2.html#cb357-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-14"><a href="bearbejdning-dag-2.html#cb357-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-15"><a href="bearbejdning-dag-2.html#cb357-15" aria-hidden="true" tabindex="-1"></a>iris2 <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 150
## Columns: 5
## $ sample1 &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.8, 4.…
## $ sample2 &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3.…
## $ sample3 &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.6, 1.…
## $ sample4 &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.2, 0.…
## $ Species &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa…</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="bearbejdning-dag-2.html#cb359-1" aria-hidden="true" tabindex="-1"></a>samp_table <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 4
## Columns: 3
## $ sample  &lt;chr&gt; &quot;sample1&quot;, &quot;sample2&quot;, &quot;sample3&quot;, &quot;sample4&quot;
## $ part    &lt;chr&gt; &quot;Sepal&quot;, &quot;Sepal&quot;, &quot;Petal&quot;, &quot;Sepal&quot;
## $ measure &lt;chr&gt; &quot;Length&quot;, &quot;Width&quot;, &quot;Length&quot;, &quot;Width&quot;</code></pre>
<hr />
<p><strong>Problem 10)</strong> <em><code>Separate()</code> øvelse</em></p>
<ul>
<li>Tag udgangspunkt i datasættet <code>titanic_clean</code> og benyt funktionen <code>separate()</code> til at opdele variablen <code>Name</code> i to variabler, “Surname” og “Rest” (Godt råd: brug <code>sep=", "</code> for at undgå, at man får et unødvendigt mellemrum lige før “Rest”).</li>
<li>Anvend <code>separate()</code> en gang til, men for at opdele variablen <code>Rest</code> i to variabler, “Titel” og “Names”. Hvad bruger man som <code>sep</code>? (Hint: brug “\\” foran en punktum).</li>
<li>Beregn opsummeringsstatistikker for hver “Titel” - antal passagerer, gennemsnitsalder, andelen der overlevede og andelen der rejste i første klasse.</li>
<li>Arrangér din nye dataframe efter, hvor mange personer der er for hver “Titel” - flest øverst og færrest nederst.</li>
</ul>
<hr />
<p><strong>Problem 11</strong> <em>Ekstra pivot_longer() øvelse</em> Åbn datasættet <code>airquality</code> (<code>data(airquality)</code>) og lav følgende plot:</p>
<pre><code>## `summarise()` has grouped output by &#39;Month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-368-1.png" width="480" /></p>
<hr />
<p><strong>Problem 12)</strong> Valgfri ekstra: lav en ny dataramme med alle passagerer, der hedder “Alice” eller “Elizabeth” (brug Google her).</p>
<hr />
</div>
<div id="ekstra-links-1" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Ekstra links<a href="bearbejdning-dag-2.html#ekstra-links-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cheatsheet: <a href="https://github.com/rstudio/cheatsheets/blob/master/data-import.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/data-import.pdf</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functional-programming-med-purrr-pakken.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["visualisering_22.pdf", "visualisering_22.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
